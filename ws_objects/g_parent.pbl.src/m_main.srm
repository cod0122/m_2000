$PBExportHeader$m_main.srm
$PBExportComments$Menu Principale
forward
global type m_main from menu
end type
type m_file from menu within m_main
end type
type m_setupstampante from menu within m_file
end type
type m_f_chiudodb from menu within m_file
end type
type m_-2 from menu within m_file
end type
type m_proprieta from menu within m_file
end type
type m_utility from menu within m_file
end type
type m_password from menu within m_utility
end type
type m_cambiautente from menu within m_utility
end type
type m_aggiornaprogrammi from menu within m_utility
end type
type m_aggiornaallaversionedisviluppo from menu within m_utility
end type
type m_ottimizzadb from menu within m_utility
end type
type m_generadatawarehouse from menu within m_ottimizzadb
end type
type m_generatabtempimedigiriimpianto from menu within m_ottimizzadb
end type
type m_statistichegenerico from menu within m_ottimizzadb
end type
type m_statisticheindici from menu within m_ottimizzadb
end type
type m_creatabellanavigatore from menu within m_ottimizzadb
end type
type m_creaview from menu within m_ottimizzadb
end type
type m_chiudelottiaperti from menu within m_ottimizzadb
end type
type m_generaprezzimensili from menu within m_ottimizzadb
end type
type m_attivatestlogperdataeora from menu within m_ottimizzadb
end type
type m_attivatrace from menu within m_ottimizzadb
end type
type m_ottimizzadb from menu within m_utility
m_generadatawarehouse m_generadatawarehouse
m_generatabtempimedigiriimpianto m_generatabtempimedigiriimpianto
m_statistichegenerico m_statistichegenerico
m_statisticheindici m_statisticheindici
m_creatabellanavigatore m_creatabellanavigatore
m_creaview m_creaview
m_chiudelottiaperti m_chiudelottiaperti
m_generaprezzimensili m_generaprezzimensili
m_attivatestlogperdataeora m_attivatestlogperdataeora
m_attivatrace m_attivatrace
end type
type m_f_u_-1 from menu within m_utility
end type
type m_esportacodapilotainhtml from menu within m_utility
end type
type m_popolat_contr from menu within m_utility
end type
type m_popolalistinodaaccess from menu within m_utility
end type
type m_sistemaricevute from menu within m_utility
end type
type m_esportapassword from menu within m_utility
end type
type m_importapassword from menu within m_utility
end type
type m_importaanagrafichecrm from menu within m_utility
end type
type m_popolaindirizziddt from menu within m_utility
end type
type m_ufo from menu within m_utility
end type
type m_utility from menu within m_file
m_password m_password
m_cambiautente m_cambiautente
m_aggiornaprogrammi m_aggiornaprogrammi
m_aggiornaallaversionedisviluppo m_aggiornaallaversionedisviluppo
m_ottimizzadb m_ottimizzadb
m_f_u_-1 m_f_u_-1
m_esportacodapilotainhtml m_esportacodapilotainhtml
m_popolat_contr m_popolat_contr
m_popolalistinodaaccess m_popolalistinodaaccess
m_sistemaricevute m_sistemaricevute
m_esportapassword m_esportapassword
m_importapassword m_importapassword
m_importaanagrafichecrm m_importaanagrafichecrm
m_popolaindirizziddt m_popolaindirizziddt
m_ufo m_ufo
end type
type m_-3 from menu within m_file
end type
type m_mostrabarrastrumenti from menu within m_file
end type
type m_mostrabarradelleapplicazioni from menu within m_file
end type
type m_-6 from menu within m_file
end type
type m_uscita from menu within m_file
end type
type m_file from menu within m_main
m_setupstampante m_setupstampante
m_f_chiudodb m_f_chiudodb
m_-2 m_-2
m_proprieta m_proprieta
m_utility m_utility
m_-3 m_-3
m_mostrabarrastrumenti m_mostrabarrastrumenti
m_mostrabarradelleapplicazioni m_mostrabarradelleapplicazioni
m_-6 m_-6
m_uscita m_uscita
end type
type m_magazzino from menu within m_main
end type
type m_mag_navigatore from menu within m_magazzino
end type
type m_marketing from menu within m_magazzino
end type
type m_lotti from menu within m_magazzino
end type
type m_caricalotto from menu within m_magazzino
end type
type m_lottisd from menu within m_magazzino
end type
type m_-4 from menu within m_magazzino
end type
type m_groupage from menu within m_magazzino
end type
type m_pianidilavorazione from menu within m_magazzino
end type
type m_convalidalavorazioni from menu within m_magazzino
end type
type m_letturadosim from menu within m_convalidalavorazioni
end type
type m_convalida from menu within m_convalidalavorazioni
end type
type m_convalidalavorazioni1 from menu within m_convalidalavorazioni
end type
type m_convalidalavorazioni2 from menu within m_convalidalavorazioni
end type
type m_convalidalavorazioni3 from menu within m_convalidalavorazioni
end type
type m_convalidalavorazioni from menu within m_magazzino
m_letturadosim m_letturadosim
m_convalida m_convalida
m_convalidalavorazioni1 m_convalidalavorazioni1
m_convalidalavorazioni2 m_convalidalavorazioni2
m_convalidalavorazioni3 m_convalidalavorazioni3
end type
type m_attestati from menu within m_magazzino
end type
type m_1 from menu within m_magazzino
end type
type m_ddt from menu within m_magazzino
end type
type m_spedizioni from menu within m_magazzino
end type
type m_stampaspedizioni from menu within m_magazzino
end type
type m_-1 from menu within m_magazzino
end type
type m_fatture from menu within m_magazzino
end type
type m_stampafatture from menu within m_magazzino
end type
type m_scadenzario from menu within m_magazzino
end type
type m_0 from menu within m_magazzino
end type
type m_email0 from menu within m_magazzino
end type
type m_emailfatture from menu within m_email0
end type
type m_emailprontomerce from menu within m_email0
end type
type m_email0 from menu within m_magazzino
m_emailfatture m_emailfatture
m_emailprontomerce m_emailprontomerce
end type
type m_esportadocumenti from menu within m_magazzino
end type
type m_-0 from menu within m_magazzino
end type
type m_etichbarcode from menu within m_magazzino
end type
type m_etichettatrice from menu within m_etichbarcode
end type
type m_4etichette from menu within m_etichbarcode
end type
type m_2etichette from menu within m_etichbarcode
end type
type m_etichbarcode from menu within m_magazzino
m_etichettatrice m_etichettatrice
m_4etichette m_4etichette
m_2etichette m_2etichette
end type
type m_barcodemanuale from menu within m_magazzino
end type
type m_barcodedosimetro from menu within m_magazzino
end type
type m_-5 from menu within m_magazzino
end type
type m_creapackinglistdaweb from menu within m_magazzino
end type
type m_importapackinglist from menu within m_magazzino
end type
type m_getbcodedaeone from menu within m_magazzino
end type
type m_inviapianoalpilota from menu within m_magazzino
end type
type m_importalavorazioni from menu within m_magazzino
end type
type m_datilavtoe1 from menu within m_magazzino
end type
type m_reportpilota from menu within m_magazzino
end type
type m_5 from menu within m_magazzino
end type
type m_modificaprogrammazione from menu within m_magazzino
end type
type m_magazzino from menu within m_main
m_mag_navigatore m_mag_navigatore
m_marketing m_marketing
m_lotti m_lotti
m_caricalotto m_caricalotto
m_lottisd m_lottisd
m_-4 m_-4
m_groupage m_groupage
m_pianidilavorazione m_pianidilavorazione
m_convalidalavorazioni m_convalidalavorazioni
m_attestati m_attestati
m_1 m_1
m_ddt m_ddt
m_spedizioni m_spedizioni
m_stampaspedizioni m_stampaspedizioni
m_-1 m_-1
m_fatture m_fatture
m_stampafatture m_stampafatture
m_scadenzario m_scadenzario
m_0 m_0
m_email0 m_email0
m_esportadocumenti m_esportadocumenti
m_-0 m_-0
m_etichbarcode m_etichbarcode
m_barcodemanuale m_barcodemanuale
m_barcodedosimetro m_barcodedosimetro
m_-5 m_-5
m_creapackinglistdaweb m_creapackinglistdaweb
m_importapackinglist m_importapackinglist
m_getbcodedaeone m_getbcodedaeone
m_inviapianoalpilota m_inviapianoalpilota
m_importalavorazioni m_importalavorazioni
m_datilavtoe1 m_datilavtoe1
m_reportpilota m_reportpilota
m_5 m_5
m_modificaprogrammazione m_modificaprogrammazione
end type
type m_stat from menucascade within m_main
end type
type m_st_produz from menu within m_stat
end type
type m_st_inventario from menu within m_stat
end type
type m_st_fatt from menu within m_stat
end type
type m_st_produz_no_imp from menu within m_stat
end type
type m_stat from menucascade within m_main
m_st_produz m_st_produz
m_st_inventario m_st_inventario
m_st_fatt m_st_fatt
m_st_produz_no_imp m_st_produz_no_imp
end type
type m_archivi from menu within m_main
end type
type m_anagrafiche from menu within m_archivi
end type
type m_lista_anag from menu within m_anagrafiche
end type
type m_lista_mandanti from menu within m_anagrafiche
end type
type m_lista_riceventi from menu within m_anagrafiche
end type
type m_lista_fatturati from menu within m_anagrafiche
end type
type m_lista_legami from menu within m_anagrafiche
end type
type m_anagrafiche from menu within m_archivi
m_lista_anag m_lista_anag
m_lista_mandanti m_lista_mandanti
m_lista_riceventi m_lista_riceventi
m_lista_fatturati m_lista_fatturati
m_lista_legami m_lista_legami
end type
type m_articoli from menu within m_archivi
end type
type m_sd_md from menu within m_archivi
end type
type m_a_t1 from menu within m_archivi
end type
type m_contodeposito from menu within m_archivi
end type
type m_ct_rd_l from menu within m_archivi
end type
type m_commerciale from menu within m_archivi
end type
type m_quotazioni from menu within m_archivi
end type
type m_a_t11 from menu within m_archivi
end type
type m_capitolati from menu within m_archivi
end type
type m_contratti from menu within m_archivi
end type
type m_sl_pt from menu within m_archivi
end type
type m_2 from menu within m_archivi
end type
type m_listino from menu within m_archivi
end type
type m_gruppilistino from menu within m_archivi
end type
type m_vocilistino from menu within m_archivi
end type
type m_3 from menu within m_archivi
end type
type m_websmart from menu within m_archivi
end type
type m_a_t2 from menu within m_archivi
end type
type m_vettori from menu within m_archivi
end type
type m_crm from menu within m_archivi
end type
type m_memo from menu within m_archivi
end type
type m_sicurezza from menu within m_archivi
end type
type m_- from menu within m_archivi
end type
type m_opf from menu within m_archivi
end type
type m_opf_gestione from menu within m_opf
end type
type m_opf_elenco from menu within m_opf
end type
type m_opf_gestore_eventi from menu within m_opf
end type
type m_opf from menu within m_archivi
m_opf_gestione m_opf_gestione
m_opf_elenco m_opf_elenco
m_opf_gestore_eventi m_opf_gestore_eventi
end type
type m_codabarre from menu within m_archivi
end type
type m_archivi from menu within m_main
m_anagrafiche m_anagrafiche
m_articoli m_articoli
m_sd_md m_sd_md
m_a_t1 m_a_t1
m_contodeposito m_contodeposito
m_ct_rd_l m_ct_rd_l
m_commerciale m_commerciale
m_quotazioni m_quotazioni
m_a_t11 m_a_t11
m_capitolati m_capitolati
m_contratti m_contratti
m_sl_pt m_sl_pt
m_2 m_2
m_listino m_listino
m_gruppilistino m_gruppilistino
m_vocilistino m_vocilistino
m_3 m_3
m_websmart m_websmart
m_a_t2 m_a_t2
m_vettori m_vettori
m_crm m_crm
m_memo m_memo
m_sicurezza m_sicurezza
m_- m_-
m_opf m_opf
m_codabarre m_codabarre
end type
type m_interrogazioni from menu within m_main
end type
type m_movimenti from menu within m_interrogazioni
end type
type m_report from menu within m_interrogazioni
end type
type m_interrogazioni from menu within m_main
m_movimenti m_movimenti
m_report m_report
end type
type m_finestra from menu within m_main
end type
type m_gestione from menu within m_finestra
end type
type m_fin_conferma from menu within m_gestione
end type
type m_fin_visualizza from menu within m_gestione
end type
type m_fin_modifica from menu within m_gestione
end type
type m_fin_inserimento from menu within m_gestione
end type
type m_fin_duplica from menu within m_gestione
end type
type m_4 from menu within m_gestione
end type
type m_fin_elimina from menu within m_gestione
end type
type m_gestione from menu within m_finestra
m_fin_conferma m_fin_conferma
m_fin_visualizza m_fin_visualizza
m_fin_modifica m_fin_modifica
m_fin_inserimento m_fin_inserimento
m_fin_duplica m_fin_duplica
m_4 m_4
m_fin_elimina m_fin_elimina
end type
type m_fin-11 from menu within m_finestra
end type
type m_fin_stampa from menu within m_finestra
end type
type m_fin-3 from menu within m_finestra
end type
type m_aggiornalista from menu within m_finestra
end type
type m_fin-2 from menu within m_finestra
end type
type m_riordinalista from menu within m_finestra
end type
type m_fin-4 from menu within m_finestra
end type
type m_fin_dettaglio from menu within m_finestra
end type
type m_layout_predefinito from menu within m_finestra
end type
type m_abilitadockingpredefinito from menu within m_finestra
end type
type m_rimuovepersonalizzazionidocking from menu within m_finestra
end type
type m_disponi from menucascade within m_finestra
end type
type m_adatta from menu within m_disponi
end type
type m_cascata from menu within m_disponi
end type
type m_orizzontale from menu within m_disponi
end type
type m_verticale from menu within m_disponi
end type
type m_disponi from menucascade within m_finestra
m_adatta m_adatta
m_cascata m_cascata
m_orizzontale m_orizzontale
m_verticale m_verticale
end type
type m_chiudifinestra from menu within m_finestra
end type
type m_finestra from menu within m_main
m_gestione m_gestione
m_fin-11 m_fin-11
m_fin_stampa m_fin_stampa
m_fin-3 m_fin-3
m_aggiornalista m_aggiornalista
m_fin-2 m_fin-2
m_riordinalista m_riordinalista
m_fin-4 m_fin-4
m_fin_dettaglio m_fin_dettaglio
m_layout_predefinito m_layout_predefinito
m_abilitadockingpredefinito m_abilitadockingpredefinito
m_rimuovepersonalizzazionidocking m_rimuovepersonalizzazionidocking
m_disponi m_disponi
m_chiudifinestra m_chiudifinestra
end type
type m_trova from menucascade within m_main
end type
type m_fin_cerca from menu within m_trova
end type
type m_fin_cercaancora from menu within m_trova
end type
type m_fin_ordina from menu within m_trova
end type
type m_fin_filtra from menu within m_trova
end type
type m_trova from menucascade within m_main
m_fin_cerca m_fin_cerca
m_fin_cercaancora m_fin_cercaancora
m_fin_ordina m_fin_ordina
m_fin_filtra m_fin_filtra
end type
type m_filtro from menu within m_main
end type
type m_strumenti from menu within m_main
end type
type m_fin_gest_libero1 from menu within m_strumenti
end type
type m_fin_gest_libero2 from menu within m_strumenti
end type
type m_fin_gest_libero3 from menu within m_strumenti
end type
type m_fin_gest_libero4 from menu within m_strumenti
end type
type m_fin_gest_libero5 from menu within m_strumenti
end type
type m_fin_gest_libero6 from menu within m_strumenti
end type
type m_fin_gest_libero7 from menucascade within m_strumenti
end type
type libero1 from menu within m_fin_gest_libero7
end type
type libero2 from menu within m_fin_gest_libero7
end type
type libero3 from menu within m_fin_gest_libero7
end type
type libero4 from menu within m_fin_gest_libero7
end type
type libero5 from menu within m_fin_gest_libero7
end type
type m_fin_gest_libero7 from menucascade within m_strumenti
libero1 libero1
libero2 libero2
libero3 libero3
libero4 libero4
libero5 libero5
end type
type m_fin_gest_libero8 from menu within m_strumenti
end type
type m_fin_gest_libero9 from menu within m_strumenti
end type
type m_fin_gest_libero10 from menu within m_strumenti
end type
type m_strumenti from menu within m_main
m_fin_gest_libero1 m_fin_gest_libero1
m_fin_gest_libero2 m_fin_gest_libero2
m_fin_gest_libero3 m_fin_gest_libero3
m_fin_gest_libero4 m_fin_gest_libero4
m_fin_gest_libero5 m_fin_gest_libero5
m_fin_gest_libero6 m_fin_gest_libero6
m_fin_gest_libero7 m_fin_gest_libero7
m_fin_gest_libero8 m_fin_gest_libero8
m_fin_gest_libero9 m_fin_gest_libero9
m_fin_gest_libero10 m_fin_gest_libero10
end type
type m_help from menu within m_main
end type
type m_aiuto from menu within m_help
end type
type m_chk_update from menu within m_help
end type
type m_about from menu within m_help
end type
type m_help from menu within m_main
m_aiuto m_aiuto
m_chk_update m_chk_update
m_about m_about
end type
global type m_main from menu
m_file m_file
m_magazzino m_magazzino
m_stat m_stat
m_archivi m_archivi
m_interrogazioni m_interrogazioni
m_finestra m_finestra
m_trova m_trova
m_filtro m_filtro
m_strumenti m_strumenti
m_help m_help
end type
end forward

global type m_main from menu
m_file m_file
m_magazzino m_magazzino
m_stat m_stat
m_archivi m_archivi
m_interrogazioni m_interrogazioni
m_finestra m_finestra
m_trova m_trova
m_filtro m_filtro
m_strumenti m_strumenti
m_help m_help
end type
global m_main m_main

type variables

end variables

forward prototypes
public subroutine set_modulo_barcode ()
public subroutine reset_menu_strumenti ()
private function boolean autorizza_menu_1 (string k_menu_tag)
public subroutine autorizza_menu ()
public function integer u_item ()
public subroutine u_inizializza ()
public subroutine u_espone_testo_delete (boolean a_menu_espone_tasto_delete)
public subroutine u_imposta_window_menu ()
public subroutine reset_menu_all ()
public subroutine u_close_window ()
public subroutine u_close_main ()
public subroutine u_run_shortcutkey (keycode a_keycode, unsignedlong a_keyflags)
end prototypes

public subroutine set_modulo_barcode ();//
//---
//
m_magazzino.m_etichbarcode.m_etichettatrice.checked = false
m_magazzino.m_etichbarcode.m_4etichette.checked = false
m_magazzino.m_etichbarcode.m_2etichette.checked = false

if kGuf_data_base.KI_barcode_modulo = "A" then
	m_magazzino.m_etichbarcode.m_etichettatrice.checked = true
else
	if kGuf_data_base.KI_barcode_modulo = "4" then
		m_magazzino.m_etichbarcode.m_4etichette.checked = true
	else
		if kGuf_data_base.KI_barcode_modulo = "2" then
			m_magazzino.m_etichbarcode.m_2etichette.checked = true
		end if
	end if
end if
	
end subroutine

public subroutine reset_menu_strumenti ();//
//--- Resetta barra strumenti
		m_strumenti.m_fin_gest_libero1.visible = false
		m_strumenti.m_fin_gest_libero1.enabled = false
		m_strumenti.m_fin_gest_libero1.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero2.visible = false
		m_strumenti.m_fin_gest_libero2.enabled = false
		m_strumenti.m_fin_gest_libero2.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero3.visible = false
		m_strumenti.m_fin_gest_libero3.enabled = false
		m_strumenti.m_fin_gest_libero3.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero4.visible = false
		m_strumenti.m_fin_gest_libero4.enabled = false
		m_strumenti.m_fin_gest_libero4.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero5.visible = false
		m_strumenti.m_fin_gest_libero5.enabled = false
		m_strumenti.m_fin_gest_libero5.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero6.visible = false
		m_strumenti.m_fin_gest_libero6.enabled = false
		m_strumenti.m_fin_gest_libero6.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero7.visible = false
		m_strumenti.m_fin_gest_libero7.enabled = false
		m_strumenti.m_fin_gest_libero7.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero7.libero1.visible = false
		m_strumenti.m_fin_gest_libero7.libero1.enabled = false
		m_strumenti.m_fin_gest_libero7.libero1.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero7.libero2.visible = false
		m_strumenti.m_fin_gest_libero7.libero2.enabled = false
		m_strumenti.m_fin_gest_libero7.libero2.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero7.libero3.visible = false
		m_strumenti.m_fin_gest_libero7.libero3.enabled = false
		m_strumenti.m_fin_gest_libero7.libero3.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero7.libero4.visible = false
		m_strumenti.m_fin_gest_libero7.libero4.enabled = false
		m_strumenti.m_fin_gest_libero7.libero4.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero7.libero5.visible = false
		m_strumenti.m_fin_gest_libero7.libero5.enabled = false
		m_strumenti.m_fin_gest_libero7.libero5.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero8.visible = false
		m_strumenti.m_fin_gest_libero8.enabled = false
		m_strumenti.m_fin_gest_libero8.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero9.visible = false
		m_strumenti.m_fin_gest_libero9.enabled = false
		m_strumenti.m_fin_gest_libero9.toolbaritemVisible = false
		m_strumenti.m_fin_gest_libero10.visible = false
		m_strumenti.m_fin_gest_libero10.enabled = false
		m_strumenti.m_fin_gest_libero10.toolbaritemVisible = false
	
end subroutine

private function boolean autorizza_menu_1 (string k_menu_tag);//
//=== Controlla se voce menu e' da autorizzare
//
boolean k_return = false
long k_ctr, k_ctr_idx


	k_menu_tag = lower(trim(k_menu_tag))

	if k_menu_tag = "master" then
		k_return = true
	else
	
		k_ctr = 1
		k_ctr_idx = UpperBound(kGst_tab_menu_window[])
		do while k_ctr <= k_ctr_idx 
			if k_menu_tag = (trim(kGst_tab_menu_window[k_ctr].id)) then
//------------------------ ECCEZIONI!!!!!				
				if k_menu_tag =  kkg_id_programma.dosimetria  & 
						or k_menu_tag =  kkg_id_programma.pilota_esporta_pl  then 
					if pos(kGst_tab_menu_window[k_ctr].funzioni,  "m") > 0 or pos(kGst_tab_menu_window[k_ctr].funzioni,  "M") > 0 &
								or pos(kGst_tab_menu_window[k_ctr].funzioni,  "v") > 0 or pos(kGst_tab_menu_window[k_ctr].funzioni,  "V") > 0  &
								or pos(kGst_tab_menu_window[k_ctr].funzioni,  "i") > 0 or pos(kGst_tab_menu_window[k_ctr].funzioni,  "I") > 0  then
						exit
					end if
				else
					if k_menu_tag = "sped" then
						if pos(kGst_tab_menu_window[k_ctr].funzioni,  "m") > 0 or pos(kGst_tab_menu_window[k_ctr].funzioni,  "M") > 0 &
								or pos(kGst_tab_menu_window[k_ctr].funzioni,  "i") > 0 or pos(kGst_tab_menu_window[k_ctr].funzioni,  "I") > 0  then
							exit
						end if
					else
						exit
					end if
				end if
			end if
			k_ctr++
		loop
		
		if k_ctr <= k_ctr_idx then
		
			k_return = true
		
		end if
	end if


return k_return

end function

public subroutine autorizza_menu ();//
int k_item, k_item1, k_item2, k_ctr, k_ctr1, k_ctr2


if isvalid(kguf_base_docking) then
	this.m_finestra.m_abilitadockingpredefinito.checked = kguf_base_docking.ki_m_abilitadockingpredefinito
else
	this.m_finestra.m_abilitadockingpredefinito.checked = false
end if


k_item = upperbound(this.item)

for k_ctr = 1 to k_item
	
//--- abilito/disabilito menu 
//---- I livello 
 	if this.item[k_ctr].tag > " " then
		if autorizza_menu_1(this.item[k_ctr].tag) then
			this.item[k_ctr].enabled = true
		else
			this.item[k_ctr].enabled = false
		end if
	end if
			
//---- II livello 
	k_item1 = upperbound(this.item[k_ctr].item)
	for k_ctr1 = 1 to k_item1
		
	//--- abilito/disabilito menu 
		if this.item[k_ctr].item[k_ctr1].tag > " " then
			if autorizza_menu_1(this.item[k_ctr].item[k_ctr1].tag) then
				this.item[k_ctr].enabled = true  // basta che una sottovoce sia ok che lo è anche il liv superiore
				this.item[k_ctr].item[k_ctr1].enabled = true
			else
				this.item[k_ctr].item[k_ctr1].enabled = false
			end if
				
//---- III livello 
			k_item2 = upperbound(this.item[k_ctr].item[k_ctr1].item)
			for k_ctr2 = 1 to k_item2
				
			//--- abilito/disabilito menu 
				if this.item[k_ctr].item[k_ctr1].item[k_ctr2].tag > " " then
					if autorizza_menu_1(this.item[k_ctr].item[k_ctr1].item[k_ctr2].tag) then
						this.item[k_ctr].enabled = true  // basta che una sottovoce sia ok che lo è anche il liv superiore
						this.item[k_ctr].item[k_ctr1].enabled = true  // basta che una sottovoce sia ok che lo è anche il liv superiore
						this.item[k_ctr].item[k_ctr1].item[k_ctr2].enabled = true
					else
						this.item[k_ctr].item[k_ctr1].item[k_ctr2].enabled = false
					end if
				end if
			end for
		end if
	end for
	
end for

//this.m_filtro.visible = true
//this.m_filtro.enabled = true
//	this.m_archivi.m_fatture.MenuImage = kGuo_path.get_risorse() + "\Menu_Fatt.ico"

////--- abilito/disabilito menu FILE
// 	if autorizza_menu_1(this.m_file.m_utility.m_esportapassword.tag) then
//		this.m_file.m_utility.m_importapassword.enabled = true
//		this.m_file.m_utility.m_esportapassword.enabled = true
//	else
//		this.m_file.m_utility.m_importapassword.enabled = false
//		this.m_file.m_utility.m_esportapassword.enabled = false
//	end if
//
////--- abilito/disabilito menu UTULITY
//	if autorizza_menu_1(this.m_file.m_utility.m_ottimizzadb.m_creaview.tag) then
//		this.m_file.m_utility.m_ottimizzadb.m_creaview.enabled = true
//	else
//		this.m_file.m_utility.m_ottimizzadb.m_creaview.enabled = false
//	end if
//	if autorizza_menu_1(this.m_file.m_utility.m_ottimizzadb.m_chiudelottiaperti.tag) then
//		this.m_file.m_utility.m_ottimizzadb.m_chiudelottiaperti.enabled = true
//	else
//		this.m_file.m_utility.m_ottimizzadb.m_chiudelottiaperti.enabled = false
//	end if
//	if autorizza_menu_1(this.m_file.m_utility.m_ottimizzadb.m_generaprezzimensili.tag) then
//		this.m_file.m_utility.m_ottimizzadb.m_generaprezzimensili.enabled = true
//	else
//		this.m_file.m_utility.m_ottimizzadb.m_generaprezzimensili.enabled = false
//	end if
//	if autorizza_menu_1(this.m_file.m_utility.m_popolat_contr.tag) then
//		this.m_file.m_utility.m_popolat_contr.enabled = true
//	else
//		this.m_file.m_utility.m_popolat_contr.enabled = false
//	end if
//	if autorizza_menu_1(this.m_file.m_utility.m_sistemaricevute.tag) then
//		this.m_file.m_utility.m_sistemaricevute.enabled = true
//	else
//		this.m_file.m_utility.m_sistemaricevute.enabled = false
//	end if
//	if autorizza_menu_1(this.m_file.m_utility.m_ufo.tag) then
//		this.m_file.m_utility.m_ufo.enabled = true
//	else
//		this.m_file.m_utility.m_ufo.enabled = false
//	end if
//
////--- abilito/disabilito menu MAGAZZINO
//	if autorizza_menu_1(this.m_magazzino.m_mag_navigatore.tag) then
//		this.m_magazzino.m_mag_navigatore.enabled = true
//	else
//		this.m_magazzino.m_mag_navigatore.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_marketing.tag) then
//		this.m_magazzino.m_marketing.enabled = true
//	else
//		this.m_magazzino.m_marketing.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_lotti.tag) then
//		this.m_magazzino.m_lotti.enabled = true
//	else
//		this.m_magazzino.m_lotti.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_groupage.tag) then
//		this.m_magazzino.m_groupage.enabled = true
//	else
//		this.m_magazzino.m_groupage.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni1.tag) then
//		this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni1.enabled = true
//	else
//		this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni1.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni2.tag) then
//		this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni2.enabled = true
//	else
//		this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni2.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni3.tag) then
//		this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni3.enabled = true
//	else
//		this.m_magazzino.m_convalidalavorazioni.m_convalidalavorazioni3.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_pianidilavorazione.tag) then
//		this.m_magazzino.m_pianidilavorazione.enabled = true 
//	else
//		this.m_magazzino.m_pianidilavorazione.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_attestati.tag) then
//		this.m_magazzino.m_attestati.enabled = true
//	else
//		this.m_magazzino.m_attestati.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_ddt.tag) then
//		this.m_magazzino.m_ddt.enabled = true
//	else
//		this.m_magazzino.m_ddt.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_spedizioni.tag) then
//		this.m_magazzino.m_spedizioni.enabled = true
//	else
//		this.m_magazzino.m_spedizioni.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_stampaspedizioni.tag) then
//		this.m_magazzino.m_stampaspedizioni.enabled = true
//	else
//		this.m_magazzino.m_stampaspedizioni.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_fatture.tag) then
//		this.m_magazzino.m_fatture.enabled = true
//	else
//		this.m_magazzino.m_fatture.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_stampafatture.tag) then
//		this.m_magazzino.m_stampafatture.enabled = true 
//	else
//		this.m_magazzino.m_stampafatture.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_scadenzario.tag) then
//		this.m_magazzino.m_scadenzario.enabled = true
//	else
//		this.m_magazzino.m_scadenzario.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_email0.m_emailfatture.tag) then
//		this.m_magazzino.m_email0.m_emailfatture.enabled = true
//	else
//		this.m_magazzino.m_email0.m_emailfatture.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_email0.m_emailprontomerce.tag) then
//		this.m_magazzino.m_email0.m_emailprontomerce.enabled = true
//	else
//		this.m_magazzino.m_email0.m_emailprontomerce.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_esportadocumenti.tag) then
//		this.m_magazzino.m_esportadocumenti.enabled = true
//	else
//		this.m_magazzino.m_esportadocumenti.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_barcodedosimetro.tag) then
//		this.m_magazzino.m_barcodedosimetro.enabled = true
//	else
//		this.m_magazzino.m_barcodedosimetro.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_convalidalavorazioni.tag) then
//		this.m_magazzino.m_convalidalavorazioni.enabled = true
//	else
//		this.m_magazzino.m_convalidalavorazioni.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_barcodemanuale.tag) then
//		this.m_magazzino.m_barcodemanuale.enabled = true
//	else
//		this.m_magazzino.m_barcodemanuale.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_inviapianoalpilota.tag) then
//		this.m_magazzino.m_inviapianoalpilota.enabled = true
//	else
//		this.m_magazzino.m_inviapianoalpilota.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_importalavorazioni.tag) then
//		this.m_magazzino.m_importalavorazioni.enabled = true
//	else
//		this.m_magazzino.m_importalavorazioni.enabled = false
//	end if
//	if autorizza_menu_1(this.m_magazzino.m_modificaprogrammazione.tag) then
//		this.m_magazzino.m_modificaprogrammazione.enabled = true
//	else
//		this.m_magazzino.m_modificaprogrammazione.enabled = false
//	end if
//
//
////--- abilito/disabilito menu STATISTICI
//	if autorizza_menu_1(this.m_stat.m_st_fatt.tag) or autorizza_menu_1(this.m_stat.m_st_produz.tag) or autorizza_menu_1(this.m_stat.m_st_inventario.tag ) then
//		this.m_stat.enabled = true
//	else
//		this.m_stat.enabled = false
//	end if
//	if autorizza_menu_1(this.m_stat.m_st_fatt.tag) then
//		this.m_stat.m_st_fatt.enabled = true
//	else
//		this.m_stat.m_st_fatt.enabled = false
//	end if
//	if autorizza_menu_1(this.m_stat.m_st_produz.tag) then
//		this.m_stat.m_st_produz.enabled = true
//	else
//		this.m_stat.m_st_produz.enabled = false
//	end if
//	if autorizza_menu_1(this.m_stat.m_st_inventario.tag ) then
//		this.m_stat.m_st_inventario.enabled = true
//	else
//		this.m_stat.m_st_inventario.enabled = false
//	end if
//
////--- abilito/disabilito menu Interrogazioni
//	if autorizza_menu_1(this.m_interrogazioni.m_movimenti.tag) then
//		this.m_interrogazioni.m_movimenti.enabled = true
//	else
//		this.m_interrogazioni.m_movimenti.enabled = false
//	end if
//	if autorizza_menu_1(this.m_interrogazioni.m_report.tag) then
//		this.m_interrogazioni.m_report.enabled = true
//	else
//		this.m_interrogazioni.m_report.enabled = false
//	end if
//	
//
////--- abilito/disabilito menu ARCHIVI
//	if autorizza_menu_1(this.m_archivi.m_anagrafiche.tag) then
//		this.m_archivi.m_anagrafiche.enabled = true
//	else
//		this.m_archivi.m_anagrafiche.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_anagrafiche.m_lista_anag.tag) then
//		this.m_archivi.m_anagrafiche.m_lista_anag.enabled = true
//	else
//		this.m_archivi.m_anagrafiche.m_lista_anag.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_anagrafiche.m_lista_mandanti.tag) then
//		this.m_archivi.m_anagrafiche.m_lista_mandanti.enabled = true
//	else
//		this.m_archivi.m_anagrafiche.m_lista_mandanti.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_anagrafiche.m_lista_riceventi.tag) then
//		this.m_archivi.m_anagrafiche.m_lista_riceventi.enabled = true
//	else
//		this.m_archivi.m_anagrafiche.m_lista_riceventi.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_anagrafiche.m_lista_fatturati.tag) then
//		this.m_archivi.m_anagrafiche.m_lista_fatturati.enabled = true
//	else
//		this.m_archivi.m_anagrafiche.m_lista_fatturati.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_articoli.tag) then
//		this.m_archivi.m_articoli.enabled = true
//	else
//		this.m_archivi.m_articoli.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_sd_md.tag) then
//		this.m_archivi.m_sd_md.enabled = true
//	else
//		this.m_archivi.m_sd_md.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_contodeposito.tag) then
//		this.m_archivi.m_contodeposito.enabled = true
//	else
//		this.m_archivi.m_contodeposito.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_ct_rd_l.tag) then
//		this.m_archivi.m_ct_rd_l.enabled = true
//	else
//		this.m_archivi.m_ct_rd_l.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_commerciale.tag) then
//		this.m_archivi.m_commerciale.enabled = true
//	else
//		this.m_archivi.m_commerciale.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_listino.tag) then
//		this.m_archivi.m_listino.enabled = true
//	else
//		this.m_archivi.m_listino.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_gruppilistino.tag) then
//		this.m_archivi.m_gruppilistino.enabled = true
//	else
//		this.m_archivi.m_gruppilistino.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_vocilistino.tag) then
//		this.m_archivi.m_vocilistino.enabled = true
//	else
//		this.m_archivi.m_vocilistino.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_capitolati.tag) then
//		this.m_archivi.m_capitolati.enabled = true
//	else
//		this.m_archivi.m_capitolati.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_contratti.tag) then
//		this.m_archivi.m_contratti.enabled = true
//	else
//		this.m_archivi.m_contratti.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_sl_pt.tag) then
//		this.m_archivi.m_sl_pt.enabled = true
//	else
//		this.m_archivi.m_sl_pt.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_websmart.tag) then
//		this.m_archivi.m_websmart.enabled = true
//	else
//		this.m_archivi.m_websmart.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_sicurezza.tag) then
//		this.m_archivi.m_sicurezza.enabled = true
//	else
//		this.m_archivi.m_sicurezza.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_vettori.tag) then
//		this.m_archivi.m_vettori.enabled = true
//	else
//		this.m_archivi.m_vettori.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_profis.tag) then
//		this.m_archivi.m_profis.enabled = true
//	else
//		this.m_archivi.m_profis.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_crm.tag) then
//		this.m_archivi.m_crm.enabled = true
//	else
//		this.m_archivi.m_crm.enabled = false
//	end if
////	if autorizza_menu_1(this.m_archivi.m_ausiliari0.m_ausiliari_1.tag) then
////		this.m_archivi.m_ausiliari0.m_ausiliari_1.enabled = true
////	else
////		this.m_archivi.m_ausiliari0.m_ausiliari_1.enabled = false
////	end if
//	if autorizza_menu_1(this.m_archivi.m_opf.m_opf_gestione.tag) then
//		this.m_archivi.m_opf.m_opf_gestione.enabled = true
//	else
//		this.m_archivi.m_opf.m_opf_gestione.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_opf.m_opf_elenco.tag) then
//		this.m_archivi.m_opf.m_opf_elenco.enabled = true
//	else
//		this.m_archivi.m_opf.m_opf_elenco.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_opf.m_opf_gestore_eventi.tag) then
//		this.m_archivi.m_opf.m_opf_gestore_eventi.enabled = true
//	else
//		this.m_archivi.m_opf.m_opf_gestore_eventi.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_codabarre.tag) then
//		this.m_archivi.m_codabarre.enabled = true
//	else
//		this.m_archivi.m_codabarre.enabled = false
//	end if
//	if autorizza_menu_1(this.m_archivi.m_memo.tag) then
//		this.m_archivi.m_memo.enabled = true
//	else
//		this.m_archivi.m_memo.enabled = false
//	end if
//	
	
//	if this.parentwindow.windowtype = mdi! then
//		this.m_finestra.m_disponi.enabled = false
//		this.m_finestra.m_chiudifinestra.enabled = false
//	else
//		this.m_finestra.m_disponi.enabled = true
//		this.m_finestra.m_chiudifinestra.enabled = true
//	end if
	
	
		
//

end subroutine

public function integer u_item ();// sets the is_menuoptions array for the  
// menu assigned to this window.  
// only visible options are included.  
integer    li_limit, li_cnt, li_submenulimit, li_smcnt  
integer    li_count  
string ls_option  
string is_menuoptions[]
li_count = 1  
li_limit = UpperBound (this.item)  
FOR li_cnt = 1 TO li_limit  
   IF (this.item[li_cnt].visible) THEN  
     li_submenulimit = Upperbound(this.item[li_cnt].item)  
      CHOOSE CASE lower(this.item[li_cnt].classname())  
       CASE 'm_window','m_help'  
        // skip these  
        CASE ELSE  
         FOR li_smcnt = 1 to li_submenulimit  
          IF (this.item[li_cnt].item[li_smcnt].Visible) THEN  
            ls_option =lower(this.item[li_cnt].item[li_smcnt].classname())  
            IF (Pos(ls_option,'dash') = 0) THEN // skip any dash entries  
              ls_option +='='+string(this.item[li_cnt].item[li_smcnt].enabled)  
              is_menuoptions[li_count]=ls_option  
              li_count++  
            END IF  
          END IF  
        NEXT  
      END CHOOSE  
   END IF  
NEXT  
RETURN li_limit  

  
end function

public subroutine u_inizializza ();//
m_filtro.menuimage = "filtro.png"
m_filtro.toolbaritemname = "filtro.png"
m_archivi.m_quotazioni.menuimage = "contract16.png"

reset_menu_strumenti( )

if isvalid(kguo_g.kgw_toolbar_programmi) then
		
	kguo_g.kgw_toolbar_programmi.u_inizializza()

end if


end subroutine

public subroutine u_espone_testo_delete (boolean a_menu_espone_tasto_delete);//
//--- Mostra/Nascondi tasto DELETE in toolbar
//
m_finestra.m_gestione.m_fin_elimina.toolbaritemVisible = a_menu_espone_tasto_delete
	
end subroutine

public subroutine u_imposta_window_menu ();//--- Imposta le icone nella Window che simula il menu
m_main km_main

if isvalid(kguo_g.kgw_toolbar_programmi) then
		
	km_main = this
	kguo_g.kgw_toolbar_programmi.post u_build_menu(km_main)

//m_main k_menu
//	k_menu = w_main.menuid 
//	k_menu.autorizza_menu()

end if


  
end subroutine

public subroutine reset_menu_all ();//
//--- Resetta barra strumenti libero1, libero2, libero3....
		reset_menu_strumenti( )
	
	//	m_finestra.m_fin_stampa.visible = false
		m_finestra.m_fin_stampa.enabled = false
		m_finestra.m_aggiornalista.enabled = false
		m_finestra.m_gestione.m_fin_conferma.enabled = false
		m_finestra.m_gestione.m_fin_visualizza.enabled = false
		m_finestra.m_gestione.m_fin_modifica.enabled = false
		m_finestra.m_gestione.m_fin_inserimento.enabled = false
		m_finestra.m_gestione.m_fin_duplica.enabled = false

		m_trova.m_fin_cerca.enabled = false
		m_trova.m_fin_ordina.enabled = false
		m_filtro.enabled = false


end subroutine

public subroutine u_close_window ();//--- 

if isvalid(kguo_g.kgw_toolbar_programmi) then
		
	kguo_g.kgw_toolbar_programmi.event activate( )

end if


  
end subroutine

public subroutine u_close_main ();//--- 

if isvalid(kguo_g.kgw_toolbar_programmi) then
		
	kguo_g.kgw_toolbar_programmi.event close( )

end if


  
end subroutine

public subroutine u_run_shortcutkey (keycode a_keycode, unsignedlong a_keyflags);//
//int k_item, k_item1, k_item2, k_ctr, k_ctr1, k_ctr2
//string k_rc
//long k_key
//
//choose case a_keyflags 
//	case 2 //ctrl
//		k_key = 256
//	case 4 //KeyAlt!
//		k_key = 512
//	case 1 //KeyShift!
//		k_key = 1024
//	case else
//end choose
//CHOOSE CASE a_keycode
// CASE Key0!, KeyNumPad0!
//  k_key += 0
// CASE Key1!, KeyNumPad1!
//  k_key += 1
// CASE Key2!, KeyNumPad2!
//  k_key += 2
// CASE Key3!, KeyNumPad3!
//  k_key += 3
// CASE Key4!, KeyNumPad4!
//  k_key +=4
// CASE Key5!, KeyNumPad5!
//  k_key +=5
// CASE Key6!, KeyNumPad6!
//  k_key +=6
// CASE Key7!, KeyNumPad7!
//  k_key +=7
// CASE Key8!, KeyNumPad8!
//  k_key +=8
// CASE Key9!, KeyNumPad9!
//  k_key +=9
// CASE KeySpaceBar!
//  //k_key = " "
//CASE keyA!
//	k_Key += asc('A')
//CASE keyB!
// 	k_Key += asc('B')
//CASE keyC!
//	k_Key += asc('C')
//CASE keyD!
// 	k_Key += asc('D')
//CASE keyE!
// 	k_Key += asc('E')
//CASE keyF!
// 	k_Key += asc('F')
//CASE keyG!
// 	k_Key += asc('G')
//CASE keyH!
// 	k_Key += asc('H')
//CASE keyI!
// 	k_Key += asc('I')
//CASE keyL!
// 	k_Key += asc('L')
//CASE keyM!
// 	k_Key += asc('M')
//CASE keyN!
// 	k_Key += asc('N')
//CASE keyO!
// 	k_Key += asc('O')
//CASE keyP!
// 	k_Key += asc('P')
//CASE keyQ!
// 	k_Key += asc('Q')
//CASE keyR!
// 	k_Key += asc('R')
//CASE keyS!
// 	k_Key += asc('S')
//CASE keyT!
// 	k_Key += asc('T')
//CASE keyU!
// 	k_Key += asc('U')
//CASE keyV!
// 	k_Key += asc('V')
//CASE keyX!
// 	k_Key += asc('X')
//CASE keyY!
// 	k_Key += asc('Y')
//CASE keyZ!
// 	k_Key += asc('Z')
//END CHOOSE
// 
//
//k_item = upperbound(this.item)
//
//for k_ctr = 1 to k_item
//	
//////--- abilito/disabilito menu 
//////---- I livello 
//// 	if this.item[k_ctr].shortcut > 0 then
////		if autorizza_menu_1(this.item[k_ctr].tag) then
////			this.item[k_ctr].enabled = true
////		else
////			this.item[k_ctr].enabled = false
////		end if
////	end if
//			
////---- II livello 
//	k_item1 = upperbound(this.item[k_ctr].item)
//	for k_ctr1 = 1 to k_item1
//		
//	//--- abilito/disabilito menu 
//		if this.item[k_ctr].item[k_ctr1].shortcut > 0 then
//			k_ctr2 = this.item[k_ctr].item[k_ctr1].shortcut
//			if k_ctr2 = k_key then 
//				k_rc = this.item[k_ctr].item[k_ctr1].tag
//			end if
//		end if
//	next
//next
////---- III livello 
//			k_item2 = upperbound(this.item[k_ctr].item[k_ctr1].item)
//			for k_ctr2 = 1 to k_item2
//				
//			//--- abilito/disabilito menu 
//				if this.item[k_ctr].item[k_ctr1].item[k_ctr2].tag > " " then
//					if autorizza_menu_1(this.item[k_ctr].item[k_ctr1].item[k_ctr2].tag) then
//						this.item[k_ctr].enabled = true  // basta che una sottovoce sia ok che lo è anche il liv superiore
//						this.item[k_ctr].item[k_ctr1].enabled = true  // basta che una sottovoce sia ok che lo è anche il liv superiore
//						this.item[k_ctr].item[k_ctr1].item[k_ctr2].enabled = true
//					else
//						this.item[k_ctr].item[k_ctr1].item[k_ctr2].enabled = false
//					end if
//				end if
//			end for
//		end if
//	end for
//	
//end for


end subroutine

on m_main.create
m_main=this
call super::create
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_file=create m_file
this.m_magazzino=create m_magazzino
this.m_stat=create m_stat
this.m_archivi=create m_archivi
this.m_interrogazioni=create m_interrogazioni
this.m_finestra=create m_finestra
this.m_trova=create m_trova
this.m_filtro=create m_filtro
this.m_strumenti=create m_strumenti
this.m_help=create m_help
this.Item[UpperBound(this.Item)+1]=this.m_file
this.Item[UpperBound(this.Item)+1]=this.m_magazzino
this.Item[UpperBound(this.Item)+1]=this.m_stat
this.Item[UpperBound(this.Item)+1]=this.m_archivi
this.Item[UpperBound(this.Item)+1]=this.m_interrogazioni
this.Item[UpperBound(this.Item)+1]=this.m_finestra
this.Item[UpperBound(this.Item)+1]=this.m_trova
this.Item[UpperBound(this.Item)+1]=this.m_filtro
this.Item[UpperBound(this.Item)+1]=this.m_strumenti
this.Item[UpperBound(this.Item)+1]=this.m_help
end on

on m_main.destroy
call super::destroy
destroy(this.m_file)
destroy(this.m_magazzino)
destroy(this.m_stat)
destroy(this.m_archivi)
destroy(this.m_interrogazioni)
destroy(this.m_finestra)
destroy(this.m_trova)
destroy(this.m_filtro)
destroy(this.m_strumenti)
destroy(this.m_help)
end on

event clicked;//
m_filtro.menuimage = "filtro.png"
m_filtro.toolbaritemname = "filtro.png"
m_archivi.m_quotazioni.menuimage = "contract16.png"

end event

type m_file from menu within m_main
m_setupstampante m_setupstampante
m_f_chiudodb m_f_chiudodb
m_-2 m_-2
m_proprieta m_proprieta
m_utility m_utility
m_-3 m_-3
m_mostrabarrastrumenti m_mostrabarrastrumenti
m_mostrabarradelleapplicazioni m_mostrabarradelleapplicazioni
m_-6 m_-6
m_uscita m_uscita
end type

on m_file.create
call super::create
this.text = "M&2000"
this.microhelp = "Proprietà della Procedura"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "  M2000"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_setupstampante=create m_setupstampante
this.m_f_chiudodb=create m_f_chiudodb
this.m_-2=create m_-2
this.m_proprieta=create m_proprieta
this.m_utility=create m_utility
this.m_-3=create m_-3
this.m_mostrabarrastrumenti=create m_mostrabarrastrumenti
this.m_mostrabarradelleapplicazioni=create m_mostrabarradelleapplicazioni
this.m_-6=create m_-6
this.m_uscita=create m_uscita
this.Item[UpperBound(this.Item)+1]=this.m_setupstampante
this.Item[UpperBound(this.Item)+1]=this.m_f_chiudodb
this.Item[UpperBound(this.Item)+1]=this.m_-2
this.Item[UpperBound(this.Item)+1]=this.m_proprieta
this.Item[UpperBound(this.Item)+1]=this.m_utility
this.Item[UpperBound(this.Item)+1]=this.m_-3
this.Item[UpperBound(this.Item)+1]=this.m_mostrabarrastrumenti
this.Item[UpperBound(this.Item)+1]=this.m_mostrabarradelleapplicazioni
this.Item[UpperBound(this.Item)+1]=this.m_-6
this.Item[UpperBound(this.Item)+1]=this.m_uscita
end on

on m_file.destroy
call super::destroy
destroy(this.m_setupstampante)
destroy(this.m_f_chiudodb)
destroy(this.m_-2)
destroy(this.m_proprieta)
destroy(this.m_utility)
destroy(this.m_-3)
destroy(this.m_mostrabarrastrumenti)
destroy(this.m_mostrabarradelleapplicazioni)
destroy(this.m_-6)
destroy(this.m_uscita)
end on

type m_setupstampante from menu within m_file
end type

on clicked;//
printsetup()
end on

on m_setupstampante.create
call super::create
this.text = "Se&tup stampante"
this.microhelp = "Definizione dei vari parametri della stampante"
this.menuimage = "Print!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_setupstampante.destroy
call super::destroy
end on

type m_f_chiudodb from menu within m_file
event u_constructor pbm_constructor
end type

event u_constructor;//
this.text = 'CIAO'
end event

on clicked;//
//=== Chiudo tutte le windows children
boolean bValid
window wSheet

wSheet = w_main.GetFirstSheet()
IF IsValid(wSheet) THEN
	close(wSheet)
	DO
		wSheet = w_main.GetFirstSheet()
		bValid = IsValid (wSheet)
		IF bValid THEN close(wSheet)
	LOOP WHILE bValid
END IF



end on

on m_f_chiudodb.create
call super::create
this.text = "&Chiudi tutto"
this.microhelp = "Ripristino le videate alla situazione iniziale, chiudendo tutte le windows aperte"
this.menuimage = "Exit!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_f_chiudodb.destroy
call super::destroy
end on

type m_-2 from menu within m_file
end type

on m_-2.create
call super::create
this.visible = false
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-2.destroy
call super::destroy
end on

type m_proprieta from menu within m_file
end type

on m_proprieta.create
call super::create
this.text = "Proprietà"
this.microhelp = "Configurazioni personaloizzate e della Procedura"
this.menuimage = "Preferences!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_proprieta.destroy
call super::destroy
end on

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	K_st_open_w.id_programma = "azp"
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.modifica
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // 
	K_st_open_w.key2 = " " // 
	K_st_open_w.key3 = " " // 
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

type m_utility from menu within m_file
m_password m_password
m_cambiautente m_cambiautente
m_aggiornaprogrammi m_aggiornaprogrammi
m_aggiornaallaversionedisviluppo m_aggiornaallaversionedisviluppo
m_ottimizzadb m_ottimizzadb
m_f_u_-1 m_f_u_-1
m_esportacodapilotainhtml m_esportacodapilotainhtml
m_popolat_contr m_popolat_contr
m_popolalistinodaaccess m_popolalistinodaaccess
m_sistemaricevute m_sistemaricevute
m_esportapassword m_esportapassword
m_importapassword m_importapassword
m_importaanagrafichecrm m_importaanagrafichecrm
m_popolaindirizziddt m_popolaindirizziddt
m_ufo m_ufo
end type

on m_utility.create
call super::create
this.text = "Utility..."
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "utilita~' "
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_password=create m_password
this.m_cambiautente=create m_cambiautente
this.m_aggiornaprogrammi=create m_aggiornaprogrammi
this.m_aggiornaallaversionedisviluppo=create m_aggiornaallaversionedisviluppo
this.m_ottimizzadb=create m_ottimizzadb
this.m_f_u_-1=create m_f_u_-1
this.m_esportacodapilotainhtml=create m_esportacodapilotainhtml
this.m_popolat_contr=create m_popolat_contr
this.m_popolalistinodaaccess=create m_popolalistinodaaccess
this.m_sistemaricevute=create m_sistemaricevute
this.m_esportapassword=create m_esportapassword
this.m_importapassword=create m_importapassword
this.m_importaanagrafichecrm=create m_importaanagrafichecrm
this.m_popolaindirizziddt=create m_popolaindirizziddt
this.m_ufo=create m_ufo
this.Item[UpperBound(this.Item)+1]=this.m_password
this.Item[UpperBound(this.Item)+1]=this.m_cambiautente
this.Item[UpperBound(this.Item)+1]=this.m_aggiornaprogrammi
this.Item[UpperBound(this.Item)+1]=this.m_aggiornaallaversionedisviluppo
this.Item[UpperBound(this.Item)+1]=this.m_ottimizzadb
this.Item[UpperBound(this.Item)+1]=this.m_f_u_-1
this.Item[UpperBound(this.Item)+1]=this.m_esportacodapilotainhtml
this.Item[UpperBound(this.Item)+1]=this.m_popolat_contr
this.Item[UpperBound(this.Item)+1]=this.m_popolalistinodaaccess
this.Item[UpperBound(this.Item)+1]=this.m_sistemaricevute
this.Item[UpperBound(this.Item)+1]=this.m_esportapassword
this.Item[UpperBound(this.Item)+1]=this.m_importapassword
this.Item[UpperBound(this.Item)+1]=this.m_importaanagrafichecrm
this.Item[UpperBound(this.Item)+1]=this.m_popolaindirizziddt
this.Item[UpperBound(this.Item)+1]=this.m_ufo
end on

on m_utility.destroy
call super::destroy
destroy(this.m_password)
destroy(this.m_cambiautente)
destroy(this.m_aggiornaprogrammi)
destroy(this.m_aggiornaallaversionedisviluppo)
destroy(this.m_ottimizzadb)
destroy(this.m_f_u_-1)
destroy(this.m_esportacodapilotainhtml)
destroy(this.m_popolat_contr)
destroy(this.m_popolalistinodaaccess)
destroy(this.m_sistemaricevute)
destroy(this.m_esportapassword)
destroy(this.m_importapassword)
destroy(this.m_importaanagrafichecrm)
destroy(this.m_popolaindirizziddt)
destroy(this.m_ufo)
end on

type m_password from menu within m_utility
end type

event clicked;//=== Lancia il Logo iniziale
//open (w_about)
//
st_open_w kst_open_w
//---17092008kuf_menu_window kuf1_menu_window



//===
//=== Menu Treeview
//===
	kst_open_w.id_programma = kkg_id_programma.sr_change_pwd
	kst_open_w.flag_primo_giro = "S"
	kst_open_w.flag_modalita = kkg_flag_modalita.modifica
	kst_open_w.flag_adatta_win = KKG.ADATTA_WIN
	kst_open_w.flag_leggi_dw = " "
	kst_open_w.flag_cerca_in_lista = " "
	kst_open_w.key1 = string(kguo_utente.get_pwd())
	kst_open_w.key2 = " "
	kst_open_w.key3 = " "
	kst_open_w.key4 = " " 

	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(kst_open_w)
	//---17092008destroy kuf1_menu_window


							
							



end event

on m_password.create
call super::create
this.tag = "about"
this.text = "Cambia Password"
this.microhelp = "Modifica la Password di accesso alla Procedura "
this.menuimage = "Custom016!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_password.destroy
call super::destroy
end on

type m_cambiautente from menu within m_utility
end type

event clicked;//
st_open_w kst_open_w

	kst_open_w.flag_modalita = kkg_flag_modalita.inserimento
	OpenWithParm(w_about_start, kst_open_w)


end event

on m_cambiautente.create
call super::create
this.text = "Cambia Utente"
this.microhelp = "Riconnessione Utente"
this.menuimage = "UserObject1!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_cambiautente.destroy
call super::destroy
end on

type m_aggiornaprogrammi from menu within m_utility
end type

event clicked;//
kuf_utility kuf1_utility


	if not kGuf_data_base.u_if_chiudi_procedura() then
		
		messagebox ("Aggiornamento Procedura M2000", "Prima di procedere occorre chiudere tutte le 'funzioni' aperte", &
						information!)
	
	else
		if messagebox ("Procedura M2000", "Vuoi eseguire l'aggiornamento dei programmi?", &
						 question!, YesNo!, 2) = 1 then

			kuf1_utility = create kuf_utility			 
			kuf1_utility.u_aggiorna_procedura()			
			destroy kuf1_utility
			
		end if
	end if
end event

on m_aggiornaprogrammi.create
call super::create
this.tag = "about"
this.text = "Aggiorna Programmi"
this.menuimage = "Update5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_aggiornaprogrammi.destroy
call super::destroy
end on

type m_aggiornaallaversionedisviluppo from menu within m_utility
end type

event clicked;//
kuf_utility kuf1_utility
boolean k_aggiorna

	if not kGuf_data_base.u_if_chiudi_procedura() then
		
		messagebox ("Aggiornamento Procedura M2000", "Prima di procedere occorre chiudere tutte le 'funzioni' aperte", &
						information!)
	
	else
		if messagebox ("Procedura M2000", "Vuoi eseguire l'aggiornamento alla versione di Sviluppo (non stabile) dei programmi?", &
						 question!, YesNo!, 2) = 1 then

			kuf1_utility = create kuf_utility			 
			kuf1_utility.u_aggiorna_procedura_diprova()			
			destroy kuf1_utility
			
		end if
	end if
end event

on m_aggiornaallaversionedisviluppo.create
call super::create
this.text = "Aggiorna alla versione di sviluppo"
this.menuimage = "Update5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_aggiornaallaversionedisviluppo.destroy
call super::destroy
end on

type m_ottimizzadb from menu within m_utility
m_generadatawarehouse m_generadatawarehouse
m_generatabtempimedigiriimpianto m_generatabtempimedigiriimpianto
m_statistichegenerico m_statistichegenerico
m_statisticheindici m_statisticheindici
m_creatabellanavigatore m_creatabellanavigatore
m_creaview m_creaview
m_chiudelottiaperti m_chiudelottiaperti
m_generaprezzimensili m_generaprezzimensili
m_attivatestlogperdataeora m_attivatestlogperdataeora
m_attivatrace m_attivatrace
end type

on m_ottimizzadb.create
call super::create
this.text = "Ottimizza DB e Altre Operazioni"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_generadatawarehouse=create m_generadatawarehouse
this.m_generatabtempimedigiriimpianto=create m_generatabtempimedigiriimpianto
this.m_statistichegenerico=create m_statistichegenerico
this.m_statisticheindici=create m_statisticheindici
this.m_creatabellanavigatore=create m_creatabellanavigatore
this.m_creaview=create m_creaview
this.m_chiudelottiaperti=create m_chiudelottiaperti
this.m_generaprezzimensili=create m_generaprezzimensili
this.m_attivatestlogperdataeora=create m_attivatestlogperdataeora
this.m_attivatrace=create m_attivatrace
this.Item[UpperBound(this.Item)+1]=this.m_generadatawarehouse
this.Item[UpperBound(this.Item)+1]=this.m_generatabtempimedigiriimpianto
this.Item[UpperBound(this.Item)+1]=this.m_statistichegenerico
this.Item[UpperBound(this.Item)+1]=this.m_statisticheindici
this.Item[UpperBound(this.Item)+1]=this.m_creatabellanavigatore
this.Item[UpperBound(this.Item)+1]=this.m_creaview
this.Item[UpperBound(this.Item)+1]=this.m_chiudelottiaperti
this.Item[UpperBound(this.Item)+1]=this.m_generaprezzimensili
this.Item[UpperBound(this.Item)+1]=this.m_attivatestlogperdataeora
this.Item[UpperBound(this.Item)+1]=this.m_attivatrace
end on

on m_ottimizzadb.destroy
call super::destroy
destroy(this.m_generadatawarehouse)
destroy(this.m_generatabtempimedigiriimpianto)
destroy(this.m_statistichegenerico)
destroy(this.m_statisticheindici)
destroy(this.m_creatabellanavigatore)
destroy(this.m_creaview)
destroy(this.m_chiudelottiaperti)
destroy(this.m_generaprezzimensili)
destroy(this.m_attivatestlogperdataeora)
destroy(this.m_attivatrace)
end on

type m_generadatawarehouse from menu within m_ottimizzadb
end type

event clicked;//
string k_return
kuf_stat_batch kuf1_stat_batch


setpointer(kkg.pointer_attesa)
		
//--- apre la connessione al DB PILOTA
try
	kuf1_stat_batch = create kuf_stat_batch

	if messagebox ("Genera Data Warehouse", &
						"L'operazione rigenera i dati di magazzino per Statistici di Produzione e altri consuntivi~n~r" &
						+ "ATTENZIONE, l'operazione dura diversi minuti. Si consiglia di NON chiudere l'applicativo." &
						+" ~n~r" &
						+ "Vuoi procedere con l'esecuzione?" &
						 ,question!, YesNo!, 2) = 1 then

		k_return = kuf1_stat_batch.run_stat_0_batch()
		messagebox ("Genera Data Warehouse", &
					"L'operazione è conclusa.~n~r" &
					+ "Esito (parziale):~n~r" &
					+ trim(k_return) &
					 ,Information!) 
	
	end if
	
catch (uo_exception kuo_exception)
	kuo_exception.messaggio_utente()

finally
	destroy kuf1_stat_batch

end try

setpointer(kkg.pointer_default)

end event

on m_generadatawarehouse.create
call super::create
this.text = "Genera Data Warehouse"
this.microhelp = "Popola magazzino dati per fare gli ~'Statistici~'"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_generadatawarehouse.destroy
call super::destroy
end on

type m_generatabtempimedigiriimpianto from menu within m_ottimizzadb
end type

event clicked;//
st_esito kst_esito
kuf_pilota_previsioni_batch kuf1_pilota_previsioni_batch


setpointer(kkg.pointer_attesa)
		
try
	kuf1_pilota_previsioni_batch = create kuf_pilota_previsioni_batch

	if messagebox ("Genera Tabella Tempi Medi Giri Impianto", &
						"L'operazione popola la tabella con i dati dei tempi medi giri impianto degli ultimi anni~n~r" &
						+ "ATTENZIONE, l'operazione può durare alcuni minuti. Si consiglia di NON chiudere l'applicativo." &
						+" ~n~r" &
						+ "Vuoi procedere con l'esecuzione?" &
						 ,question!, YesNo!, 2) = 1 then

		kst_esito = kuf1_pilota_previsioni_batch.u_batch_run( )
		messagebox ("Operazione Conlusa", &
					"Generati Tabella Tempi Medi Giri Impianto. " &
					+ "Esito:~n~r" &
					+ trim(kst_esito.sqlerrtext) &
					 ,Information!) 
	
	end if
	
catch (uo_exception kuo_exception)
	kuo_exception.messaggio_utente()

finally
	destroy kuf1_pilota_previsioni_batch

end try

setpointer(kkg.pointer_default)

end event

on m_generatabtempimedigiriimpianto.create
call super::create
this.text = "Genera tab. Tempi Medi Giri Impianto"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_generatabtempimedigiriimpianto.destroy
call super::destroy
end on

type m_statistichegenerico from menu within m_ottimizzadb
end type

event clicked;//
string k_return
kuf_update_stat_batch kuf1_update_stat_batch


		
//--- apre la connessione al DB PILOTA
try
	kuf1_update_stat_batch = create kuf_update_stat_batch

	if messagebox("Ottimizzazione DB", &
				  "L'operazione velocizza l'accesso alle tabelle e non comporta alcun rischio, prosegure?~n~r", question!, yesno!, 1) = 2 then
	
		MessageBox("Ottimizzazione DB", "Elaborazione non eseguita, interrotta dall'utente", &
							StopSign!)
	else
	
		setpointer(kkg.pointer_attesa)
																		
//		DECLARE ksp_updatestats PROCEDURE FOR sp_updatestats () USING kguo_sqlca_db_magazzino ;
//		EXECUTE ksp_updatestats; 
//		setpointer(kkg.pointer_default)
//		MessageBox("Ottimizzazione DB", "Elaborazione terminata.")
		
		
		k_return = kuf1_update_stat_batch.run_update_stat()
		messagebox ("Genera Data Warehouse", &
					"L'operazione è conclusa.~n~r" &
					+ "Esito (parziale):~n~r" &
					+ trim(k_return) &
					 ,Information!) 
		
	end if


catch (uo_exception kuo_exception)
	setpointer(kkg.pointer_default)
	kuo_exception.messaggio_utente()

finally
	destroy kuf1_update_stat_batch

end try
	

end event

on m_statistichegenerico.create
call super::create
this.text = "Statistiche generico"
this.microhelp = "comando di ~'Update Statistics~'"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_statistichegenerico.destroy
call super::destroy
end on

type m_statisticheindici from menu within m_ottimizzadb
end type

event clicked;//
pointer kpointer_orig

kpointer_orig = setpointer(hourglass!)

//sqlca.genidxstats()
if sqlca.sqlcode < 0 then
	messagebox("Generazione Statistici Indici",&
	"Operazione in errore, codice " + string(sqlca.sqldbcode)+ ", msg: " + trim(sqlca.sqlerrtext), stopsign!)
else
	messagebox("Generazione Statistici Indici","Operazione Conclusa Correttamente")
end if

setpointer(kpointer_orig)

end event

on m_statisticheindici.create
call super::create
this.visible = false
this.text = "Statistiche Indici"
this.enabled = false
this.microhelp = "lancio Procedure su DB di aggiornamento Capi indicizzati"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_statisticheindici.destroy
call super::destroy
end on

type m_creatabellanavigatore from menu within m_ottimizzadb
end type

event clicked;//
kuf_treeview  kuf1_treeview

try

	kuf1_treeview = create kuf_treeview
			
	
	if messagebox("Crea Tabella del Navigatore", &
						  "Attenzione se fallisce l'operazione il Navigatore non sarà più accedibile~n~r" , 	exclamation!, yesno!, 1) = 2 then
	
		MessageBox("Elaborazione non eseguita",  "Elaborazione Interrotta dall'utente", &
							StopSign!)
	else
	
		kuf1_treeview.u_crea_treeview_prod( )
		MessageBox("Fine elaborazione", "Elaborazione terminata correttamente.")
	
	end if


catch (uo_exception kuo_exception)
	kuo_exception.messaggio_utente()		

end try
 

end event

on m_creatabellanavigatore.create
call super::create
this.text = "Crea Tabella Navigatore"
this.microhelp = "Ricrea la tabella  menu del Navigatore - Fare Attenzione! "
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_creatabellanavigatore.destroy
call super::destroy
end on

type m_creaview from menu within m_ottimizzadb
end type

event clicked;//
kuf_utility_db  kuf1_utility_db

try

	kuf1_utility_db = create kuf_utility_db
			
	
	if messagebox("Crea View", &
						  "Genera View utile alle elaborazioni della Procedura (operazione non distruttiva)~n~r" , 	exclamation!, yesno!, 1) = 2 then
	
		MessageBox("Elaborazione non eseguita",  "Elaborazione Interrotta dall'utente", &
							StopSign!)
	else
	
		if kuf1_utility_db.u_crea_view() then
			MessageBox("Fine elaborazione", "Elaborazione terminata correttamente.")
		else
			MessageBox("Elaborazione interrotta", "Elaborazione terminata per errore. Alcune view non sono state create correttamente")
		end if
			
	
	end if


catch (uo_exception kuo_exception)
	kuo_exception.messaggio_utente()		
	
end try
 


end event

on m_creaview.create
call super::create
this.tag = "master"
this.text = "Crea View"
this.microhelp = "Crea View utili alla procedura"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_creaview.destroy
call super::destroy
end on

type m_chiudelottiaperti from menu within m_ottimizzadb
end type

event clicked;//
kuf_meca_chiudi kuf1_meca_chiudi
st_tab_g_0 kst_tab_g_0

kuf1_meca_chiudi = create kuf_meca_chiudi

kst_tab_g_0.id = 1
kst_tab_g_0.idx = ""

kuf1_meca_chiudi.u_open_applicazione(kst_tab_g_0, kkg_flag_modalita.modifica)

destroy kuf1_meca_chiudi

//long k_righe=0
//st_tab_meca kst_tab_meca
//kuf_armo  kuf1_armo
//
//
//try
//
//	kuf1_armo = create kuf_armo
//
//	kst_tab_meca.data_int = relativedate(kguo_g.get_dataoggi( ), -60)
//	
//	if messagebox("Chiude Lotti", &
//						  "Attenzione Chiude DEFINITIVAMENTE tutti i Lotti spediti e entrati fino al "+ string(kst_tab_meca.data_int) + " ~n~r" , 	exclamation!, yesno!, 1) = 2 then
//	
//		MessageBox("Elaborazione non eseguita",  "Elaborazione Interrotta dall'utente", &
//							StopSign!)
//	else
//	
//		setpointer(kkg.POINTER_ATTESA)
//		kst_tab_meca.id = 0
//		k_righe=kuf1_armo.set_aperto_no_spediti(kst_tab_meca)
//		MessageBox("Fine elaborazione", "Elaborazione terminata correttamente. Chiusi " + string(k_righe) + " Lotti. " )
//	
//	end if
//
//catch (uo_exception kuo_exception)
//	kuo_exception.messaggio_utente()		
//end try
//
//
end event

on m_chiudelottiaperti.create
call super::create
this.tag = "master"
this.text = "Chiude Lotti Aperti"
this.enabled = false
this.microhelp = "Verifica Lotti completamente spediti e fatturati Chiudendoli"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_chiudelottiaperti.destroy
call super::destroy
end on

type m_generaprezzimensili from menu within m_ottimizzadb
end type

event clicked;//
int k_righe = 0
st_tab_armo_prezzi kst_tab_armo_prezzi
kuf_armo_prezzi  kuf1_armo_prezzi



try

	kuf1_armo_prezzi = create kuf_armo_prezzi
			
	
	if messagebox("Aggiorna Prezzi Mensili Lotti", &
						  "Attenzione questa operazione Aggiorna i Lotti in giacenza con Prezzi tipo 'canone Mensile'~n~rLotti in giacenza al primo del mese precedente" , 	exclamation!, yesno!, 1) = 2 then
	
		MessageBox("Elaborazione non eseguita",  "Elaborazione Interrotta dall'utente", StopSign!)
	else
		setpointer(kkg.POINTER_ATTESA)
		kst_tab_armo_prezzi.id_armo = 0
		k_righe = kuf1_armo_prezzi.esegui_evento_mese(kst_tab_armo_prezzi)
		MessageBox("Fine elaborazione", "Elaborazione terminata correttamente. Aggiornati " + string(k_righe) + " righe prezzi Lotto. " )
	
	end if

catch (uo_exception kuo_exception)
	kuo_exception.messaggio_utente()		
end try


end event

on m_generaprezzimensili.create
call super::create
this.tag = "master"
this.text = "Genera Prezzi Mensili"
this.microhelp = "Aggiorna prezzi mensili x i lotti ancora in giacenza"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_generaprezzimensili.destroy
call super::destroy
end on

type m_attivatestlogperdataeora from menu within m_ottimizzadb
end type

event clicked;//
this.checked = kguo_g.kG_ScriviLog_attiva
kguo_g.kG_ScriviLog_attiva = this.checked

	kguo_g.kG_ScriviLog_attiva = not kguo_g.kG_ScriviLog_attiva
	if kguo_g.kG_ScriviLog_attiva then
		messagebox("TRACCIAMENTO AVVIATO", "Per disattivare il Tracciamento LOG richiamare di nuovo questa funzione o uscire dalla Procedura")
	else
		messagebox("TRACCIAMENTO FERMATO", "Per attivare il Tracciamento LOG richiamare di nuovo questa funzione")
	end if
	
this.checked = kguo_g.kG_ScriviLog_attiva



end event

on m_attivatestlogperdataeora.create
call super::create
this.text = "Attiva Test LOG per data e ora"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_attivatestlogperdataeora.destroy
call super::destroy
end on

type m_attivatrace from menu within m_ottimizzadb
end type

on m_attivatrace.create
call super::create
this.text = "Attiva TRACE"
this.microhelp = "Registra azioni della Procedura x trovare errori"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_attivatrace.destroy
call super::destroy
end on

event clicked;//
this.checked = not this.checked
kguo_g.kG_trace_attiva = this.checked
int k_rc=0

if messagebox("Avvio Trace", "Avviare la TRACE ora", question!, yesno!, 2) = 1 then

	k_rc =  kGuf_data_base.u_dbg_trace_open(not kGuf_data_base.ki_trace_attiva )
	if k_rc = 1 then
		messagebox("TRACE AVVIATA", "Per disattivare la TRACE richiamare di nuovo questa funzione o uscire dalla Procedura")
	else
		if k_rc = 2 then
			messagebox("TRACE FERMATA", "Per attivare la TRACE richiamare di nuovo questa funzione")
		else
			messagebox("Operazione NON eseguita", "Non è stato possibile cambiare lo stato della TRACE")
		end if
	end if
	
end if



end event

type m_f_u_-1 from menu within m_utility
end type

on m_f_u_-1.create
call super::create
this.visible = false
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_f_u_-1.destroy
call super::destroy
end on

type m_esportacodapilotainhtml from menu within m_utility
end type

event clicked;//
st_esito kst_esito
kuf_report_pilota_html kuf1_report_pilota_html


try
	if messagebox ("Esporta Dati", "Vuoi esportare i Report di Programmazione Impianto in HTML?", question!, YesNo!, 2) = 1 then
		
		setpointer(kkg.pointer_attesa)
		
		kuf1_report_pilota_html = create kuf_report_pilota_html
			
		kst_esito = kuf1_report_pilota_html.u_batch_run() 

	end if
catch (uo_exception kuo_exception)
	kst_esito = kuo_exception.get_st_esito()
	
finally
	messagebox("Operazione Conclusa", kst_esito.sqlerrtext)
	if isvalid(kuf1_report_pilota_html) then destroy kuf1_report_pilota_html
	setpointer(kkg.pointer_default)

end try
 
end event

on m_esportacodapilotainhtml.create
call super::create
this.tag = "master"
this.text = "Esporta Coda Pilota in HTML"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_esportacodapilotainhtml.destroy
call super::destroy
end on

type m_popolat_contr from menu within m_utility
end type

event clicked;//
kuf_utility  kuf1_utility

kuf1_utility = create kuf_utility
		
kuf1_utility.ext_popola_id_sped() 

destroy kuf1_utility
 
 
end event

on m_popolat_contr.create
call super::create
this.tag = "master"
this.visible = false
this.text = "Aggiusta codice ID_SPED"
this.enabled = false
this.microhelp = "Aggiorna tab.ARSP da SPED"
this.toolbaritemvisible = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_popolat_contr.destroy
call super::destroy
end on

type m_popolalistinodaaccess from menu within m_utility
end type

event clicked;//
kuf_utility  kuf1_utility

kuf1_utility = create kuf_utility
		
kuf1_utility.ext_sistema_artr( )

destroy kuf1_utility
 

end event

on m_popolalistinodaaccess.create
call super::create
this.tag = "master"
this.visible = false
this.text = "Sistema ARTR"
this.enabled = false
this.microhelp = "Popola il  campo ID della RIC, operazione di aggiornamento, non pericolosa"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_popolalistinodaaccess.destroy
call super::destroy
end on

type m_sistemaricevute from menu within m_utility
end type

event clicked;//
kuf_utility  kuf1_utility

kuf1_utility = create kuf_utility
		
kuf1_utility.ext_sistema_prof( ) 

destroy kuf1_utility
 

end event

on m_sistemaricevute.create
call super::create
this.tag = "master"
this.visible = false
this.text = "Sistema Arch. ESOLVER"
this.enabled = false
this.microhelp = "Aggiorna in tab. PROF il campo ID_FATTURE leggendo la tabella ARFA_TESTA"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_sistemaricevute.destroy
call super::destroy
end on

type m_esportapassword from menu within m_utility
end type

event clicked;//

//---17092008kuf_menu_window kuf1_menu_window
kuf_sr_sicurezza  kuf1_sr_sicurezza 
st_esito kst_esito

kuf1_sr_sicurezza  = create kuf_sr_sicurezza 
		
kst_esito = kuf1_sr_sicurezza.u_esporta_password( )

destroy kuf1_sr_sicurezza 

messagebox ("Operazione Terminata", "Esportate " + trim(kst_esito.SQLErrText) + " password.")


//
//messagebox ("Immissione t_armo_1", kst_esito.sqlerrtext)
//
//	k_sql = "drop temp TABLE  t_armo_1 " 
//	EXECUTE IMMEDIATE :k_sql using sqlca;
//	
//	k_sql = " CREATE  TABLE  informix.t_armo_1 " + &
//	"	(num_int INTEGER , data_int DATE , " + &
//	"	colli_2 DECIMAL(5,0) , m_cubi DECIMAL(6,2) , " + &
//	"	peso_kg DECIMAL(8,2) , colli_fatt DECIMAL(5,0) , " + &
//	"	magazzino SMALLINT , pedane DECIMAL(5,2) ) " 
//	EXECUTE IMMEDIATE :k_sql using sqlca;
//	
//	k_sql = "CREATE INDEX t_armo_1_idx1 ON informix.t_armo_1 (data_int , num_int ) " 
//	EXECUTE IMMEDIATE :k_sql using sqlca;
//	
//	k_sql = + &
//	"insert into t_armo_1 (magazzino, num_int,data_int,colli_2,m_cubi,peso_kg,colli_fatt,pedane)  " + &
//	"select magazzino, num_int, data_int, sum(colli_2), sum(m_cubi), sum(peso_kg), sum(colli_fatt), sum(pedane) " + &
//	"from armo  group by magazzino, num_int, data_int "
//	EXECUTE IMMEDIATE :k_sql using sqlca;
//
//
//
//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
//	st_open_w k_st_open_w
//
//	K_st_open_w.id_programma = "stb"
//	K_st_open_w.flag_primo_giro = "S"
//	K_st_open_w.flag_modalita = " "
//	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
//	K_st_open_w.flag_leggi_dw = " "
//	K_st_open_w.flag_cerca_in_lista = " "
//	K_st_open_w.key1 = " " // cod cliente
//	K_st_open_w.key2 = " " // cod articolo 
//	K_st_open_w.key3 = " " // dose
//	K_st_open_w.key4 = " " // misure imballo
//	K_st_open_w.key5 = " " // misure imballo
//	K_st_open_w.key6 = " " // misure imballo
//	K_st_open_w.flag_where = " "
//	
//	//---17092008kuf1_menu_window = create kuf_menu_window 
//	kGuf_menu_window.open_w_tabelle(k_st_open_w)
//	//---17092008destroy kuf1_menu_window
// 

end event

on m_esportapassword.create
call super::create
this.tag = "srpassword"
this.visible = false
this.text = "Esporta Password"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_esportapassword.destroy
call super::destroy
end on

type m_importapassword from menu within m_utility
end type

event clicked;//
//---17092008kuf_menu_window kuf1_menu_window
kuf_sr_sicurezza  kuf1_sr_sicurezza 
st_esito kst_esito


if messagebox ("Operazione DISTRUTTIVA", "Vuoi ricoprire le Password di TUTTI gli UTENTI della Procedura?", &
						 question!, YesNo!, 2) = 1 then

	
	kuf1_sr_sicurezza  = create kuf_sr_sicurezza 
			
	kst_esito = kuf1_sr_sicurezza.u_importa_password( )
	
	destroy kuf1_sr_sicurezza 
	
	if len(trim(kst_esito.SQLErrText))> 0 then
		messagebox ("Operazione Terminata", "Importare " + trim(kst_esito.SQLErrText) + " password.")
	else
		messagebox ("Operazione Terminata", "Nessuna password importata.")
	end if
	

end if
end event

on m_importapassword.create
call super::create
this.tag = "srpassword"
this.visible = false
this.text = "Importa Password"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_importapassword.destroy
call super::destroy
end on

type m_importaanagrafichecrm from menu within m_utility
end type

event clicked;//
   Opensheet (w_import_cvs_crm_anag, w_main, 2, Original!)


end event

on m_importaanagrafichecrm.create
call super::create
this.visible = false
this.text = "Importa Anagrafiche CRM"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_importaanagrafichecrm.destroy
call super::destroy
end on

type m_popolaindirizziddt from menu within m_utility
end type

event clicked;//
kuf_utility  kuf1_utility

kuf1_utility = create kuf_utility
		
kuf1_utility.ext_popola_sped_indi() 

destroy kuf1_utility

end event

on m_popolaindirizziddt.create
call super::create
this.visible = false
this.text = "Popola indirizzi d.d.t."
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_popolaindirizziddt.destroy
call super::destroy
end on

type m_ufo from menu within m_utility
end type

event clicked;n_cst_outlook kn_cst_outlook
kn_cst_outlook.of_create_email("C:\ufo\interno\20161207\noaccettati.pdf", "AMalaguti@sterigenics.com")

//////////////////////*********************REDUCED CODE******************************************///////////////////////////////
//mailSession lms_Ses
//mailMessage lmm_mensaje
//mailReturnCode mrc_abierta,lmrc_enviado,lmrc_cerrada
//
//
//MessageBox("Email OUTLOOK", "CREATE mailSession")
//lms_Ses=CREATE mailSession
//
//
//MessageBox("Email OUTLOOK", "lms_Ses.mailLogon")
//mrc_abierta=lms_Ses.mailLogon()
////mrc_abierta=lms_Ses.mailLogon(mailNewSession!) //We have tried this option too, but we get the same return
//
//
//if mrc_abierta=mailReturnLoginFailure! then
// MessageBox("Email OUTLOOK", 'lms_Ses.mailLogon mailReturnLoginFailure!')
// return -1
//elseif mrc_abierta=mailReturnInsufficientMemory! then
// MessageBox("Email OUTLOOK", 'lms_Ses.mailLogon mailReturnInsufficientMemory!')
// return -1
//elseif mrc_abierta <> mailReturnSuccess! THEN
// MessageBox("Email OUTLOOK", 'lms_Ses.mailLogon Logon failed')
// return -1
//end if
//
//
//lmm_mensaje.Subject='TEST OGGETTO'
//lmm_mensaje.NoteText='TEST TESTO'
//
//
//lmm_mensaje.recipient[1].name='Alberto' //We have tried without this option too, but we get the same return. In 32-bit displays the Address dialog box 
//lmm_mensaje.recipient[1].address ='cod0122@gmail.com' //we have used a valid email here
//lmm_mensaje.recipient[1].RecipientType=mailTo! //We have tried without this option too, but we get the same return
//
//
//MessageBox("Email OUTLOOK", "lms_Ses.MailSend before")
//lmrc_enviado=lms_Ses.MailSend(lmm_mensaje) ///<<<-----------HERE IS WHERE WE GET THE ERROR IN 64-bit
//MessageBox("Email OUTLOOK", "lms_Ses.MailSend after")
//if lmrc_enviado=mailReturnInsufficientMemory! then
// MessageBox("Email OUTLOOK", "mailReturnFailure!")
// DESTROY lms_Ses
// Return -2
//elseif lmrc_enviado=mailReturnFailure! then
// MessageBox("Email OUTLOOK", "mailReturnFailure!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnLoginFailure! then
// MessageBox("Email OUTLOOK", "mailReturnLoginFailure!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnUserAbort! then
// MessageBox("Email OUTLOOK", "mailReturnUserAbort!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnDiskFull! then
// MessageBox("Email OUTLOOK", "mailReturnDiskFull!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnTooManySessions! then
// MessageBox("Email OUTLOOK", "mailReturnTooManySessions!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnTooManyFiles! then
// MessageBox("Email OUTLOOK", "mailReturnTooManyFiles!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnTooManyRecipients! then
// MessageBox("Email OUTLOOK", "mailReturnTooManyRecipients!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnUnknownRecipient! then
// MessageBox("Email OUTLOOK", "mailReturnUnknownRecipient!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado=mailReturnAttachmentNotFound! then
// MessageBox("Email OUTLOOK", "mailReturnAttachmentNotFound!")
// DESTROY lms_Ses
// RETURN -2
//elseif lmrc_enviado<>mailReturnSuccess! THEN
// MessageBox("Email OUTLOOK", "OTHER ERROR")
// DESTROY lms_Ses
// RETURN -2
//END IF
//
//
//MessageBox("Email OUTLOOK", "lms_Ses.maillogoff")
//lmrc_cerrada=lms_Ses.maillogoff()
//IF lmrc_cerrada<>mailReturnSuccess! THEN
// MessageBox("Email OUTLOOK", "lms_Ses.maillogoff ERROR")
// DESTROY lms_Ses
// RETURN -3
//END IF
//
//
//DESTROY lms_Ses
//
//
//RETURN 1
////////////////////******************************************************************************///////////////////////////////

//
//w_utility_bar w1
//
//if messagebox ("Operazione di TEST", &
//         "Test, proseguire?", &
//						 question!, YesNo!, 2) = 1 then
//
//mailsession lms_sess
//mailmessage lm_mess
//mailrecipient lm_recipient
//mailFileDescription lmf_file
//mailreturncode lmc_rc
//
//
//lmf_file.FileType = mailAttach!
//lmf_file.FileName = "noaccettati.pdf"
//lmf_file.PathName = "C:\ufo\interno\20161207\" + "noaccettati.pdf"
//
//lm_mess.NoteText = "test report."
//lm_mess.Subject = "test "
//lm_mess.Attachmentfile[1] = lmf_file
//
//lm_recipient.Address = "cod0122@gmail.com"
//lm_recipient.Name = "Alberto"
//lm_recipient.RecipientType = mailOriginator! //mailTo!
//lm_mess.Recipient[1] = lm_recipient
//
//lms_sess = create mailsession
//lmc_rc = lms_Sess.mailLogon()
//lms_Sess.mailrecipientdetails(lm_recipient, true)
////lms_Sess.MailSaveMessage("test",lm_Mess)
//lmc_rc = lms_Sess.mailSend(lm_Mess)
//
//
//IF lmc_rc <> mailReturnSuccess! THEN
//        MessageBox("Error", "Error on Send")
//END IF
//
//lmc_rc = lms_sess.mailLogoff()
//DESTROY lms_sess
//
////	kuf_file_explorer kuf1_file_explorer
////	kuf1_file_explorer = create kuf_file_explorer
////	kuf1_file_explorer.of_email("cod0122@gmail.com", "", "test", "ciao", "C:\ufo\interno\20161207\noaccettati.pdf")
//end if

//kuf_utility kuf1_utility


//try
//	kuf1_utility = create kuf_utility

//	kuf1_utility.ext_esempio( )			
//			
			
			
//	long k_codice		
//	string p_fname, p_lname, p_add, p_city, p_state, p_zip, emp_proc	
//
//k_codice = 37
//
//
// DECLARE emp_proc PROCEDURE FOR gsp_read_address  
//			using kguo_sqlca_db_magazzino ;

//declare emp_proc procedure for gsp_read_address
//(@k_codice = :k_codice, 
//@p_fname = :p_fname ,
//@p_lname = :p_lname ,
//@p_add = :p_add ,
//@p_city = :p_city ,
//@p_zip = :p_zip output );
//using kguo_sqlca_db_magazzino ;

//	execute emp_proc ;

	//kuf1_utility.ext_popola_sd_md( )
	//kuf1_utility.ext_popola_new_tab()
//	kGuf_data_base.db_set_isolation_level( )
//fetch 	emp_proc into 
//  :p_fname ,
// :p_lname ,
// :p_add ,
// :p_city ,
// :p_zip output ;
// 
//
//	messagebox ("Operazione Terminata", "Fine ")
//
//catch (uo_exception kuo_exception)
//	kuo_exception.messaggio_utente()
//finally
//	destroy kuf1_utility
//
//end try


end event

on m_ufo.create
call super::create
this.tag = "master"
this.visible = false
this.text = "utilità generica"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_ufo.destroy
call super::destroy
end on

type m_-3 from menu within m_file
end type

on m_-3.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-3.destroy
call super::destroy
end on

type m_mostrabarrastrumenti from menu within m_file
event create ( )
event destroy ( )
end type

on m_mostrabarrastrumenti.create
call super::create
this.text = "Mostra Barra Strumenti"
this.menuimage = "Menu!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_mostrabarrastrumenti.destroy
call super::destroy
end on

event clicked;//
//window wSheet
//
//	wSheet = w_main.GetActiveSheet( )
//	IF IsValid(wSheet) THEN
//		this.checked = true
//		wSheet.settoolbar(1,true)
//	else
//		w_main.settoolbar(1,true)
//	end if
//
kuf_menu_tree kuf1_menu_tree

	kuf1_menu_tree = create kuf_menu_tree

//--- La window con il menu TOOLBAR
	kuf1_menu_tree.u_open( )

	if isvalid(kuf1_menu_tree) then destroy kuf1_menu_tree


end event

type m_mostrabarradelleapplicazioni from menu within m_file
event create ( )
event destroy ( )
end type

on m_mostrabarradelleapplicazioni.create
call super::create
this.tag = "to"
this.visible = false
this.text = "Mostra Barra delle Applicazioni"
this.enabled = false
this.checked = true
this.microhelp = "Mostra le ~'barre~' a icone delle funzioni  della procedua"
this.toolbaritemvisible = false
this.toolbaritemname = "menu!"
this.toolbaritemtext = "Mostra le Toolbar"
this.toolbaritemorder = 50
this.toolbaritemspace = 1
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_mostrabarradelleapplicazioni.destroy
call super::destroy
end on

event clicked;//
window kwindow 
kuf_utility kuf1_utility

	if this.checked then
		this.checked = false
		w_toolbar_programmi.visible = false
	else
		this.checked = true
		w_toolbar_programmi.visible = true
	end if
	

end event

type m_-6 from menu within m_file
event create ( )
event destroy ( )
end type

on m_-6.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-6.destroy
call super::destroy
end on

type m_uscita from menu within m_file
end type

on clicked;close(w_main)
end on

on m_uscita.create
call super::create
this.text = "&Uscita"
this.microhelp = "Fine Lavoro"
this.menuitemtype = menuitemtypeexit!
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_uscita.destroy
call super::destroy
end on

type m_magazzino from menu within m_main
m_mag_navigatore m_mag_navigatore
m_marketing m_marketing
m_lotti m_lotti
m_caricalotto m_caricalotto
m_lottisd m_lottisd
m_-4 m_-4
m_groupage m_groupage
m_pianidilavorazione m_pianidilavorazione
m_convalidalavorazioni m_convalidalavorazioni
m_attestati m_attestati
m_1 m_1
m_ddt m_ddt
m_spedizioni m_spedizioni
m_stampaspedizioni m_stampaspedizioni
m_-1 m_-1
m_fatture m_fatture
m_stampafatture m_stampafatture
m_scadenzario m_scadenzario
m_0 m_0
m_email0 m_email0
m_esportadocumenti m_esportadocumenti
m_-0 m_-0
m_etichbarcode m_etichbarcode
m_barcodemanuale m_barcodemanuale
m_barcodedosimetro m_barcodedosimetro
m_-5 m_-5
m_creapackinglistdaweb m_creapackinglistdaweb
m_importapackinglist m_importapackinglist
m_getbcodedaeone m_getbcodedaeone
m_inviapianoalpilota m_inviapianoalpilota
m_importalavorazioni m_importalavorazioni
m_datilavtoe1 m_datilavtoe1
m_reportpilota m_reportpilota
m_5 m_5
m_modificaprogrammazione m_modificaprogrammazione
end type

on m_magazzino.create
call super::create
this.text = "&Magazzino"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "    Magazzino"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_mag_navigatore=create m_mag_navigatore
this.m_marketing=create m_marketing
this.m_lotti=create m_lotti
this.m_caricalotto=create m_caricalotto
this.m_lottisd=create m_lottisd
this.m_-4=create m_-4
this.m_groupage=create m_groupage
this.m_pianidilavorazione=create m_pianidilavorazione
this.m_convalidalavorazioni=create m_convalidalavorazioni
this.m_attestati=create m_attestati
this.m_1=create m_1
this.m_ddt=create m_ddt
this.m_spedizioni=create m_spedizioni
this.m_stampaspedizioni=create m_stampaspedizioni
this.m_-1=create m_-1
this.m_fatture=create m_fatture
this.m_stampafatture=create m_stampafatture
this.m_scadenzario=create m_scadenzario
this.m_0=create m_0
this.m_email0=create m_email0
this.m_esportadocumenti=create m_esportadocumenti
this.m_-0=create m_-0
this.m_etichbarcode=create m_etichbarcode
this.m_barcodemanuale=create m_barcodemanuale
this.m_barcodedosimetro=create m_barcodedosimetro
this.m_-5=create m_-5
this.m_creapackinglistdaweb=create m_creapackinglistdaweb
this.m_importapackinglist=create m_importapackinglist
this.m_getbcodedaeone=create m_getbcodedaeone
this.m_inviapianoalpilota=create m_inviapianoalpilota
this.m_importalavorazioni=create m_importalavorazioni
this.m_datilavtoe1=create m_datilavtoe1
this.m_reportpilota=create m_reportpilota
this.m_5=create m_5
this.m_modificaprogrammazione=create m_modificaprogrammazione
this.Item[UpperBound(this.Item)+1]=this.m_mag_navigatore
this.Item[UpperBound(this.Item)+1]=this.m_marketing
this.Item[UpperBound(this.Item)+1]=this.m_lotti
this.Item[UpperBound(this.Item)+1]=this.m_caricalotto
this.Item[UpperBound(this.Item)+1]=this.m_lottisd
this.Item[UpperBound(this.Item)+1]=this.m_-4
this.Item[UpperBound(this.Item)+1]=this.m_groupage
this.Item[UpperBound(this.Item)+1]=this.m_pianidilavorazione
this.Item[UpperBound(this.Item)+1]=this.m_convalidalavorazioni
this.Item[UpperBound(this.Item)+1]=this.m_attestati
this.Item[UpperBound(this.Item)+1]=this.m_1
this.Item[UpperBound(this.Item)+1]=this.m_ddt
this.Item[UpperBound(this.Item)+1]=this.m_spedizioni
this.Item[UpperBound(this.Item)+1]=this.m_stampaspedizioni
this.Item[UpperBound(this.Item)+1]=this.m_-1
this.Item[UpperBound(this.Item)+1]=this.m_fatture
this.Item[UpperBound(this.Item)+1]=this.m_stampafatture
this.Item[UpperBound(this.Item)+1]=this.m_scadenzario
this.Item[UpperBound(this.Item)+1]=this.m_0
this.Item[UpperBound(this.Item)+1]=this.m_email0
this.Item[UpperBound(this.Item)+1]=this.m_esportadocumenti
this.Item[UpperBound(this.Item)+1]=this.m_-0
this.Item[UpperBound(this.Item)+1]=this.m_etichbarcode
this.Item[UpperBound(this.Item)+1]=this.m_barcodemanuale
this.Item[UpperBound(this.Item)+1]=this.m_barcodedosimetro
this.Item[UpperBound(this.Item)+1]=this.m_-5
this.Item[UpperBound(this.Item)+1]=this.m_creapackinglistdaweb
this.Item[UpperBound(this.Item)+1]=this.m_importapackinglist
this.Item[UpperBound(this.Item)+1]=this.m_getbcodedaeone
this.Item[UpperBound(this.Item)+1]=this.m_inviapianoalpilota
this.Item[UpperBound(this.Item)+1]=this.m_importalavorazioni
this.Item[UpperBound(this.Item)+1]=this.m_datilavtoe1
this.Item[UpperBound(this.Item)+1]=this.m_reportpilota
this.Item[UpperBound(this.Item)+1]=this.m_5
this.Item[UpperBound(this.Item)+1]=this.m_modificaprogrammazione
end on

on m_magazzino.destroy
call super::destroy
destroy(this.m_mag_navigatore)
destroy(this.m_marketing)
destroy(this.m_lotti)
destroy(this.m_caricalotto)
destroy(this.m_lottisd)
destroy(this.m_-4)
destroy(this.m_groupage)
destroy(this.m_pianidilavorazione)
destroy(this.m_convalidalavorazioni)
destroy(this.m_attestati)
destroy(this.m_1)
destroy(this.m_ddt)
destroy(this.m_spedizioni)
destroy(this.m_stampaspedizioni)
destroy(this.m_-1)
destroy(this.m_fatture)
destroy(this.m_stampafatture)
destroy(this.m_scadenzario)
destroy(this.m_0)
destroy(this.m_email0)
destroy(this.m_esportadocumenti)
destroy(this.m_-0)
destroy(this.m_etichbarcode)
destroy(this.m_barcodemanuale)
destroy(this.m_barcodedosimetro)
destroy(this.m_-5)
destroy(this.m_creapackinglistdaweb)
destroy(this.m_importapackinglist)
destroy(this.m_getbcodedaeone)
destroy(this.m_inviapianoalpilota)
destroy(this.m_importalavorazioni)
destroy(this.m_datilavtoe1)
destroy(this.m_reportpilota)
destroy(this.m_5)
destroy(this.m_modificaprogrammazione)
end on

type m_mag_navigatore from menu within m_magazzino
end type

event clicked;//
st_open_w k_st_open_w


//===
//=== Menu Treeview
//===
K_st_open_w.id_programma = "treeview"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "0"
K_st_open_w.key1 = " " // x ora nulla
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_mag_navigatore.create
call super::create
this.tag = "treeview"
this.text = "Esplora Magazzino "
this.microhelp = "Navigatore dati"
this.toolbaritemname = "treeview!"
this.toolbaritemtext = "Nav., Navigatore"
this.toolbaritemorder = 1
this.menuimage = "treeview!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_mag_navigatore.destroy
call super::destroy
end on

type m_marketing from menu within m_magazzino
end type

event clicked;//
st_open_w k_st_open_w
//---17092008kuf_menu_window kuf1_menu_window


//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto

	K_st_open_w.id_programma = kkg_id_programma.mtk
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.visualizzazione
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = ""   // 
	K_st_open_w.key2 = ""  // 
	K_st_open_w.key3 = "" // 
	K_st_open_w.key4 = "" // 
	K_st_open_w.key5 = "" // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.key7 = " " // 
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_marketing.create
call super::create
this.tag = "mkt"
this.text = "Marketing~tCtrl+K"
this.shortcut = 331
this.microhelp = "Supporto all~'ufficio Mkt"
this.menuimage = "Custom073!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_marketing.destroy
call super::destroy
end on

type m_lotti from menu within m_magazzino
end type

event clicked;//
kuf_armo kuf1_armo
string k_modalita = kkg_flag_modalita.elenco


	kuf1_armo = create kuf_armo

	kuf1_armo.u_open(k_modalita)

	destroy kuf1_armo

end event

on m_lotti.create
call super::create
this.tag = "meca_l"
this.text = "Lotti~tCtrl+F1"
this.shortcut = 368
this.microhelp = "Elenco Riferimenti Lotti"
this.menuimage = "browseobject!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_lotti.destroy
call super::destroy
end on

type m_caricalotto from menu within m_magazzino
end type

event clicked;//
kuf_menu_window kuf1_menu_window 
kuf_armo kuf1_armo
st_open_w k_st_open_w


kuf1_armo = create kuf_armo
kuf1_menu_window = create kuf_menu_window


//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto

	k_st_open_w.flag_modalita = kkg_flag_modalita.inserimento
	K_st_open_w.id_programma = kuf1_armo.get_id_programma(k_st_open_w.flag_modalita)
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // id_meca
	K_st_open_w.key2 = " " // mandante/cliente 
	K_st_open_w.key3 = " " // data da
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
								

end event

on m_caricalotto.create
call super::create
this.visible = false
this.text = "Carica Lotto~tCtrl+R"
this.shortcut = 338
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_caricalotto.destroy
call super::destroy
end on

type m_lottisd from menu within m_magazzino
end type

on m_lottisd.create
call super::create
this.tag = "meca_armo_pt"
this.text = "Lotti SD"
this.microhelp = "Imposta Pianificazione ai Lotti entrati per Contratto SD"
this.menuimage = "browseobject!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_lottisd.destroy
call super::destroy
end on

event clicked;//
kuf_meca_armo_pt kuf1_meca_armo_pt
st_open_w k_st_open_w


	kuf1_meca_armo_pt = create kuf_meca_armo_pt

	k_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // id_meca
	K_st_open_w.key2 = " " // mandante/cliente 
	K_st_open_w.key3 = " " // data da
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	kuf1_meca_armo_pt.u_open(k_st_open_w)
						
	destroy kuf1_meca_armo_pt
	

end event

type m_-4 from menu within m_magazzino
end type

on m_-4.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-4.destroy
call super::destroy
end on

type m_groupage from menu within m_magazzino
end type

event clicked;//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=;
kuf_menu_window kuf1_menu_window 
kuf_lettore_grp kuf1_lettore_grp
st_open_w k_st_open_w


kuf1_lettore_grp = create kuf_lettore_grp
kuf1_menu_window = create kuf_menu_window


K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.id_programma = kuf1_lettore_grp.get_id_programma(K_st_open_w.flag_modalita)
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = " "
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.key12_any = " " //--- eventuale struttura array st_sped_ddt[]
K_st_open_w.flag_where = " "

kuf1_menu_window.open_w_tabelle(k_st_open_w)

destroy kuf1_lettore_grp
destroy kuf1_menu_window





end event

on m_groupage.create
call super::create
this.tag = "lettore_grp "
this.text = "Groupage"
this.microhelp = "Groupage da Lettore"
this.menuimage = "CheckIn5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_groupage.destroy
call super::destroy
end on

type m_pianidilavorazione from menu within m_magazzino
end type

event clicked;//
st_open_w k_st_open_w

//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto

	K_st_open_w.id_programma = "pl_barcode_l"
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = string( RelativeDate ( kguo_g.get_dataoggi(), -365))  // data di inizio 
	K_st_open_w.key2 = "tutti" // operazione
	K_st_open_w.key3 = " " // 
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_pianidilavorazione.create
call super::create
this.tag = "pl_barcode_l"
this.text = "Piani di Lavorazione~tCtrl+L"
this.shortcut = 332
this.microhelp = "Elenco P.L. inseriti"
this.toolbaritemname = "structure!"
this.toolbaritemtext = "P.L.,Pianificazione Trattamenti"
this.toolbaritemorder = 3
this.menuimage = "structure!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_pianidilavorazione.destroy
call super::destroy
end on

type m_convalidalavorazioni from menu within m_magazzino
m_letturadosim m_letturadosim
m_convalida m_convalida
m_convalidalavorazioni1 m_convalidalavorazioni1
m_convalidalavorazioni2 m_convalidalavorazioni2
m_convalidalavorazioni3 m_convalidalavorazioni3
end type

on m_convalidalavorazioni.create
call super::create
this.text = "Convalida Lavorazioni ..."
this.microhelp = "Convalida Dosimetrica Trattamento Riferimenti"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "Convalida"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_letturadosim=create m_letturadosim
this.m_convalida=create m_convalida
this.m_convalidalavorazioni1=create m_convalidalavorazioni1
this.m_convalidalavorazioni2=create m_convalidalavorazioni2
this.m_convalidalavorazioni3=create m_convalidalavorazioni3
this.Item[UpperBound(this.Item)+1]=this.m_letturadosim
this.Item[UpperBound(this.Item)+1]=this.m_convalida
this.Item[UpperBound(this.Item)+1]=this.m_convalidalavorazioni1
this.Item[UpperBound(this.Item)+1]=this.m_convalidalavorazioni2
this.Item[UpperBound(this.Item)+1]=this.m_convalidalavorazioni3
end on

on m_convalidalavorazioni.destroy
call super::destroy
destroy(this.m_letturadosim)
destroy(this.m_convalida)
destroy(this.m_convalidalavorazioni1)
destroy(this.m_convalidalavorazioni2)
destroy(this.m_convalidalavorazioni3)
end on

type m_letturadosim from menu within m_convalidalavorazioni
end type

on m_letturadosim.create
call super::create
this.tag = "convalida"
this.text = "Lettura"
this.microhelp = "Lettura dosimetria"
this.menuimage = "DeclareVariable!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_letturadosim.destroy
call super::destroy
end on

event clicked;//
//date k_data
//st_open_w k_st_open_w
//st_tab_base k_st_tab_base
//kuf_base kuf1_base
kuf_meca_dosimbozza kuf1_meca_dosimbozza
st_tab_g_0 kst_tab_g_0

kuf1_meca_dosimbozza = create kuf_meca_dosimbozza

kst_tab_g_0.id = 0
kst_tab_g_0.idx = ""

kuf1_meca_dosimbozza.u_open_applicazione(kst_tab_g_0, kkg_flag_modalita.elenco)

destroy kuf1_meca_dosimbozza

//K_st_open_w.id_programma = kkg_id_programma.dosimetria
//K_st_open_w.flag_primo_giro = "S"
//K_st_open_w.flag_modalita = kkg_flag_modalita.modifica
//K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
//K_st_open_w.flag_leggi_dw = "N"
//K_st_open_w.flag_cerca_in_lista = "1"
//K_st_open_w.key1 = " " // 
//K_st_open_w.key2 = " " // 
//K_st_open_w.key3 = kuf1_armo.ki_err_lav_ok_da_conv 
//K_st_open_w.key4 = " "
//K_st_open_w.key5 = " " 
//K_st_open_w.flag_where = " "
//							
//kGuf_menu_window.open_w_tabelle(k_st_open_w)


end event

type m_convalida from menu within m_convalidalavorazioni
end type

event clicked;//
st_tab_base k_st_tab_base
kuf_meca_dosim_conv kuf1_meca_dosim_conv
st_tab_g_0 kst_tab_g_0


kuf1_meca_dosim_conv = create kuf_meca_dosim_conv

kst_tab_g_0.id = 0
kst_tab_g_0.idx = ""

kuf1_meca_dosim_conv.u_open_applicazione(kst_tab_g_0, kkg_flag_modalita.elenco)

destroy kuf1_meca_dosim_conv

end event

on m_convalida.create
call super::create
this.tag = "convalida"
this.text = "Convalida"
this.microhelp = "Convalida Dosimetria"
this.menuimage = "DeclareVariable!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_convalida.destroy
call super::destroy
end on

type m_convalidalavorazioni1 from menu within m_convalidalavorazioni
end type

event clicked;//
st_open_w kst_open_w
kuf_convalida_calc kuf1_convalida_calc


kuf1_convalida_calc = create kuf_convalida_calc
kst_open_w.flag_modalita = kkg_flag_modalita.inserimento
kuf1_convalida_calc.u_open(kst_open_w)
destroy kuf1_convalida_calc
//date k_data
//st_open_w k_st_open_w
//st_tab_base k_st_tab_base
//kuf_base kuf1_base
////---17092008kuf_menu_window kuf1_menu_window
//kuf_meca_dosim kuf1_meca_dosim
//
//
////===
////=== Situazione Scadenzario
////===
//K_st_open_w.id_programma = kkg_id_programma.dosimetria
//K_st_open_w.flag_primo_giro = "S"
//K_st_open_w.flag_modalita = kkg_flag_modalita.modifica
//K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
//K_st_open_w.flag_leggi_dw = "N"
//K_st_open_w.flag_cerca_in_lista = "1"
//K_st_open_w.key1 = " " // 
//K_st_open_w.key2 = " " // 
//K_st_open_w.key3 = kuf1_meca_dosim.ki_err_lav_ok_da_conv 
//K_st_open_w.key4 = " "
//K_st_open_w.key5 = " " 
//K_st_open_w.flag_where = " "
//							
////---17092008kuf1_menu_window = create kuf_menu_window 
//kGuf_menu_window.open_w_tabelle(k_st_open_w)
////---17092008destroy kuf1_menu_window
//
//
end event

on m_convalidalavorazioni1.create
call super::create
this.tag = "convcalc "
this.text = "Simulatore"
this.microhelp = "Convalida: verifica dati"
this.menuimage = "DeclareVariable!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_convalidalavorazioni1.destroy
call super::destroy
end on

type m_convalidalavorazioni2 from menu within m_convalidalavorazioni
end type

event clicked;//
date k_data
st_open_w k_st_open_w
st_tab_base k_st_tab_base
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window
kuf_meca_dosim kuf1_meca_dosim


//===
//=== Situazione Scadenzario
//===
K_st_open_w.id_programma = kkg_id_programma.dosimetria_da_autorizzare
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.modifica
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " " // 
K_st_open_w.key2 = " " // 
K_st_open_w.key3 = kuf1_meca_dosim.ki_err_lav_ok_conv_ko_da_aut 
K_st_open_w.key4 = " "
K_st_open_w.key5 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_convalidalavorazioni2.create
call super::create
this.tag = "convalidaut"
this.text = "Verifica Anomalie"
this.microhelp = "Verifica e Convalida le anomalie dosimetriche "
this.menuimage = "setVariable!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_convalidalavorazioni2.destroy
call super::destroy
end on

type m_convalidalavorazioni3 from menu within m_convalidalavorazioni
end type

event clicked;//
date k_data
st_open_w k_st_open_w
st_tab_base k_st_tab_base
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window
kuf_meca_dosim kuf1_meca_dosim


//===
//=== Situazione Scadenzario
//===
K_st_open_w.id_programma = kkg_id_programma.dosimetria_da_sbloccare
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.modifica
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " " // 
K_st_open_w.key2 = " " // 
K_st_open_w.key3 = kuf1_meca_dosim.ki_err_lav_ok_conv_ko_bloc 
K_st_open_w.key4 = " "
K_st_open_w.key5 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_convalidalavorazioni3.create
call super::create
this.tag = "convalidablk"
this.text = "Anomalie da Rilasciare"
this.microhelp = "Sblocco dosimetrie con Anomalia  "
this.menuimage = "Debug!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_convalidalavorazioni3.destroy
call super::destroy
end on

type m_attestati from menu within m_magazzino
end type

event clicked;//
date k_data
string k_dataoggi
st_open_w k_st_open_w


k_data = kguo_g.get_dataoggi( )

//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto

	K_st_open_w.id_programma = "attestati_l"
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = string( RelativeDate ( k_data, -180), "yyyy/mm/dd")   // data di inizio 
	K_st_open_w.key2 = string( k_data)   // data di fine
	K_st_open_w.key3 = "0" // num certif
	K_st_open_w.key4 = "0" // clie_2
	K_st_open_w.key5 = "0" // id armo
	K_st_open_w.key6 = " " // 
	K_st_open_w.key7 = " " // 
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_attestati.create
call super::create
this.tag = "attestati_l"
this.text = "Attestati"
this.microhelp = "Certificazione Trattamenti"
this.menuimage = "ScriptYes!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_attestati.destroy
call super::destroy
end on

type m_1 from menu within m_magazzino
end type

on m_1.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_1.destroy
call super::destroy
end on

type m_ddt from menu within m_magazzino
end type

on m_ddt.create
call super::create
this.tag = "sped"
this.text = "DDT"
this.microhelp = "Gestione ddt"
this.menuimage = "Deploy!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_ddt.destroy
call super::destroy
end on

event clicked;//----
st_tab_sped kst_tab_sped
kuf_sped kuf1_sped


kuf1_sped = create kuf_sped

kst_tab_sped.clie_2 = 0
kuf1_sped.u_open_inserimento(kst_tab_sped)






end event

type m_spedizioni from menu within m_magazzino
end type

event clicked;//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=;
kuf_menu_window kuf1_menu_window 
kuf_sped kuf1_sped
st_open_w k_st_open_w


kuf1_sped = create kuf_sped
kuf1_menu_window = create kuf_menu_window


K_st_open_w.id_programma = kuf1_sped.get_id_programma(kkg_flag_modalita.elenco)
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = " "
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

kuf1_menu_window.open_w_tabelle(k_st_open_w)

destroy kuf1_sped
destroy kuf1_menu_window





end event

on m_spedizioni.create
call super::create
this.tag = "sped_l"
this.text = "Elenco DDT~tCtrl+D"
this.shortcut = 324
this.microhelp = "elenco ddt"
this.menuimage = "Deploy!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_spedizioni.destroy
call super::destroy
end on

type m_stampaspedizioni from menu within m_magazzino
end type

on m_stampaspedizioni.create
call super::create
this.tag = "sped_st"
this.text = "Stampa DDT nuovi"
this.microhelp = "Stampa da elenco nuovi ddt "
this.menuimage = "Deploy!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_stampaspedizioni.destroy
call super::destroy
end on

event clicked;//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=;
kuf_menu_window kuf1_menu_window 
kuf_sped kuf1_sped
st_open_w k_st_open_w


kuf1_sped = create kuf_sped
kuf1_menu_window = create kuf_menu_window


K_st_open_w.flag_modalita = kkg_flag_modalita.stampa
K_st_open_w.id_programma = kuf1_sped.get_id_programma(kkg_flag_modalita.stampa)
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = " "
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.key12_any = " " //--- eventuale struttura array st_sped_ddt[]
K_st_open_w.flag_where = " "

kuf1_menu_window.open_w_tabelle(k_st_open_w)

destroy kuf1_sped
destroy kuf1_menu_window





end event

type m_-1 from menu within m_magazzino
end type

on m_-1.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-1.destroy
call super::destroy
end on

type m_fatture from menu within m_magazzino
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	K_st_open_w.id_programma = kkg_id_programma.fatture_elenco
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = "0" // cliente
	K_st_open_w.key2 = " " // data inizio periodo
	K_st_open_w.key3 = " " // data fine periodo 
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_fatture.create
call super::create
this.tag = "fatture"
this.text = "Fatture"
this.microhelp = "Elenco Fatture"
this.toolbaritemvisible = false
this.menuimage = "c:\gammarad\pb_gmmrd11\icone\fattura8x8.gif"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fatture.destroy
call super::destroy
end on

type m_stampafatture from menu within m_magazzino
end type

event clicked;//
date k_data
st_open_w k_st_open_w
st_tab_base k_st_tab_base
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window



//===
//=== Stampa Nuove Fatture e Note di credito
//===
K_st_open_w.id_programma = kkg_id_programma.fatture_stampa
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.stampa
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "0"
K_st_open_w.key1 = " " // 
K_st_open_w.key2 = " " // 
K_st_open_w.key3 = " " 
K_st_open_w.key4 = " "
K_st_open_w.key5 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_stampafatture.create
call super::create
this.tag = "fatt_new_st"
this.text = "Stampa Fatture e N.C."
this.microhelp = "Stampa nuove fatture / note di credito"
this.menuimage = "c:\gammarad\pb_gmmrd11\icone\fattura8x8.gif"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_stampafatture.destroy
call super::destroy
end on

type m_scadenzario from menu within m_magazzino
end type

event clicked;//
date k_data
st_open_w k_st_open_w
st_tab_base k_st_tab_base
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window


kuf1_base = create kuf_base
if kuf1_base.dammi_rec(k_st_tab_base) = 0 then
	k_data = k_st_tab_base.data_int
else
	k_data = today()
end if
destroy kuf1_base


//===
//=== Situazione Scadenzario
//===
K_st_open_w.id_programma = "ricevute_sk"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.interrogazione
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = "*" // tipo
K_st_open_w.key2 = "*" // stato lavorazione (N/I/F)
K_st_open_w.key3 = string(k_data, "dd/mm/yy") //data inizio scadenze
K_st_open_w.key4 = string(relativedate(k_data, 60), "dd/mm/yy")  //data fine scadenze
K_st_open_w.key5 = "00000"  //cliente fatturato
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_scadenzario.create
call super::create
this.tag = "ricevute_sk"
this.visible = false
this.text = "Scadenzario"
this.enabled = false
this.microhelp = "Archivio scadenzario fatture emesse"
this.menuimage = "Custom037!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_scadenzario.destroy
call super::destroy
end on

type m_0 from menu within m_magazzino
end type

on m_0.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_0.destroy
call super::destroy
end on

type m_email0 from menu within m_magazzino
m_emailfatture m_emailfatture
m_emailprontomerce m_emailprontomerce
end type

on m_email0.create
call super::create
this.text = "E-MAIL ..."
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_emailfatture=create m_emailfatture
this.m_emailprontomerce=create m_emailprontomerce
this.Item[UpperBound(this.Item)+1]=this.m_emailfatture
this.Item[UpperBound(this.Item)+1]=this.m_emailprontomerce
end on

on m_email0.destroy
call super::destroy
destroy(this.m_emailfatture)
destroy(this.m_emailprontomerce)
end on

type m_emailfatture from menu within m_email0
end type

event clicked;//
//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w
	kuf_email_invio kuf1_email_invio
	kuf_email_funzioni kuf1_email_funzioni
	
	kuf1_email_invio = create kuf_email_invio
	

	K_st_open_w.id_programma = kuf1_email_invio.get_id_programma(kkg_flag_modalita.elenco ) 
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // 
	K_st_open_w.key2 = " " //
	K_st_open_w.key3 = ""
	K_st_open_w.key4 = kuf1_email_funzioni.kki_cod_funzione_fatturasiallegati
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
								
	destroy kuf1_email_invio
	
end event

on m_emailfatture.create
call super::create
this.tag = "email_invio"
this.text = "E-mail Fatture"
this.microhelp = "Elenco e-mail generate dalla Fatturazione"
this.menuimage = "Custom025!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_emailfatture.destroy
call super::destroy
end on

type m_emailprontomerce from menu within m_email0
end type

event clicked;//
//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w
	kuf_email_invio kuf1_email_invio
	kuf_email_funzioni kuf1_email_funzioni
	
	
	kuf1_email_invio = create kuf_email_invio
	

	K_st_open_w.id_programma = kuf1_email_invio.get_id_programma(kkg_flag_modalita.elenco ) 
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // 
	K_st_open_w.key2 = " " //
	K_st_open_w.key3 = ""
	K_st_open_w.key4 = kuf1_email_funzioni.kki_cod_funzione_prontomerce
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
								
	destroy kuf1_email_invio
	
end event

on m_emailprontomerce.create
call super::create
this.tag = "email_invio"
this.text = "E-mail Pronto Merce"
this.microhelp = "Elenco e-mail generate dalla Fatturazione"
this.menuimage = "Custom025!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_emailprontomerce.destroy
call super::destroy
end on

type m_esportadocumenti from menu within m_magazzino
end type

event clicked;//
//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w
	kuf_docprod kuf1_docprod
	
	
	kuf1_docprod = create kuf_docprod
	

	K_st_open_w.id_programma = kuf1_docprod.get_id_programma(kkg_flag_modalita.elenco ) 
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // 
	K_st_open_w.key2 = " " //
	K_st_open_w.key3 = " " //
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
								
	destroy kuf1_docprod
	
end event

on m_esportadocumenti.create
call super::create
this.tag = "docprodl"
this.text = "Esporta Documenti"
this.menuimage = "SaveAs!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_esportadocumenti.destroy
call super::destroy
end on

type m_-0 from menu within m_magazzino
end type

on m_-0.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-0.destroy
call super::destroy
end on

type m_etichbarcode from menu within m_magazzino
m_etichettatrice m_etichettatrice
m_4etichette m_4etichette
m_2etichette m_2etichette
end type

on m_etichbarcode.create
call super::create
this.text = "Barcode form del modulo ..."
this.microhelp = "indicare il modulo di stampa per le etichette dei Lotti"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_etichettatrice=create m_etichettatrice
this.m_4etichette=create m_4etichette
this.m_2etichette=create m_2etichette
this.Item[UpperBound(this.Item)+1]=this.m_etichettatrice
this.Item[UpperBound(this.Item)+1]=this.m_4etichette
this.Item[UpperBound(this.Item)+1]=this.m_2etichette
end on

on m_etichbarcode.destroy
call super::destroy
destroy(this.m_etichettatrice)
destroy(this.m_4etichette)
destroy(this.m_2etichette)
end on

event clicked;//
	set_modulo_barcode()

end event

type m_etichettatrice from menu within m_etichbarcode
end type

on m_etichettatrice.create
call super::create
this.text = "etichettatrice"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_etichettatrice.destroy
call super::destroy
end on

event clicked;//
m_magazzino.m_etichbarcode.m_4etichette.checked = false
m_magazzino.m_etichbarcode.m_2etichette.checked = false
m_magazzino.m_etichbarcode.m_etichettatrice.checked = true
kGuf_data_base.KI_barcode_modulo = "A"

end event

type m_4etichette from menu within m_etichbarcode
end type

on m_4etichette.create
call super::create
this.text = "4 etichette su A4"
this.enabled = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_4etichette.destroy
call super::destroy
end on

event clicked;//
m_magazzino.m_etichbarcode.m_2etichette.checked = false
m_magazzino.m_etichbarcode.m_etichettatrice.checked = false
m_magazzino.m_etichbarcode.m_4etichette.checked = true
kGuf_data_base.KI_barcode_modulo = "4"

end event

type m_2etichette from menu within m_etichbarcode
end type

on m_2etichette.create
call super::create
this.text = "2 etichette su A4"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_2etichette.destroy
call super::destroy
end on

event clicked;//
m_magazzino.m_etichbarcode.m_4etichette.checked = false
m_magazzino.m_etichbarcode.m_etichettatrice.checked = false
m_magazzino.m_etichbarcode.m_2etichette.checked = true
kGuf_data_base.KI_barcode_modulo = "2"

end event

type m_barcodemanuale from menu within m_magazzino
end type

event clicked;//
date k_data
st_open_w k_st_open_w


//===
//=== Situazione Scadenzario
//===
K_st_open_w.id_programma = "barcode_m"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.inserimento
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " " // 
K_st_open_w.key2 = " " // 
K_st_open_w.key3 = " " 
K_st_open_w.key4 = " "
K_st_open_w.key5 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_barcodemanuale.create
call super::create
this.tag = "barcode_m"
this.text = "Barcode manuale"
this.microhelp = "Stampa etichetta ~'barcode manuale~'"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_barcodemanuale.destroy
call super::destroy
end on

type m_barcodedosimetro from menu within m_magazzino
end type

event clicked;//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=;
//kuf_menu_window kuf1_menu_window 
kuf_meca_dosim_barcode kuf1_meca_dosim_barcode
st_open_w k_st_open_w


	kuf1_meca_dosim_barcode = create kuf_meca_dosim_barcode

	K_st_open_w.flag_modalita = kkg_flag_modalita.modifica
	K_st_open_w.key1 = ""
	kuf1_meca_dosim_barcode.u_open(K_st_open_w)

	if isvalid(kuf1_meca_dosim_barcode) then destroy kuf1_meca_dosim_barcode

//K_st_open_w.flag_modalita = kkg_flag_modalita.inserimento
//K_st_open_w.id_programma = kuf1_meca_dosim_barcode.get_id_programma(kkg_flag_modalita.inserimento)
//K_st_open_w.flag_primo_giro = "S"
//K_st_open_w.flag_adatta_win = KKg.ADATTA_WIN
//K_st_open_w.flag_leggi_dw = " "
//K_st_open_w.key1 = " "
//K_st_open_w.key2 = " "
//K_st_open_w.key3 = " "
//K_st_open_w.key4 = " "
//K_st_open_w.key12_any = " " //--- eventuale struttura array st_meca_dosim_barcode_ddt[]
//K_st_open_w.flag_where = " "
//
//kuf1_menu_window.open_w_tabelle(k_st_open_w)

//destroy kuf1_meca_dosim_barcode
//destroy kuf1_menu_window





end event

on m_barcodedosimetro.create
call super::create
this.tag = "mecadosimbrc"
this.text = "Accoppia Dosimetro"
this.microhelp = "Associa barcode al Dosimetro "
this.menuimage = "UnionReturn!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_barcodedosimetro.destroy
call super::destroy
end on

type m_-5 from menu within m_magazzino
end type

on m_-5.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-5.destroy
call super::destroy
end on

type m_creapackinglistdaweb from menu within m_magazzino
event create ( )
event destroy ( )
end type

on m_creapackinglistdaweb.create
call super::create
this.text = "Importa Packing-List Mandante"
this.microhelp = "Carica a magazzino i file di Packing-List del cliente in formato XML e lineare (TXT) "
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_creapackinglistdaweb.destroy
call super::destroy
end on

event clicked;//
long k_contati
boolean k_semaforo_ROSSO=false
kuf_wm_pklist_file kuf1_wm_pklist_file
kuf_wm_pklist_cfg kuf1_wm_pklist_cfg


		
try
	kuf1_wm_pklist_file = create kuf_wm_pklist_file

	if  messagebox ("Importa Packing List Mandante (Web/FTP/TXT)", &
						"L'operazione AGGIORNA gli Archivi!!~n~r" &
						+ "Saranno caricati a magazzino i Packing-List esterni generati dai mandanti della merce." &
						+" ~n~r" &
						+ "Vuoi proseguire con l'operazione?" &
						 ,question!, YesNo!, 2) = 1 then

		kuf1_wm_pklist_cfg = create kuf_wm_pklist_cfg

//--- SEMAFORO ROSSO: importazione già in esecuzione
		SetPointer(kkg.pointer_attesa)
		k_semaforo_ROSSO = kuf1_wm_pklist_cfg.if_importa_in_esecuzione( )   
		
		SetPointer(kkg.pointer_default)
		
		if k_semaforo_ROSSO then
			messagebox ("Operazione di Importazione Packing List Mandante bloccata", &
						"Operazione bloccata perchè segnalata come già in elaborazione.~n~r" &
						+ "Si prega di riprovare più tardi oppure di sbloccare l'operazione in Proprietà 'Packing-List WM'"  &
						 ,Information!) 
		else
			k_contati = kuf1_wm_pklist_file.importa_wm_pklist_file() 

			if k_contati > 0 then
				messagebox ("Importa Packing List Mandante (Web/FTP/TXT)", &
						"L'operazione conclusa correttamente.~n~r" &
						+ "Sono stati caricati a magazzino " + string (k_contati) + " righe di Packig-List importate a magazzino. "  &
						 ,Information!) 
			else
				messagebox ("Importa Packing List Mandante (Web/FTP/TXT)", &
						"Operazione conclusa.~n~rNessun dato caricato a magazzino.~n~r" &
							+ "Non e' stato trovato alcun Packing-List da importare." &
							+" ~n~r" &
						 ,Information!) 
			end if
		end if
	
	end if
	

catch (uo_exception kuo_exception)
	SetPointer(kkg.pointer_default)
	kuo_exception.messaggio_utente()

finally
	if isvalid(kuf1_wm_pklist_file) then destroy kuf1_wm_pklist_file
	if isvalid(kuf1_wm_pklist_cfg) then destroy kuf1_wm_pklist_cfg

end try

end event

type m_importapackinglist from menu within m_magazzino
end type

event clicked;//
long k_ctr
boolean k_semaforo_ROSSO
//st_tab_wm_pklist kst_tab_wm_pklist
kuf_wm_pklist_inout kuf1_wm_pklist_inout
kuf_wm_pklist_cfg kuf1_wm_pklist_cfg


		
//--- 
try
	kuf1_wm_pklist_inout = create kuf_wm_pklist_inout

	if  messagebox ("Trasferimento Packing List importati", &
						"L'operazione AGGIORNA gli Archivi!!~n~r" &
						+ "Saranno traferiti i Packing-List gia' 'Importati' a magazzino in archivio adatto per fare il Riferimento (Lotto)." &
						+" ~n~r" &
						+ "Vuoi proseguire con l'operazione?" &
						 ,question!, YesNo!, 2) = 1 then
//						+ "Saranno importati solo i Packing-List gia' 'Accettati' in magazzino." &

		kuf1_wm_pklist_cfg = create kuf_wm_pklist_cfg

//--- SEMAFORO ROSSO: importazione già in esecuzione
		k_semaforo_ROSSO = kuf1_wm_pklist_cfg.if_importa_in_esecuzione( )   
		
		if k_semaforo_ROSSO then
			messagebox ("Operazione di Trasferimento Packing List bloccata", &
						"Operazione bloccata perchè segnalata come già in elaborazione.~n~r" &
						+ "Si prega di riprovare più tardi oppure di sbloccare l'operazione in Proprietà 'Packing-List WM'"  &
						 ,Information!) 
		else
	
			//kst_tab_wm_pklist.id_wm_pklist 
			SetPointer(kkg.pointer_attesa)
			k_ctr = kuf1_wm_pklist_inout.importa_wm_pklist_ext_tutti() 
	
			SetPointer(kkg.pointer_default)
			if k_ctr > 0 then
				messagebox ("Trasferimento Packing List importati", &
						"L'operazione conclusa correttamente.~n~r" &
							+ "Traferiti " + string(k_ctr) + " Packing-List in archivio adatto per fare il Riferimento (Lotto)." &
						 ,Information!) 
			else
				messagebox ("Trasferimento Packing List importati", &
						"Operazione conclusa.~n~rNessun dato importato dal WM.~n~r" &
							+ "Nessun Packing-List da trasferire trovato." &
							+" ~n~r" &
						 ,Information!) 
			end if
		end if
	
	end if
	
catch (uo_exception kuo_exception)
	SetPointer(kkg.pointer_default)
	kuo_exception.messaggio_utente()

finally
	if isvalid(kuf1_wm_pklist_inout) then destroy kuf1_wm_pklist_inout
	if isvalid(kuf1_wm_pklist_cfg) then destroy kuf1_wm_pklist_cfg

end try

end event

on m_importapackinglist.create
call super::create
this.text = "Importa Packing-List in Area di Lavoro"
this.microhelp = "Prepara i Packing-List caricati in modo da fare i Riferimenti (LOTTI)"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_importapackinglist.destroy
call super::destroy
end on

type m_getbcodedaeone from menu within m_magazzino
end type

event clicked;//
int k_righe=0
kuf_barcode_ini kuf1_barcode_ini
		
try
	kuf1_barcode_ini = create kuf_barcode_ini

	if messagebox ("Riceve i barcode generati da E-ONE", &
						"L'operazione AGGIORNA gli Archivi!!~n~r" &
						+ "Saranno ricevuti tutti i barcode generati dal Sistema E-ONE e non ancora importati." &
						+" ~n~r" &
						+ "Proseguire con l'operazione?" &
						 ,question!, YesNo!, 2) = 1 then

		SetPointer(kkg.pointer_attesa)
		k_righe = kuf1_barcode_ini.u_e1_importa_barcode_batch( )

		SetPointer(kkg.pointer_default)
		if k_righe > 0 then
			messagebox ("Riceve i barcode generati da E-ONE", &
					"Operazione conclusa correttamente.~n~r" &
					+ "Sono stati ricevuti " + string(k_righe)  &
					+ " barcode da E-ONE" &
					 ,Information!) 
		else
			messagebox ("Riceve i barcode generati da E-ONE", &
					"Operazione conclusa.~n~rNessun dato nuovo disponibile da E-ONE.~n~r" &
						+ "Nessun Lotto ha ricevuto i barcode~n~r" &
						+" ~n~r" &
					 ,Information!) 
		end if
	
	end if
	
catch (uo_exception kuo_exception)
	SetPointer(kkg.pointer_default)
	kuo_exception.messaggio_utente()

finally
	if isvalid(kuf1_barcode_ini) then destroy kuf1_barcode_ini

end try

end event

on m_getbcodedaeone.create
call super::create
this.text = "Riceve i Barcode generati da E-ONE"
this.microhelp = "Tenta importazione Barcode generati dal Sistema E-ONE per i Lotti che ancora ne sono sprovvisti"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_getbcodedaeone.destroy
call super::destroy
end on

type m_inviapianoalpilota from menu within m_magazzino
end type

event clicked;//
kuf_pilota_cmd kuf1_pilota_cmd

		
//--- apre la connessione al DB PILOTA
try

	SetPointer(kkg.pointer_attesa)
	kuf1_pilota_cmd = create kuf_pilota_cmd
	kuf1_pilota_cmd.get_path_file_pl_barcode()  // solo X testare se PATH raggiungibile
	SetPointer(kkg.pointer_default)

	if messagebox ("Generazione File Piano di Lavorazione", &
						"Il file di Pianificazione per il 'PILOTA' sarà creato solo se:~n~r" &
						+"     1-l'ultima Richiesta e' stata evasa positivamente~n~r" &
						+"     2-almeno un Piano di Lavoro nello stato di 'Chiuso' (ovvero da Inviare)~n~r" &
						+" ~n~r" &
						+ "Vuoi proseguire con l'operazione?" &
						 ,question!, YesNo!, 2) = 1 then

		if kuf1_pilota_cmd.job_pianificazione_lavorazioni() then
			
			SetPointer(kkg.pointer_attesa)
			kuf1_pilota_cmd.get_pilota_cfg()
			
			SetPointer(kkg.pointer_default)
			messagebox ("Generazione File Piano di Lavorazione", &
					"L'operazione conclusa correttamente.~n~r" &
					+ "E' stato creato il file del Piano di Lavoro per il 'PILOTA' nella cartella:~n~r" &
					+ kuf1_pilota_cmd.kist_tab_pilota_cfg.path_file_pl_barcode &
					+ kuf1_pilota_cmd.kist_tab_pilota_cfg.ultimo_nome_file_pl_barcode &
					 ,Information!) 
		else
			messagebox ("Generazione File Piano di Lavorazione", &
					"Operazione conclusa.~n~rNessun file del Piano di Lavoro creato, per uno dei seguenti motivi:~n~r" &
						+ "   1-Nessun Piano di Lavoro nello stato di Chiuso~n~r" &
						+ "   2-Un Piano precedentemente creato non è ancora stato evaso dal Pilota (non scaduto)~n~r" &
						+" ~n~r" &
					 ,Information!) 
		end if
	
	end if
	
catch (uo_exception kuo_exception)
	SetPointer(kkg.pointer_default)
	kuo_exception.messaggio_utente()

finally
	if isvalid(kuf1_pilota_cmd) then destroy kuf1_pilota_cmd

end try

end event

on m_inviapianoalpilota.create
call super::create
this.tag = "pilota_exp_p"
this.text = "Invia Piano al Pilota "
this.microhelp = "Crea il file di scambio da Piano di Lavorazione Chiuso per il Pilota"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_inviapianoalpilota.destroy
call super::destroy
end on

type m_importalavorazioni from menu within m_magazzino
end type

event clicked;//
int k_importati_ini=0, k_importati_fin=0
st_esito kst_esito
kuf_pl_barcode kuf1_pl_barcode

		
//--- apre la connessione al DB PILOTA
try
	kuf1_pl_barcode = create kuf_pl_barcode

	if messagebox ("Importa dati lavorazione dei Pallet", &
						"L'operazione AGGIORNA gli Archivi!!~n~r" &
						+ "Saranno importati i dati di lavorazione di inizio e fine dal Pilota." &
						+" ~n~r" &
						+ "Vuoi proseguire con l'operazione?" &
						 ,question!, YesNo!, 2) = 1 then

		SetPointer(kkg.pointer_attesa)
		k_importati_ini = kuf1_pl_barcode.importa_inizio_lav_pilota("0")

		SetPointer(kkg.pointer_attesa)
		k_importati_fin = kuf1_pl_barcode.importa_trattati_pilota("0") 

		SetPointer(kkg.pointer_default)

		if (k_importati_ini + k_importati_fin) > 0 then
			messagebox ("Importa dati lavorazione dei Pallet", &
					"L'operazione conclusa correttamente.~n~r" &
					+ "Sono stati importati " + string(k_importati_ini)  &
					+ " barcode per inizio lavorazione e " + string(k_importati_fin) &
					+ " per fine lavorazione," &
					+ " dal Pilota." &
					 ,Information!) 
		else
			messagebox ("Importa dati lavorazione dei Pallet", &
					"Operazione conclusa.~n~rNessun dato importato dal Pilota.~n~r" &
						+ "Nessun Barcode ha iniziato o concluso il Trattamento" &
					 ,Information!) 
		end if
	
	end if
	
catch (uo_exception kuo_exception)
	SetPointer(kkg.pointer_default)
	kst_esito = kuo_exception.get_st_esito()
	kst_esito.sqlerrtext = "Operazione INTERROTTA!!~n~r" + kst_esito.sqlerrtext
	kguo_exception.messaggio_utente("Importa dati lavorazione dei Pallet", kst_esito.sqlerrtext)

finally
	destroy kuf1_pl_barcode

end try

end event

on m_importalavorazioni.create
call super::create
this.tag = "pilota_imp_p"
this.text = "Importa Lavorazioni "
this.microhelp = "Importa i dati di Trattamento dalle Tabelle del Nuovo Pilota"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_importalavorazioni.destroy
call super::destroy
end on

type m_datilavtoe1 from menu within m_magazzino
end type

event clicked;//
int k_righe=0
kuf_e1_wo_f5548014 kuf1_e1_wo_f5548014
		
//--- apre la connessione al DB PILOTA
try
	kuf1_e1_wo_f5548014 = create kuf_e1_wo_f5548014

	if messagebox ("Invia dati lavorazione Pallet a E-ONE", &
						"L'operazione AGGIORNA gli Archivi!!~n~r" &
						+ "Saranno inviati tutti i dati di lavorazione ancora in sospeso al Sistema E-ONE (e1_wo_f5548014)." &
						+" ~n~r" &
						+ "Proseguire con l'operazione?" &
						 ,question!, YesNo!, 2) = 1 then

		SetPointer(kkg.pointer_attesa)
		k_righe = kuf1_e1_wo_f5548014.u_set_datilav_toe1( )

		SetPointer(kkg.pointer_default)
		if k_righe > 0 then
			messagebox ("Invia dati lavorazione Pallet a E-ONE", &
					"Operazione conclusa correttamente.~n~r" &
					+ "Sono stati inviati " + string(k_righe)  &
					+ " record dati Trattamento a E-ONE" &
					 ,Information!) 
		else
			messagebox ("Invia dati lavorazione Pallet a E-ONE", &
					"Operazione conclusa.~n~rNessun dato disponibile per E-ONE.~n~r" &
						+ "Nessun Lotto ha iniziato, concluso il Trattamento o è stato Convalidato~n~r" &
						+" ~n~r" &
					 ,Information!) 
		end if
	
	end if
	
catch (uo_exception kuo_exception)
	SetPointer(kkg.pointer_default)
	kuo_exception.messaggio_utente()

finally
	if isvalid(kuf1_e1_wo_f5548014) then destroy kuf1_e1_wo_f5548014

end try

end event

on m_datilavtoe1.create
call super::create
this.text = "Invia dati Trattamento a E-ONE"
this.microhelp = "Invio dati di inizio-fine lavorazione e convalida dosimetrica al Sistema E-ONE"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_datilavtoe1.destroy
call super::destroy
end on

type m_reportpilota from menu within m_magazzino
end type

event clicked;//
int k_righe=0
kuf_meca_reportpilota kuf1_meca_reportpilota
st_esito kst_esito
		

try
	kuf1_meca_reportpilota = create kuf_meca_reportpilota

	if messagebox ("Importa Report Pilota", &
						"Copia i Report generati dal Pilota (file pdf) nelle cartelle della Procedura~n~r" &
						+ "Saranno copiati tutti i nuovi Report prodotti dal Pilota con i dati di fine trattamento per ogni singolo barcode (meca_reportpilota)." &
						+" ~n~r" &
						+ "Proseguire con l'operazione?" &
						 ,question!, YesNo!, 2) = 1 then

		SetPointer(kkg.pointer_attesa)
		k_righe = kuf1_meca_reportpilota.u_job_importa_report_pilota( )

		SetPointer(kkg.pointer_default)
		if k_righe > 0 then
			messagebox ("Importa Report Pilota", &
					"Operazione conclusa correttamente.~n~r" &
					+ "Sono stati importati " + string(k_righe)  &
					+ " nuovi Report Pilota" &
					 ,Information!) 
		else
			messagebox ("Importa Report Pilota", &
					"Operazione conclusa.~n~rNessun nuovo file Report Pilota trovato.~n~r" &
						+ "Nessun file è stato importato~n~r" &
						+" ~n~r" &
					 ,Information!) 
		end if
	
	end if
	
catch (uo_exception kuo_exception)
	SetPointer(kkg.pointer_default)
	kst_esito = kuo_exception.get_st_esito()
	kguo_exception.inizializza( )
	kguo_exception.messaggio_utente( "Operazione Conclusa con anomalia", kst_esito.sqlerrtext)

finally
	if isvalid(kuf1_meca_reportpilota) then destroy kuf1_meca_reportpilota

end try

end event

on m_reportpilota.create
call super::create
this.text = "Importa Report Pilota"
this.microhelp = "Importa i report (file pdf) generati dal Pilota al termine del Trattamento"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_reportpilota.destroy
call super::destroy
end on

type m_5 from menu within m_magazzino
end type

on m_5.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_5.destroy
call super::destroy
end on

type m_modificaprogrammazione from menu within m_magazzino
end type

event clicked;//
date k_data
st_open_w k_st_open_w
st_tab_base k_st_tab_base
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window



//===
//=== Situazione Scadenzario
//===
K_st_open_w.id_programma = kkg_id_programma.pilota_programmazione
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.modifica
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " " // 
K_st_open_w.key2 = " " // 
K_st_open_w.key3 = " " 
K_st_open_w.key4 = " "
K_st_open_w.key5 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_modificaprogrammazione.create
call super::create
this.tag = "pilota_prg"
this.text = "Modifica Programmazione"
this.microhelp = "Modifica la coda di Pianificazione Impianto gia~' inviata al Pilota"
this.menuimage = "UserObject!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_modificaprogrammazione.destroy
call super::destroy
end on

type m_stat from menucascade within m_main
m_st_produz m_st_produz
m_st_inventario m_st_inventario
m_st_fatt m_st_fatt
m_st_produz_no_imp m_st_produz_no_imp
end type

on m_stat.create
call super::create
this.text = "&Statistiche"
this.microhelp = "Report Statistici e Interrogazioni"
this.toolbaritemorder = 7
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "Report"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_st_produz=create m_st_produz
this.m_st_inventario=create m_st_inventario
this.m_st_fatt=create m_st_fatt
this.m_st_produz_no_imp=create m_st_produz_no_imp
this.Item[UpperBound(this.Item)+1]=this.m_st_produz
this.Item[UpperBound(this.Item)+1]=this.m_st_inventario
this.Item[UpperBound(this.Item)+1]=this.m_st_fatt
this.Item[UpperBound(this.Item)+1]=this.m_st_produz_no_imp
end on

on m_stat.destroy
call super::destroy
destroy(this.m_st_produz)
destroy(this.m_st_inventario)
destroy(this.m_st_fatt)
destroy(this.m_st_produz_no_imp)
end on

type m_st_produz from menu within m_stat
end type

event clicked;//
string k_anno="0000"
st_open_w k_st_open_w
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window

	
	kuf1_base = create kuf_base
	k_anno = trim(MidA(kuf1_base.prendi_dato_base("anno"),2))
	destroy kuf1_base
	
//=== 2 scelta 
//=== 10 id_cliente + 4 anno + 06 liberi + S=ridim windows + dalla 50 : 10 id_cliente 
//=== 10 dose + 10 id_gruppo + 10 data_da_fattura + 10 data_a_fattura
K_st_open_w.id_programma = kkg_id_programma.stat_produz
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.interrogazione
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = "0000000000" //cliente
K_st_open_w.key2 = "0000000000" // dose
K_st_open_w.key3 = "0000000000"  //gruppo
K_st_open_w.key4 = "01/01/" + k_anno  //data da
K_st_open_w.key5 = "31/12/" + k_anno //data a
K_st_open_w.key6 = " "  
K_st_open_w.key7 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window

		
end event

on m_st_produz.create
call super::create
this.tag = "stat_produz"
this.text = "Produzione"
this.microhelp = "Statistici Merce entrata e trattata con esposizione valori importi"
this.toolbaritemname = "graph1!"
this.toolbaritemtext = "Stat.,Statistici Produzione"
this.toolbaritemorder = 7
this.menuimage = "graph1!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_st_produz.destroy
call super::destroy
end on

type m_st_inventario from menu within m_stat
end type

event clicked;//
kuf_stat_invent kuf1_stat_invent
string k_anno="0000"
kuf_base kuf1_base


kuf1_base = create kuf_base
k_anno = trim(MidA(kuf1_base.prendi_dato_base("anno"),2))
destroy kuf1_base


//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	kuf1_stat_invent = create kuf_stat_invent
	
	K_st_open_w.flag_modalita = kkg_flag_modalita.interrogazione
	K_st_open_w.id_programma = kuf1_stat_invent.get_id_programma( K_st_open_w.flag_modalita ) 
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = "0000000000" //cliente
	K_st_open_w.key2 = "0000000000" // dose
	K_st_open_w.key3 = "0000000000"  //gruppo
	K_st_open_w.key4 = "01/01/" + k_anno  //data da
	K_st_open_w.key5 = "31/12/" + k_anno //data a
	K_st_open_w.key6 = " " //
	K_st_open_w.flag_where = " "
	
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
								
	destroy kuf1_stat_invent		
end event

on m_st_inventario.create
call super::create
this.tag = "stat_invent"
this.text = "Inventario"
this.microhelp = "Statistici Inventario per periodo "
this.toolbaritemname = "graph2!"
this.toolbaritemtext = "Invent.,Inventario di magazzino"
this.toolbaritemorder = 7
this.menuimage = "graph2!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_st_inventario.destroy
call super::destroy
end on

type m_st_fatt from menu within m_stat
end type

event clicked;//
string k_anno="0000"
st_open_w k_st_open_w
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window

	
	kuf1_base = create kuf_base
	k_anno = trim(MidA(kuf1_base.prendi_dato_base("anno"),2))
	destroy kuf1_base
	
//=== 2 scelta 
//=== 10 id_cliente + 4 anno + 06 liberi + S=ridim windows + dalla 50 : 10 id_cliente 
//=== 10 dose + 10 id_gruppo + 10 data_da_fattura + 10 data_a_fattura
K_st_open_w.id_programma = "skc"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.interrogazione
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = "0000000000" //cliente
K_st_open_w.key2 = "0000000000" // dose
K_st_open_w.key3 = "0000000000"  //gruppo
K_st_open_w.key4 = "01/01/" + k_anno  //data da
K_st_open_w.key5 = "31/12/" + k_anno //data a
K_st_open_w.key6 = " "  
K_st_open_w.key7 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window

		
end event

on m_st_fatt.create
call super::create
this.tag = "skc"
this.text = "Fatturato/ABC"
this.microhelp = "Statistici Fatturato e Classifiche ABC "
this.toolbaritemname = "graph!"
this.toolbaritemtext = "St.Fatt, Statistico Fatturato"
this.toolbaritemorder = 7
this.menuimage = "graph!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_st_fatt.destroy
call super::destroy
end on

type m_st_produz_no_imp from menu within m_stat
end type

event clicked;//
string k_anno="0000"
st_open_w k_st_open_w
kuf_base kuf1_base
//---17092008kuf_menu_window kuf1_menu_window

	
	kuf1_base = create kuf_base
	k_anno = trim(MidA(kuf1_base.prendi_dato_base("anno"),2))
	destroy kuf1_base
	
//=== 2 scelta 
//=== 10 id_cliente + 4 anno + 06 liberi + S=ridim windows + dalla 50 : 10 id_cliente 
//=== 10 dose + 10 id_gruppo + 10 data_da_fattura + 10 data_a_fattura
K_st_open_w.id_programma = kkg_id_programma.stat_produz_no_importi
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.interrogazione
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = "0000000000" //cliente
K_st_open_w.key2 = "0000000000" // dose
K_st_open_w.key3 = "0000000000"  //gruppo
K_st_open_w.key4 = "01/01/" + k_anno  //data da
K_st_open_w.key5 = "31/12/" + k_anno //data a
K_st_open_w.key6 = " "  
K_st_open_w.key7 = " " 
K_st_open_w.flag_where = " "
							
//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window

		
end event

on m_st_produz_no_imp.create
call super::create
this.tag = "st_prod_nimp"
this.text = "Produzione (no imp.)"
this.microhelp = "Statistici Merce entrata e trattata con esposizione solo movimentazioni e senza importi"
this.menuimage = "Graph1!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_st_produz_no_imp.destroy
call super::destroy
end on

type m_archivi from menu within m_main
m_anagrafiche m_anagrafiche
m_articoli m_articoli
m_sd_md m_sd_md
m_a_t1 m_a_t1
m_contodeposito m_contodeposito
m_ct_rd_l m_ct_rd_l
m_commerciale m_commerciale
m_quotazioni m_quotazioni
m_a_t11 m_a_t11
m_capitolati m_capitolati
m_contratti m_contratti
m_sl_pt m_sl_pt
m_2 m_2
m_listino m_listino
m_gruppilistino m_gruppilistino
m_vocilistino m_vocilistino
m_3 m_3
m_websmart m_websmart
m_a_t2 m_a_t2
m_vettori m_vettori
m_crm m_crm
m_memo m_memo
m_sicurezza m_sicurezza
m_- m_-
m_opf m_opf
m_codabarre m_codabarre
end type

on m_archivi.create
call super::create
this.text = "Arc&hivi"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "   Archivi Magazzino e Contratti"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_anagrafiche=create m_anagrafiche
this.m_articoli=create m_articoli
this.m_sd_md=create m_sd_md
this.m_a_t1=create m_a_t1
this.m_contodeposito=create m_contodeposito
this.m_ct_rd_l=create m_ct_rd_l
this.m_commerciale=create m_commerciale
this.m_quotazioni=create m_quotazioni
this.m_a_t11=create m_a_t11
this.m_capitolati=create m_capitolati
this.m_contratti=create m_contratti
this.m_sl_pt=create m_sl_pt
this.m_2=create m_2
this.m_listino=create m_listino
this.m_gruppilistino=create m_gruppilistino
this.m_vocilistino=create m_vocilistino
this.m_3=create m_3
this.m_websmart=create m_websmart
this.m_a_t2=create m_a_t2
this.m_vettori=create m_vettori
this.m_crm=create m_crm
this.m_memo=create m_memo
this.m_sicurezza=create m_sicurezza
this.m_-=create m_-
this.m_opf=create m_opf
this.m_codabarre=create m_codabarre
this.Item[UpperBound(this.Item)+1]=this.m_anagrafiche
this.Item[UpperBound(this.Item)+1]=this.m_articoli
this.Item[UpperBound(this.Item)+1]=this.m_sd_md
this.Item[UpperBound(this.Item)+1]=this.m_a_t1
this.Item[UpperBound(this.Item)+1]=this.m_contodeposito
this.Item[UpperBound(this.Item)+1]=this.m_ct_rd_l
this.Item[UpperBound(this.Item)+1]=this.m_commerciale
this.Item[UpperBound(this.Item)+1]=this.m_quotazioni
this.Item[UpperBound(this.Item)+1]=this.m_a_t11
this.Item[UpperBound(this.Item)+1]=this.m_capitolati
this.Item[UpperBound(this.Item)+1]=this.m_contratti
this.Item[UpperBound(this.Item)+1]=this.m_sl_pt
this.Item[UpperBound(this.Item)+1]=this.m_2
this.Item[UpperBound(this.Item)+1]=this.m_listino
this.Item[UpperBound(this.Item)+1]=this.m_gruppilistino
this.Item[UpperBound(this.Item)+1]=this.m_vocilistino
this.Item[UpperBound(this.Item)+1]=this.m_3
this.Item[UpperBound(this.Item)+1]=this.m_websmart
this.Item[UpperBound(this.Item)+1]=this.m_a_t2
this.Item[UpperBound(this.Item)+1]=this.m_vettori
this.Item[UpperBound(this.Item)+1]=this.m_crm
this.Item[UpperBound(this.Item)+1]=this.m_memo
this.Item[UpperBound(this.Item)+1]=this.m_sicurezza
this.Item[UpperBound(this.Item)+1]=this.m_-
this.Item[UpperBound(this.Item)+1]=this.m_opf
this.Item[UpperBound(this.Item)+1]=this.m_codabarre
end on

on m_archivi.destroy
call super::destroy
destroy(this.m_anagrafiche)
destroy(this.m_articoli)
destroy(this.m_sd_md)
destroy(this.m_a_t1)
destroy(this.m_contodeposito)
destroy(this.m_ct_rd_l)
destroy(this.m_commerciale)
destroy(this.m_quotazioni)
destroy(this.m_a_t11)
destroy(this.m_capitolati)
destroy(this.m_contratti)
destroy(this.m_sl_pt)
destroy(this.m_2)
destroy(this.m_listino)
destroy(this.m_gruppilistino)
destroy(this.m_vocilistino)
destroy(this.m_3)
destroy(this.m_websmart)
destroy(this.m_a_t2)
destroy(this.m_vettori)
destroy(this.m_crm)
destroy(this.m_memo)
destroy(this.m_sicurezza)
destroy(this.m_-)
destroy(this.m_opf)
destroy(this.m_codabarre)
end on

type m_anagrafiche from menu within m_archivi
m_lista_anag m_lista_anag
m_lista_mandanti m_lista_mandanti
m_lista_riceventi m_lista_riceventi
m_lista_fatturati m_lista_fatturati
m_lista_legami m_lista_legami
end type

on m_anagrafiche.create
call super::create
this.tag = "cll"
this.text = "Anagrafe..."
this.microhelp = "Gestione Anagrafiche clienti/colaboratori/fornitori"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = " anagrafiche"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_lista_anag=create m_lista_anag
this.m_lista_mandanti=create m_lista_mandanti
this.m_lista_riceventi=create m_lista_riceventi
this.m_lista_fatturati=create m_lista_fatturati
this.m_lista_legami=create m_lista_legami
this.Item[UpperBound(this.Item)+1]=this.m_lista_anag
this.Item[UpperBound(this.Item)+1]=this.m_lista_mandanti
this.Item[UpperBound(this.Item)+1]=this.m_lista_riceventi
this.Item[UpperBound(this.Item)+1]=this.m_lista_fatturati
this.Item[UpperBound(this.Item)+1]=this.m_lista_legami
end on

on m_anagrafiche.destroy
call super::destroy
destroy(this.m_lista_anag)
destroy(this.m_lista_mandanti)
destroy(this.m_lista_riceventi)
destroy(this.m_lista_fatturati)
destroy(this.m_lista_legami)
end on

type m_lista_anag from menu within m_anagrafiche
end type

event clicked;//
//---17092008kuf_menu_window kuf1_menu_window

//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=rag.soc.;key2=tipo cliente: *=tutti; 1/2/3=Mandanti/Ricev/Fattrati
st_open_w k_st_open_w

K_st_open_w.id_programma = "cll"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN

K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " "
K_st_open_w.key2 = "*"
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_lista_anag.create
call super::create
this.tag = "cll"
this.text = "Lista generale~tCtrl+N"
this.shortcut = 334
this.microhelp = "Lista di tutte le anagrafiche clienti (Mandanti/Riceventi/Fatturati)"
this.toolbaritemname = "picture!"
this.toolbaritemtext = "Anag.,Anagrafiche "
this.toolbaritemorder = 2
this.menuimage = "picture!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_lista_anag.destroy
call super::destroy
end on

type m_lista_mandanti from menu within m_anagrafiche
end type

on m_lista_mandanti.create
call super::create
this.tag = "cll"
this.text = "Lista Mandanti"
this.microhelp = "Lista Mandanti"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window


//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=rag.soc.;key2=tipo cliente: *=tutti; 1/2/3=Mandanti/Ricev/Fattrati
st_open_w k_st_open_w

K_st_open_w.id_programma = "cll"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " "
K_st_open_w.key2 = "1"
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_lista_mandanti.destroy
call super::destroy
end on

type m_lista_riceventi from menu within m_anagrafiche
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=rag.soc.;key2=tipo cliente: *=tutti; 1/2/3=Mandanti/Ricev/Fattrati
st_open_w k_st_open_w

K_st_open_w.id_programma = "cll"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " "
K_st_open_w.key2 = "2"
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_lista_riceventi.create
call super::create
this.tag = "cll"
this.text = "Lista Riceventi"
this.microhelp = "Lista Riceventi"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_lista_riceventi.destroy
call super::destroy
end on

type m_lista_fatturati from menu within m_anagrafiche
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=rag.soc.;key2=tipo cliente: *=tutti; 1/2/3=Mandanti/Ricev/Fattrati
st_open_w k_st_open_w

K_st_open_w.id_programma = "cll"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " "
K_st_open_w.key2 = "3"
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_lista_fatturati.create
call super::create
this.tag = "cll"
this.text = "Lista Fatturati"
this.microhelp = "Lista anagrafiche a cui vengono imputate le fatture"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_lista_fatturati.destroy
call super::destroy
end on

type m_lista_legami from menu within m_anagrafiche
end type

event clicked;//
//

//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
st_open_w k_st_open_w

K_st_open_w.id_programma = "clegami"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = " " //mand
K_st_open_w.key2 = " " //ricev
K_st_open_w.key3 = " " //fatt
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

kGuf_menu_window.open_w_tabelle(k_st_open_w)


end event

on m_lista_legami.create
call super::create
this.text = "Lista Legami"
this.microhelp = "Elenco legami Mandanti-Riceventi-Fatturati"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_lista_legami.destroy
call super::destroy
end on

type m_articoli from menu within m_archivi
end type

event clicked;//
//---17092008kuf_menu_window kuf1_menu_window


//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=codice IVA;key2=cod.pagamento;key3=cod gruppi;key4=cod causali;
st_open_w k_st_open_w

K_st_open_w.id_programma = "prl"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window



end event

on m_articoli.create
call super::create
this.tag = "prl"
this.text = "Articoli"
this.microhelp = "Gestione Archivio Prodotti"
this.menuimage = "UserObject!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_articoli.destroy
call super::destroy
end on

type m_sd_md from menu within m_archivi
end type

event clicked;//
//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w
	kuf_sd_md kuf1_sd_md
	
	
	kuf1_sd_md = create kuf_sd_md
	

	K_st_open_w.id_programma = kuf1_sd_md.get_id_programma(kkg_flag_modalita.elenco ) 
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // 
	K_st_open_w.key2 = " " //
	K_st_open_w.key3 = " " //
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " // 
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "
	
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
								
	destroy kuf1_sd_md
	
end event

on m_sd_md.create
call super::create
this.tag = "sd_md       "
this.text = "Dose-Mapping"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_sd_md.destroy
call super::destroy
end on

type m_a_t1 from menu within m_archivi
end type

on m_a_t1.create
call super::create
this.tag = "2"
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_a_t1.destroy
call super::destroy
end on

type m_contodeposito from menu within m_archivi
end type

event clicked;//
//
string k_modalita = kkg_flag_modalita.elenco
kuf_contratti_dp kuf1_contratti_dp


kuf1_contratti_dp = create kuf_contratti_dp

kuf1_contratti_dp.u_open(k_modalita)

destroy kuf1_contratti_dp

end event

on m_contodeposito.create
call super::create
this.tag = "ct_dp_l     "
this.text = "Conto Deposito (CD)"
this.menuimage = "BrowseObject!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_contodeposito.destroy
call super::destroy
end on

type m_ct_rd_l from menu within m_archivi
end type

event clicked;//
//
kuf_contratti_rd kuf1_contratti_rd
string k_modalita = kkg_flag_modalita.elenco

	kuf1_contratti_rd = create kuf_contratti_rd

	kuf1_contratti_rd.u_open(k_modalita)

	destroy kuf1_contratti_rd
end event

on m_ct_rd_l.create
call super::create
this.tag = "ct_rd_l"
this.text = "Studio e Sviluppo (SD)"
this.microhelp = "Contratti Studio e Sviluppo"
this.menuimage = "ComputePage5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_ct_rd_l.destroy
call super::destroy
end on

type m_commerciale from menu within m_archivi
end type

event clicked;//
kuf_contratti_co kuf1_contratti_co
string k_modalita = kkg_flag_modalita.elenco


	kuf1_contratti_co = create kuf_contratti_co

	kuf1_contratti_co.u_open(k_modalita)

	destroy kuf1_contratti_co
end event

on m_commerciale.create
call super::create
this.tag = "ct_co_l"
this.text = "Commerciale (CO)"
this.microhelp = "Contratti Commerciali"
this.menuimage = "Custom048!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_commerciale.destroy
call super::destroy
end on

type m_quotazioni from menu within m_archivi
end type

on m_quotazioni.create
call super::create
this.tag = "ct_doc_l"
this.text = "Quotazioni"
this.microhelp = "Contratti Quotazioni "
this.menuimage = "contract16.png"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_quotazioni.destroy
call super::destroy
end on

event clicked;//
string k_modalita = kkg_flag_modalita.elenco
kuf_contratti_doc kuf1_contratti_doc


kuf1_contratti_doc = create kuf_contratti_doc

kuf1_contratti_doc.u_open(k_modalita)

destroy kuf1_contratti_doc
end event

type m_a_t11 from menu within m_archivi
end type

on m_a_t11.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_a_t11.destroy
call super::destroy
end on

type m_capitolati from menu within m_archivi
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window


//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1= 
st_open_w k_st_open_w

K_st_open_w.id_programma = "sc_cf"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_capitolati.create
call super::create
this.tag = "sc_cf"
this.text = "Capitolati (CF)"
this.microhelp = "CF Capitolati di Fornitura"
this.menuimage = "CreateRuntime!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_capitolati.destroy
call super::destroy
end on

type m_contratti from menu within m_archivi
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window


//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=codice cliente;key2=tipo contratto;
st_open_w k_st_open_w

K_st_open_w.id_programma = "ct"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN //_NO
K_st_open_w.flag_leggi_dw = "N"
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_contratti.create
call super::create
this.tag = "ct"
this.text = "Conferme Ordini (CO)"
this.microhelp = "Documenti di riepilogo Contratti"
this.toolbaritemname = "custom004!"
this.toolbaritemtext = "CO,Conferme Ordini Contratti Capitolati e PT "
this.toolbaritemorder = 4
this.menuimage = "Custom004!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_contratti.destroy
call super::destroy
end on

type m_sl_pt from menu within m_archivi
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window


//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=codice sl_pt;
st_open_w k_st_open_w

K_st_open_w.id_programma = "ptl"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = " "
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_sl_pt.create
call super::create
this.tag = "ptl"
this.text = "Piani di Trattamento (PT)"
this.microhelp = "Piani di Trattamento"
this.toolbaritemvisible = false
this.menuimage = "Custom093!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_sl_pt.destroy
call super::destroy
end on

type m_2 from menu within m_archivi
end type

on m_2.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_2.destroy
call super::destroy
end on

type m_listino from menu within m_archivi
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	K_st_open_w.id_programma = kkg_id_programma.listini_l
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // cod cliente
	K_st_open_w.key2 = " " // cod articolo 
	K_st_open_w.key3 = " " // dose
	K_st_open_w.key4 = " " // misure imballo
	K_st_open_w.key5 = " " // misure imballo
	K_st_open_w.key6 = " " // misure imballo
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_listino.create
call super::create
this.tag = "listino_l"
this.text = "Listini"
this.microhelp = "Listini Prezzi Clienti"
this.toolbaritemname = "formatdollar!"
this.toolbaritemtext = "List.,Listini"
this.toolbaritemorder = 3
this.menuimage = "formatdollar!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_listino.destroy
call super::destroy
end on

type m_gruppilistino from menu within m_archivi
end type

event clicked;//
//
kuf_listino_pregruppo kuf1_listino_pregruppo

kuf1_listino_pregruppo = create kuf_listino_pregruppo
//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	K_st_open_w.id_programma =kuf1_listino_pregruppo.get_id_programma(kkg_flag_modalita.elenco)
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // cod cliente
	K_st_open_w.key2 = " " // cod articolo 
	K_st_open_w.key3 = " " // dose
	K_st_open_w.key4 = " " // misure imballo
	K_st_open_w.key5 = " " // misure imballo
	K_st_open_w.key6 = " " // misure imballo
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_gruppilistino.create
call super::create
this.tag = "listgrpl    "
this.text = "Gruppi Listino"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_gruppilistino.destroy
call super::destroy
end on

type m_vocilistino from menu within m_archivi
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

kuf_listino_voci kuf1_listino_voci

kuf1_listino_voci = create kuf_listino_voci
//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	K_st_open_w.id_programma =kuf1_listino_voci.get_id_programma(kkg_flag_modalita.elenco)
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " // cod cliente
	K_st_open_w.key2 = " " // cod articolo 
	K_st_open_w.key3 = " " // dose
	K_st_open_w.key4 = " " // misure imballo
	K_st_open_w.key5 = " " // misure imballo
	K_st_open_w.key6 = " " // misure imballo
	K_st_open_w.flag_where = " "
	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_vocilistino.create
call super::create
this.tag = "listvoci"
this.text = "Voci Listino"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_vocilistino.destroy
call super::destroy
end on

type m_3 from menu within m_archivi
end type

on m_3.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_3.destroy
call super::destroy
end on

type m_websmart from menu within m_archivi
end type

on m_websmart.create
call super::create
this.tag = "webutentil  "
this.text = "Utenti Web"
this.microhelp = "Utenti e Ruoli sul sito web (SMART)"
this.menuimage = "Custom042!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_websmart.destroy
call super::destroy
end on

event clicked;//
//
kuf_web_utenti kuf1_web_utenti

//
//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	kuf1_web_utenti = create kuf_web_utenti
	
	K_st_open_w.id_programma = kuf1_web_utenti.get_id_programma( kkg_flag_modalita.elenco ) 
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = " " 
	K_st_open_w.key2 = " " //
	K_st_open_w.key3 = " " // 
	K_st_open_w.key4 = " " // 
	K_st_open_w.key5 = " " //
	K_st_open_w.key6 = " " //
	K_st_open_w.flag_where = " "
	
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
								
	destroy kuf1_web_utenti
end event

type m_a_t2 from menu within m_archivi
end type

on m_a_t2.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_a_t2.destroy
call super::destroy
end on

type m_vettori from menu within m_archivi
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window


//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=codice sl_pt;
st_open_w k_st_open_w

K_st_open_w.id_programma = kkg_id_programma.sped_vettori
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = " "
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_vettori.create
call super::create
this.tag = "sped_vettori"
this.text = "Vettori"
this.microhelp = "Gestione archivio Spedizionieri"
this.toolbaritemvisible = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_vettori.destroy
call super::destroy
end on

type m_crm from menu within m_archivi
end type

event clicked;//
st_tab_g_0 kst_tab_g_0
kuf_m2000tocrm kuf1_m2000tocrm

kuf1_m2000tocrm = create kuf_m2000tocrm 

kst_tab_g_0.id = 1
kuf1_m2000tocrm.u_open_applicazione(kst_tab_g_0, kkg_flag_modalita.visualizzazione)





end event

on m_crm.create
call super::create
this.tag = "m2000tocrm"
this.visible = false
this.text = "CRM"
this.microhelp = "Esporta dati vesro il CRM"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_crm.destroy
call super::destroy
end on

type m_memo from menu within m_archivi
end type

on m_memo.create
call super::create
this.tag = "memo_u"
this.text = "Memo"
this.microhelp = "Annotazioni e allegati a clienti e lotti"
this.menuimage = "Comment!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_memo.destroy
call super::destroy
end on

event clicked;//
st_open_w kst_open_w
kuf_memo kuf1_memo


try
		
	kuf1_memo = create kuf_memo 
	
	kst_open_w.flag_modalita = kkg_flag_modalita.elenco
	kst_open_w.key1 = kuf1_memo.kki_tipovisualizza_xUTENTE
	kst_open_w.key2 = string(kuf1_memo.kki_memo_attivi)
	kst_open_w.key3 = "0"  // eventuale id del cliente o lotto o ...
	kst_open_w.key4 = ""  // eventuale settore
	kuf1_memo.u_open(kst_open_w)

catch (uo_exception kuo_exception)
	kuo_exception.messaggio_utente()
	
end try

end event

type m_sicurezza from menu within m_archivi
event clicked ( )
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window


//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=  ;
st_open_w k_st_open_w

K_st_open_w.id_programma = "sr"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = " "
K_st_open_w.key1 = " "
K_st_open_w.key2 = " "
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_sicurezza.create
call super::create
this.tag = "sr"
this.text = "Sicurezza"
this.microhelp = "Utenti / Profili / Funzioni"
this.menuimage = "c:\gammarad\pb_gmmrd11\icone\sicurezza16x16.gif"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_sicurezza.destroy
call super::destroy
end on

type m_- from menu within m_archivi
end type

on m_-.create
call super::create
this.text = "-"
this.enabled = false
this.toolbaritemvisible = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_-.destroy
call super::destroy
end on

type m_opf from menu within m_archivi
m_opf_gestione m_opf_gestione
m_opf_elenco m_opf_elenco
m_opf_gestore_eventi m_opf_gestore_eventi
end type

on m_opf.create
call super::create
this.tag = "svsked_v"
this.text = "Operazioni Pianificate..."
this.microhelp = "Operazioni da eseguire in automatico"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = " O. P."
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_opf_gestione=create m_opf_gestione
this.m_opf_elenco=create m_opf_elenco
this.m_opf_gestore_eventi=create m_opf_gestore_eventi
this.Item[UpperBound(this.Item)+1]=this.m_opf_gestione
this.Item[UpperBound(this.Item)+1]=this.m_opf_elenco
this.Item[UpperBound(this.Item)+1]=this.m_opf_gestore_eventi
end on

on m_opf.destroy
call super::destroy
destroy(this.m_opf_gestione)
destroy(this.m_opf_elenco)
destroy(this.m_opf_gestore_eventi)
end on

type m_opf_gestione from menu within m_opf
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//=== Parametri : 
//=== struttura st_open_w
//=== 
st_open_w k_st_open_w

K_st_open_w.id_programma = kkg_id_programma.sv_sked_oper_g
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
k_st_open_w.flag_cerca_in_lista = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_opf_gestione.create
call super::create
this.tag = "svsked_g"
this.text = "Gestione"
this.microhelp = "Aggiungi, modifica, cancella operazioni da eseguire in automatico"
this.menuimage = "AddWatch!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_opf_gestione.destroy
call super::destroy
end on

type m_opf_elenco from menu within m_opf
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//=== Parametri : 
//=== struttura st_open_w
//=== 
st_open_w k_st_open_w

K_st_open_w.id_programma = kkg_id_programma.sv_sked_oper_v
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
k_st_open_w.flag_cerca_in_lista = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_opf_elenco.create
call super::create
this.tag = "svsked_v"
this.text = "Elenco"
this.microhelp = "Aggiungi, modifica, cancella operazioni da eseguire in automatico"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_opf_elenco.destroy
call super::destroy
end on

type m_opf_gestore_eventi from menu within m_opf
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//=== Parametri : 
//=== struttura st_open_w
//=== 
st_open_w k_st_open_w

K_st_open_w.id_programma = kkg_id_programma.sv_sked_oper_log
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
K_st_open_w.flag_leggi_dw = "N"
k_st_open_w.flag_cerca_in_lista = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_opf_gestore_eventi.create
call super::create
this.tag = "svsked_log"
this.text = "Schedulatore"
this.microhelp = "lancia automaticamente gli eventi schedulati"
this.menuimage = "Run!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_opf_gestore_eventi.destroy
call super::destroy
end on

type m_codabarre from menu within m_archivi
end type

event clicked;//
//
//---17092008kuf_menu_window kuf1_menu_window

//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key1=codice sl_pt;
st_open_w k_st_open_w

K_st_open_w.id_programma = "cb"
K_st_open_w.flag_primo_giro = "S"
K_st_open_w.flag_modalita = kkg_flag_modalita.inserimento
K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN_NO
K_st_open_w.flag_leggi_dw = " "
k_st_open_w.flag_cerca_in_lista = "1"
K_st_open_w.key1 = "0"       // numero interno
K_st_open_w.key2 = " "       // data interno
K_st_open_w.key3 = " "
K_st_open_w.key4 = " "
K_st_open_w.flag_where = " "

//---17092008kuf1_menu_window = create kuf_menu_window 
kGuf_menu_window.open_w_tabelle(k_st_open_w)
//---17092008destroy kuf1_menu_window


end event

on m_codabarre.create
call super::create
this.tag = "cb"
this.visible = false
this.text = "Cod. a Barre"
this.enabled = false
this.microhelp = "Codici a barre, situazione lavorazioni"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_codabarre.destroy
call super::destroy
end on

type m_interrogazioni from menu within m_main
m_movimenti m_movimenti
m_report m_report
end type

on m_interrogazioni.create
call super::create
this.text = "&Interroga"
this.microhelp = "Interrogazioni Magazzino"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_movimenti=create m_movimenti
this.m_report=create m_report
this.Item[UpperBound(this.Item)+1]=this.m_movimenti
this.Item[UpperBound(this.Item)+1]=this.m_report
end on

on m_interrogazioni.destroy
call super::destroy
destroy(this.m_movimenti)
destroy(this.m_report)
end on

type m_movimenti from menu within m_interrogazioni
end type

event clicked;//
date k_data


k_data = kguo_g.get_dataoggi( )

//=== Parametri : 
//=== struttura st_open_w
//=== dati particolare programma
//
//=== Si potrebbero passare:
//=== key= vedi sotto
	st_open_w k_st_open_w

	K_st_open_w.id_programma = "movl"
	K_st_open_w.flag_primo_giro = "S"
	K_st_open_w.flag_modalita = kkg_flag_modalita.elenco
	K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
	K_st_open_w.flag_leggi_dw = " "
	K_st_open_w.flag_cerca_in_lista = " "
	K_st_open_w.key1 = "0" // cod mandante
	K_st_open_w.key2 = "0" // cod ricevente 
	K_st_open_w.key3 = "0" // dose
	K_st_open_w.key4 = string(RelativeDate ( k_data, -31))//, "dd/mm/yyyy") // data inizio
	K_st_open_w.key5 = string(k_data) //, "dd/mm/yyyy") // data fine
	K_st_open_w.key6 = " " // 
	K_st_open_w.flag_where = " "

	
	//---17092008kuf1_menu_window = create kuf_menu_window 
	kGuf_menu_window.open_w_tabelle(k_st_open_w)
	//---17092008destroy kuf1_menu_window
								

end event

on m_movimenti.create
call super::create
this.tag = "movl"
this.text = "Movimenti"
this.microhelp = "Entrate/Uscite di magazzino "
this.toolbaritemvisible = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_movimenti.destroy
call super::destroy
end on

type m_report from menu within m_interrogazioni
end type

event clicked;//
//string k_anno
//date k_data
//st_open_w k_st_open_w
kuf_int_artr kuf1_int_artr


kuf1_int_artr = create kuf_int_artr
kuf1_int_artr.u_open()
destroy kuf1_int_artr

//
//k_data = date(0)
//
//K_st_open_w.id_programma = kuf1_int_artr.get "int_1"
//K_st_open_w.flag_primo_giro = "S"
//K_st_open_w.flag_modalita = kkg_flag_modalita.interrogazione
//K_st_open_w.flag_adatta_win = KKG.ADATTA_WIN
//K_st_open_w.flag_leggi_dw = "N"
//K_st_open_w.flag_cerca_in_lista = "1"
//K_st_open_w.key1 = "0000000000" //mandante
//K_st_open_w.key2 = "*" // stato lavorazione (N/I/F)
//K_st_open_w.key3 = string(k_data,"dd/mm/yyyy")  //data inizio lav
//K_st_open_w.key4 = string(k_data,"dd/mm/yyyy")  //data fine lav
//K_st_open_w.key5 = "0000000000"  //cliente mand
//K_st_open_w.key5 = "0000000000"  //cliente ricev
//K_st_open_w.key5 = "0000000000"  //dose
//K_st_open_w.key4 = string(k_data,"dd/mm/yyyy")  //data da 
//K_st_open_w.key4 = string(k_data,"dd/mm/yyyy")  //data a 
//K_st_open_w.flag_where = " "
//							
////---17092008kuf1_menu_window = create kuf_menu_window 
//kGuf_menu_window.open_w_tabelle(k_st_open_w)
////---17092008destroy kuf1_menu_window
//

end event

on m_report.create
call super::create
this.tag = "int_1"
this.text = "Report~tCtrl+R"
this.shortcut = 338
this.microhelp = "Interrogazioni generiche"
this.toolbaritemname = "library!"
this.toolbaritemtext = "Report,Report"
this.toolbaritemorder = 5
this.menuimage = "library!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_report.destroy
call super::destroy
end on

type m_finestra from menu within m_main
m_gestione m_gestione
m_fin-11 m_fin-11
m_fin_stampa m_fin_stampa
m_fin-3 m_fin-3
m_aggiornalista m_aggiornalista
m_fin-2 m_fin-2
m_riordinalista m_riordinalista
m_fin-4 m_fin-4
m_fin_dettaglio m_fin_dettaglio
m_layout_predefinito m_layout_predefinito
m_abilitadockingpredefinito m_abilitadockingpredefinito
m_rimuovepersonalizzazionidocking m_rimuovepersonalizzazionidocking
m_disponi m_disponi
m_chiudifinestra m_chiudifinestra
end type

on m_finestra.create
call super::create
this.text = "&Finestra"
this.microhelp = "Esegue operazioni nella finestra in cui si sta operando "
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = " Finestra"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_gestione=create m_gestione
this.m_fin-11=create m_fin-11
this.m_fin_stampa=create m_fin_stampa
this.m_fin-3=create m_fin-3
this.m_aggiornalista=create m_aggiornalista
this.m_fin-2=create m_fin-2
this.m_riordinalista=create m_riordinalista
this.m_fin-4=create m_fin-4
this.m_fin_dettaglio=create m_fin_dettaglio
this.m_layout_predefinito=create m_layout_predefinito
this.m_abilitadockingpredefinito=create m_abilitadockingpredefinito
this.m_rimuovepersonalizzazionidocking=create m_rimuovepersonalizzazionidocking
this.m_disponi=create m_disponi
this.m_chiudifinestra=create m_chiudifinestra
this.Item[UpperBound(this.Item)+1]=this.m_gestione
this.Item[UpperBound(this.Item)+1]=this.m_fin-11
this.Item[UpperBound(this.Item)+1]=this.m_fin_stampa
this.Item[UpperBound(this.Item)+1]=this.m_fin-3
this.Item[UpperBound(this.Item)+1]=this.m_aggiornalista
this.Item[UpperBound(this.Item)+1]=this.m_fin-2
this.Item[UpperBound(this.Item)+1]=this.m_riordinalista
this.Item[UpperBound(this.Item)+1]=this.m_fin-4
this.Item[UpperBound(this.Item)+1]=this.m_fin_dettaglio
this.Item[UpperBound(this.Item)+1]=this.m_layout_predefinito
this.Item[UpperBound(this.Item)+1]=this.m_abilitadockingpredefinito
this.Item[UpperBound(this.Item)+1]=this.m_rimuovepersonalizzazionidocking
this.Item[UpperBound(this.Item)+1]=this.m_disponi
this.Item[UpperBound(this.Item)+1]=this.m_chiudifinestra
end on

on m_finestra.destroy
call super::destroy
destroy(this.m_gestione)
destroy(this.m_fin-11)
destroy(this.m_fin_stampa)
destroy(this.m_fin-3)
destroy(this.m_aggiornalista)
destroy(this.m_fin-2)
destroy(this.m_riordinalista)
destroy(this.m_fin-4)
destroy(this.m_fin_dettaglio)
destroy(this.m_layout_predefinito)
destroy(this.m_abilitadockingpredefinito)
destroy(this.m_rimuovepersonalizzazionidocking)
destroy(this.m_disponi)
destroy(this.m_chiudifinestra)
end on

type m_gestione from menu within m_finestra
m_fin_conferma m_fin_conferma
m_fin_visualizza m_fin_visualizza
m_fin_modifica m_fin_modifica
m_fin_inserimento m_fin_inserimento
m_fin_duplica m_fin_duplica
m_4 m_4
m_fin_elimina m_fin_elimina
end type

on m_gestione.create
call super::create
this.text = "Gestione..."
this.microhelp = "Operazioni di Inserimento/Modifica/Cancellazione/Conferma"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = " in Archivio"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_fin_conferma=create m_fin_conferma
this.m_fin_visualizza=create m_fin_visualizza
this.m_fin_modifica=create m_fin_modifica
this.m_fin_inserimento=create m_fin_inserimento
this.m_fin_duplica=create m_fin_duplica
this.m_4=create m_4
this.m_fin_elimina=create m_fin_elimina
this.Item[UpperBound(this.Item)+1]=this.m_fin_conferma
this.Item[UpperBound(this.Item)+1]=this.m_fin_visualizza
this.Item[UpperBound(this.Item)+1]=this.m_fin_modifica
this.Item[UpperBound(this.Item)+1]=this.m_fin_inserimento
this.Item[UpperBound(this.Item)+1]=this.m_fin_duplica
this.Item[UpperBound(this.Item)+1]=this.m_4
this.Item[UpperBound(this.Item)+1]=this.m_fin_elimina
end on

on m_gestione.destroy
call super::destroy
destroy(this.m_fin_conferma)
destroy(this.m_fin_visualizza)
destroy(this.m_fin_modifica)
destroy(this.m_fin_inserimento)
destroy(this.m_fin_duplica)
destroy(this.m_4)
destroy(this.m_fin_elimina)
end on

type m_fin_conferma from menu within m_gestione
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.CONFERMA) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Conferma non Abilitata")
	end if
end if

end event

on m_fin_conferma.create
call super::create
this.tag = "co"
this.text = "Salva dati in archivio~tCtrl+S"
this.enabled = false
this.shortcut = 339
this.microhelp = "Registra ii dati in archivio operazione definitiva"
this.toolbaritemname = "save!"
this.toolbaritemtext = "Salva,Registra in archivio"
this.toolbaritembarindex = 3
this.toolbaritemorder = 14
this.toolbaritemspace = 1
this.menuimage = "save!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_conferma.destroy
call super::destroy
end on

type m_fin_visualizza from menu within m_gestione
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.VISUALIZZAZIONE) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Modifica non Abilitata")
	end if
end if

end event

on m_fin_visualizza.create
call super::create
this.text = "Visualizza~tCtrl+O"
this.enabled = false
this.shortcut = 335
this.microhelp = "Apri in modalità Visualizzazione dati"
this.toolbaritemname = "preview!"
this.toolbaritemtext = "Vis.,Visualizza dettaglio"
this.toolbaritembarindex = 3
this.toolbaritemorder = 15
this.toolbaritemspace = 1
this.menuimage = "Preview!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_visualizza.destroy
call super::destroy
end on

type m_fin_modifica from menu within m_gestione
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.MODIFICA) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Modifica non Abilitata")
	end if
end if

end event

on m_fin_modifica.create
call super::create
this.tag = "mo"
this.text = "Modifica~tCtrl+M"
this.enabled = false
this.shortcut = 333
this.microhelp = "Apri in modalità Modifica per aggiornare i dati"
this.toolbaritemname = "inkedit!"
this.toolbaritemtext = "Mod., Modifica"
this.toolbaritembarindex = 3
this.toolbaritemorder = 16
this.toolbaritemspace = 1
this.menuimage = "InkEdit!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_modifica.destroy
call super::destroy
end on

type m_fin_inserimento from menu within m_gestione
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.INSERIMENTO) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Inserimento non Abilitata")
	end if
end if

end event

on m_fin_inserimento.create
call super::create
this.tag = "in"
this.text = "Nuovo~tCtrl+N"
this.enabled = false
this.shortcut = 334
this.microhelp = "Apri per Inserire nuovi dati"
this.toolbaritemname = "new!"
this.toolbaritemtext = "Nuovo, Nuovo"
this.toolbaritembarindex = 3
this.toolbaritemorder = 17
this.toolbaritemspace = 1
this.menuimage = "New!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_inserimento.destroy
call super::destroy
end on

type m_fin_duplica from menu within m_gestione
end type

on m_fin_duplica.create
call super::create
this.visible = false
this.text = "Duplica"
this.enabled = false
this.toolbaritemname = "viewpainter!"
this.toolbaritemtext = "Duplica,Duplica"
this.toolbaritembarindex = 3
this.toolbaritemorder = 17
this.toolbaritemspace = 1
this.menuimage = "ViewPainter!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_duplica.destroy
call super::destroy
end on

event clicked;//
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.DUPLICA) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Duplica non Abilitata")
	end if
end if

end event

type m_4 from menu within m_gestione
end type

on m_4.create
call super::create
this.text = "-"
this.enabled = false
this.toolbaritemvisible = false
this.toolbaritembarindex = 3
this.toolbaritemorder = 18
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_4.destroy
call super::destroy
end on

type m_fin_elimina from menu within m_gestione
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.CANCELLAZIONE) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Cancellazione non Abilitata")
	end if
end if

end event

on m_fin_elimina.create
call super::create
this.tag = "el"
this.text = "Elimina~tCtrl+Del"
this.enabled = false
this.shortcut = 302
this.microhelp = "Cancella i dati in archivio"
this.toolbaritemvisible = false
this.toolbaritemname = "custom021!"
this.toolbaritemtext = "Canc., Elimina"
this.toolbaritembarindex = 3
this.toolbaritemorder = 19
this.menuimage = "custom021!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_elimina.destroy
call super::destroy
end on

type m_fin-11 from menu within m_finestra
end type

on m_fin-11.create
call super::create
this.text = "-"
this.toolbaritemvisible = false
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin-11.destroy
call super::destroy
end on

type m_fin_stampa from menu within m_finestra
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.STAMPA) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Stampa non Abilitata")
	end if
end if

end event

on m_fin_stampa.create
call super::create
this.tag = "st"
this.text = "Stampa~tCtrl+P"
this.enabled = false
this.shortcut = 336
this.toolbaritemname = "print!"
this.toolbaritemtext = "Stampa,Dati video in stampa"
this.toolbaritemorder = 12
this.menuimage = "print!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_stampa.destroy
call super::destroy
end on

type m_fin-3 from menu within m_finestra
end type

on m_fin-3.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin-3.destroy
call super::destroy
end on

type m_aggiornalista from menu within m_finestra
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.REFRESH) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Ricerca non Abilitata")
	end if
end if

end event

on m_aggiornalista.create
call super::create
this.tag = "ag"
this.text = "Aggiorna elenco~tF5"
this.enabled = false
this.shortcut = 116
this.microhelp = "Ricostruisce la Lista coi dati aggiornati rileggendo la Base Dati "
this.toolbaritemname = "regenerate5!"
this.toolbaritemtext = "Rilegge,Rilegge dati da DB"
this.toolbaritemorder = 13
this.menuimage = "Regenerate5!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_aggiornalista.destroy
call super::destroy
end on

type m_fin-2 from menu within m_finestra
end type

on m_fin-2.create
call super::create
this.visible = false
this.text = "-"
this.enabled = false
this.toolbaritemtext = "-"
this.toolbaritemorder = 13
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin-2.destroy
call super::destroy
end on

type m_riordinalista from menu within m_finestra
event clicked ( )
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu("ol") < 0 then
		messagebox("Operazione non eseguita", "Funzione di Riordino non Abilitata")
	end if
end if

end event

on m_riordinalista.create
call super::create
this.visible = false
this.text = "Riordina elenco"
this.enabled = false
this.microhelp = "Ripristina l~'ordine originale della Lista, non rilegge la Base Dati"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_riordinalista.destroy
call super::destroy
end on

type m_fin-4 from menu within m_finestra
end type

on m_fin-4.create
call super::create
this.text = "-"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin-4.destroy
call super::destroy
end on

type m_fin_dettaglio from menu within m_finestra
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.MOSTRA_NASCONDI_DW_DETT) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Ricerca non Abilitata")
	end if
end if

end event

on m_fin_dettaglio.create
call super::create
this.tag = "dd"
this.text = "Mostra/Nascondi dettaglio"
this.enabled = false
this.microhelp = "Mostra / Nasconde il dettaglio dati"
this.toolbaritemvisible = false
this.toolbaritemname = "autosizeheight!"
this.toolbaritemtext = "Dett.,Dettaglio Si/No"
this.toolbaritembarindex = 2
this.menuimage = "autosizeheight!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_dettaglio.destroy
call super::destroy
end on

type m_layout_predefinito from menu within m_finestra
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.VISUALIZZ_PREDEFINITA) < 0 then
		messagebox("Operazione non eseguita", "Funzione di 'Ripristino visualizzazione predefinita' non Abilitata")
	end if
end if



//
end event

on m_layout_predefinito.create
call super::create
this.tag = "vp"
this.text = "Visualizzazione predefinita "
this.enabled = false
this.microhelp = "Ripristina il look prededefinito della finestra"
this.toolbaritemvisible = false
this.toolbaritemname = "custom081!"
this.toolbaritemtext = "Std,RipristinaVisualizzazione Standard"
this.toolbaritemorder = 50
this.toolbaritemspace = 1
this.menuimage = "custom081!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_layout_predefinito.destroy
call super::destroy
end on

type m_abilitadockingpredefinito from menu within m_finestra
end type

on m_abilitadockingpredefinito.create
call super::create
this.tag = "dp"
this.text = "Abilita Docking predefinito"
this.checked = true
this.microhelp = "Abilita temporaneamente l~'apertura delle window nella modalità predefinita"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_abilitadockingpredefinito.destroy
call super::destroy
end on

event clicked;//
this.checked = not this.checked
if isvalid(kguf_base_docking) then
	kguf_base_docking.ki_m_abilitadockingpredefinito = this.checked
end if

end event

type m_rimuovepersonalizzazionidocking from menu within m_finestra
end type

on m_rimuovepersonalizzazionidocking.create
call super::create
this.tag = "dr"
this.text = "Rimuove personalizzazioni Docking"
this.microhelp = "Rimuove le tue personalizzazioni delle window ripristinando la modalità predefinita"
this.menuimage = "Layer!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_rimuovepersonalizzazionidocking.destroy
call super::destroy
end on

event clicked;//
try
	if isvalid(kguf_base_docking) then
		kguf_base_docking.u_reset()
	end if

	messagebox("Rimozione Docking", "Sono state ripristinate le configurazioni predefinite per la gestione delle Window")

catch (uo_exception kuo_exception)
	kuo_exception.messaggio_utente()
	
end try

end event

type m_disponi from menucascade within m_finestra
m_adatta m_adatta
m_cascata m_cascata
m_orizzontale m_orizzontale
m_verticale m_verticale
end type

on m_disponi.create
call super::create
this.visible = false
this.text = "Disponi finestre..."
this.enabled = false
this.microhelp = "Dispone le Finestre Aperte (non quelle a icona)"
this.toolbaritemvisible = false
this.toolbaritemorder = 30
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "disponi"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_adatta=create m_adatta
this.m_cascata=create m_cascata
this.m_orizzontale=create m_orizzontale
this.m_verticale=create m_verticale
this.Item[UpperBound(this.Item)+1]=this.m_adatta
this.Item[UpperBound(this.Item)+1]=this.m_cascata
this.Item[UpperBound(this.Item)+1]=this.m_orizzontale
this.Item[UpperBound(this.Item)+1]=this.m_verticale
end on

on m_disponi.destroy
call super::destroy
destroy(this.m_adatta)
destroy(this.m_cascata)
destroy(this.m_orizzontale)
destroy(this.m_verticale)
end on

type m_adatta from menu within m_disponi
end type

event clicked;//
//=== Apro tutte le windows children
window wSheet
kuf_utility kuf1_utility



wSheet = w_main.GetFirstSheet()
IF IsValid(wSheet) THEN
	
	kuf1_utility = create kuf_utility
	kuf1_utility.u_window_adatta_size(wSheet)
	destroy kuf1_utility
	
end if


end event

on m_adatta.create
call super::create
this.visible = false
this.text = "Adatta~tCtrl+A"
this.enabled = false
this.shortcut = 321
this.microhelp = "Sistema le dimensioni della Finestra "
this.toolbaritemvisible = false
this.toolbaritemname = "sizeboth!"
this.toolbaritemtext = "Adatta, Ridimensiona window"
this.toolbaritemorder = 30
this.menuimage = "sizeboth!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_adatta.destroy
call super::destroy
end on

type m_cascata from menu within m_disponi
end type

event clicked;//
//=== Apro tutte le windows children
boolean bValid
window wSheet

//wSheet = w_main.GetFirstSheet()
//IF IsValid(wSheet) THEN
//	wSheet.windowstate = normal!
//	DO
//		wSheet = w_main.GetNextSheet(wSheet)
//		bValid = IsValid (wSheet)
//
//		IF bValid THEN 		wSheet.windowstate = normal!
//
//	LOOP WHILE bValid
//END IF

w_main.ArrangeSheets(cascade!)


end event

on m_cascata.create
call super::create
this.tag = "cs"
this.visible = false
this.text = "Cascata"
this.enabled = false
this.microhelp = "Dispone le Finestre Aperte a cascata"
this.toolbaritemvisible = false
this.toolbaritemname = "cascade!"
this.toolbaritemtext = "casc., disponi a cascata"
this.toolbaritemorder = 30
this.menuimage = "cascade!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_cascata.destroy
call super::destroy
end on

type m_orizzontale from menu within m_disponi
end type

event clicked;////
////=== Apro tutte le windows children
//boolean bValid
//window wSheet
//
//wSheet = w_main.GetFirstSheet()
//DO
//
//	IF bValid THEN
//		if wSheet.windowstate <> minimized! then
//			wSheet.windowstate = normal!
//		end if
//	end if
//
//	wSheet = w_main.GetNextSheet(wSheet)
//	bValid = IsValid (wSheet)
//
//LOOP WHILE bValid
//
w_main.ArrangeSheets(tilehorizontal!)

//w_main.ArrangeSheets(tile!)
//

end event

on m_orizzontale.create
call super::create
this.tag = "or"
this.visible = false
this.text = "Orizzontale"
this.enabled = false
this.microhelp = "Dispone le Finestre Aperte in orizzontale"
this.toolbaritemvisible = false
this.toolbaritemname = "horizontal!"
this.toolbaritemtext = "orizz., disponi in orizzontale"
this.toolbaritemorder = 30
this.menuimage = "horizontal!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_orizzontale.destroy
call super::destroy
end on

type m_verticale from menu within m_disponi
end type

event clicked;//
w_main.ArrangeSheets(tile!)
end event

on m_verticale.create
call super::create
this.visible = false
this.text = "Verticale"
this.enabled = false
this.microhelp = "Dispone le Finestre Aperte in verticale"
this.toolbaritemvisible = false
this.toolbaritemname = "tile!"
this.toolbaritemtext = "vert., disponi n verticale"
this.toolbaritemorder = 30
this.menuimage = "tile!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_verticale.destroy
call super::destroy
end on

type m_chiudifinestra from menu within m_finestra
event clicked ( )
end type

event clicked;//
//=== Stampa i dati della finestra
w_super kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.ESCI) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Ritorna non Abilitata")
	end if
end if

end event

on m_chiudifinestra.create
call super::create
this.tag = "ri"
this.text = "&Chiudi Finestra~tAlt+F10"
this.enabled = false
this.shortcut = 633
this.microhelp = "Chiude funzione attiva"
this.toolbaritemvisible = false
this.toolbaritemname = "exit!"
this.toolbaritemtext = "Chiudi, Chiudi funzione"
this.toolbaritemorder = 20
this.toolbaritemspace = 1
this.menuitemtype = menuitemtypeexit!
this.menuimage = "exit!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_chiudifinestra.destroy
call super::destroy
end on

type m_trova from menucascade within m_main
m_fin_cerca m_fin_cerca
m_fin_cercaancora m_fin_cercaancora
m_fin_ordina m_fin_ordina
m_fin_filtra m_fin_filtra
end type

on m_trova.create
call super::create
this.text = "Trova"
this.toolbaritembarindex = 2
this.toolbaritemorder = 10
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_fin_cerca=create m_fin_cerca
this.m_fin_cercaancora=create m_fin_cercaancora
this.m_fin_ordina=create m_fin_ordina
this.m_fin_filtra=create m_fin_filtra
this.Item[UpperBound(this.Item)+1]=this.m_fin_cerca
this.Item[UpperBound(this.Item)+1]=this.m_fin_cercaancora
this.Item[UpperBound(this.Item)+1]=this.m_fin_ordina
this.Item[UpperBound(this.Item)+1]=this.m_fin_filtra
end on

on m_trova.destroy
call super::destroy
destroy(this.m_fin_cerca)
destroy(this.m_fin_cercaancora)
destroy(this.m_fin_ordina)
destroy(this.m_fin_filtra)
end on

type m_fin_cerca from menu within m_trova
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.TROVA) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Ricerca non Abilitata")
	end if
end if

end event

on m_fin_cerca.create
call super::create
this.tag = "ce"
this.text = "Trova~tCtrl+F"
this.shortcut = 326
this.microhelp = "Ricerca dati in elenco"
this.toolbaritemname = "find!"
this.toolbaritemtext = "Trova, Cerca in elenco"
this.toolbaritembarindex = 2
this.toolbaritemorder = 10
this.menuimage = "Find!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_cerca.destroy
call super::destroy
end on

type m_fin_cercaancora from menu within m_trova
end type

event clicked;//
//=== Stampa i dati della finestra
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.TROVA_ANCORA) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Ricerca non Abilitata")
	end if
end if

end event

on m_fin_cercaancora.create
call super::create
this.tag = "cn"
this.text = "Trova ancora...~tCtrl+G"
this.enabled = false
this.shortcut = 327
this.microhelp = "Continua la ricerca in elenco"
this.toolbaritemname = "findnext!"
this.toolbaritemtext = "Trova+,Trova il successivo"
this.toolbaritembarindex = 2
this.toolbaritemorder = 11
this.menuimage = "findnext!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_cercaancora.destroy
call super::destroy
end on

type m_fin_ordina from menu within m_trova
end type

event clicked;//
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.SORT) < 0 then
		messagebox("Operazione non eseguita", "Funzione di 'Ordinamento Personalizzato' non Abilitata")
	end if
end if

end event

on m_fin_ordina.create
call super::create
this.tag = "or"
this.text = "Ordina dati in elenco"
this.enabled = false
this.microhelp = "scegli come ordinare l~'elenco"
this.toolbaritemname = "sort!"
this.toolbaritemtext = "Ordina, Ordina elenco"
this.toolbaritembarindex = 2
this.toolbaritemorder = 12
this.menuimage = "sort!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_ordina.destroy
call super::destroy
end on

type m_fin_filtra from menu within m_trova
end type

event clicked;//
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.FILTRO) < 0 then
		messagebox("Operazione non eseguita", "Funzione di Filtro non Abilitata")
	end if
end if

end event

on m_fin_filtra.create
call super::create
this.tag = "fi"
this.visible = false
this.text = "Filtra righe in elenco~tAlt+F"
this.enabled = false
this.shortcut = 582
this.microhelp = "Permette di togliere dalla lista le righe che non intaressano   "
this.toolbaritemname = "custom096!"
this.toolbaritemtext = "Filtra,Filtra in elenco"
this.toolbaritembarindex = 2
this.toolbaritemorder = 13
this.menuimage = "custom096!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_fin_filtra.destroy
call super::destroy
end on

type m_filtro from menu within m_main
end type

event clicked;IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu (KKG_FLAG_RICHIESTA.FILTRO ) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on m_filtro.create
call super::create
this.tag = "ce"
this.visible = false
this.text = "Filtro"
this.microhelp = "Attiva filtro ai dati delle colonne (in stile EXCEL)"
this.toolbaritemname = "custom096!"
this.toolbaritemtext = "Filtro, Attiva Filtro"
this.toolbaritembarindex = 2
this.toolbaritemorder = 13
this.menuimage = "custom096!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_filtro.destroy
call super::destroy
end on

type m_strumenti from menu within m_main
m_fin_gest_libero1 m_fin_gest_libero1
m_fin_gest_libero2 m_fin_gest_libero2
m_fin_gest_libero3 m_fin_gest_libero3
m_fin_gest_libero4 m_fin_gest_libero4
m_fin_gest_libero5 m_fin_gest_libero5
m_fin_gest_libero6 m_fin_gest_libero6
m_fin_gest_libero7 m_fin_gest_libero7
m_fin_gest_libero8 m_fin_gest_libero8
m_fin_gest_libero9 m_fin_gest_libero9
m_fin_gest_libero10 m_fin_gest_libero10
end type

on m_strumenti.create
call super::create
this.visible = false
this.text = "To&ols"
this.microhelp = "Funzioni particolari del pannello attivo"
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 20
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = " tool"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_fin_gest_libero1=create m_fin_gest_libero1
this.m_fin_gest_libero2=create m_fin_gest_libero2
this.m_fin_gest_libero3=create m_fin_gest_libero3
this.m_fin_gest_libero4=create m_fin_gest_libero4
this.m_fin_gest_libero5=create m_fin_gest_libero5
this.m_fin_gest_libero6=create m_fin_gest_libero6
this.m_fin_gest_libero7=create m_fin_gest_libero7
this.m_fin_gest_libero8=create m_fin_gest_libero8
this.m_fin_gest_libero9=create m_fin_gest_libero9
this.m_fin_gest_libero10=create m_fin_gest_libero10
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero1
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero2
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero3
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero4
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero5
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero6
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero7
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero8
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero9
this.Item[UpperBound(this.Item)+1]=this.m_fin_gest_libero10
end on

on m_strumenti.destroy
call super::destroy
destroy(this.m_fin_gest_libero1)
destroy(this.m_fin_gest_libero2)
destroy(this.m_fin_gest_libero3)
destroy(this.m_fin_gest_libero4)
destroy(this.m_fin_gest_libero5)
destroy(this.m_fin_gest_libero6)
destroy(this.m_fin_gest_libero7)
destroy(this.m_fin_gest_libero8)
destroy(this.m_fin_gest_libero9)
destroy(this.m_fin_gest_libero10)
end on

type m_fin_gest_libero1 from menu within m_strumenti
end type

event clicked;//
////w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
////kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu (KKG_FLAG_RICHIESTA.LIBERO1) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on m_fin_gest_libero1.create
call super::create
this.tag = "Alt+1"
this.visible = false
this.text = "libero~tAlt+1"
this.enabled = false
this.shortcut = 561
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 21
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero1.destroy
call super::destroy
end on

type m_fin_gest_libero2 from menu within m_strumenti
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO2) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if
end if

end event

on m_fin_gest_libero2.create
call super::create
this.tag = "Alt+2"
this.visible = false
this.text = "libero~tAlt+2"
this.enabled = false
this.shortcut = 562
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 25
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero2.destroy
call super::destroy
end on

type m_fin_gest_libero3 from menu within m_strumenti
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO3) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if
end if

end event

on m_fin_gest_libero3.create
call super::create
this.tag = "Alt+3"
this.visible = false
this.text = "libero~tAlt+3"
this.enabled = false
this.shortcut = 563
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 27
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero3.destroy
call super::destroy
end on

type m_fin_gest_libero4 from menu within m_strumenti
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO4) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if
end if

end event

on m_fin_gest_libero4.create
call super::create
this.tag = "Alt+4"
this.visible = false
this.text = "libero~tAlt+4"
this.enabled = false
this.shortcut = 564
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 30
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero4.destroy
call super::destroy
end on

type m_fin_gest_libero5 from menu within m_strumenti
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO5) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on m_fin_gest_libero5.create
call super::create
this.tag = "Alt+5"
this.visible = false
this.text = "libero~tAlt+5"
this.enabled = false
this.shortcut = 565
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 33
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero5.destroy
call super::destroy
end on

type m_fin_gest_libero6 from menu within m_strumenti
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO6) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on m_fin_gest_libero6.create
call super::create
this.tag = "Alt+6"
this.visible = false
this.text = "libero~tAlt+6"
this.enabled = false
this.shortcut = 566
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 35
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero6.destroy
call super::destroy
end on

type m_fin_gest_libero7 from menucascade within m_strumenti
libero1 libero1
libero2 libero2
libero3 libero3
libero4 libero4
libero5 libero5
end type

on m_fin_gest_libero7.create
call super::create
this.visible = false
this.text = "libero"
this.enabled = false
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 40
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
this.libero1=create libero1
this.libero2=create libero2
this.libero3=create libero3
this.libero4=create libero4
this.libero5=create libero5
this.Item[UpperBound(this.Item)+1]=this.libero1
this.Item[UpperBound(this.Item)+1]=this.libero2
this.Item[UpperBound(this.Item)+1]=this.libero3
this.Item[UpperBound(this.Item)+1]=this.libero4
this.Item[UpperBound(this.Item)+1]=this.libero5
end on

on m_fin_gest_libero7.destroy
call super::destroy
destroy(this.libero1)
destroy(this.libero2)
destroy(this.libero3)
destroy(this.libero4)
destroy(this.libero5)
end on

type libero1 from menu within m_fin_gest_libero7
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO71) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on libero1.create
call super::create
this.visible = false
this.text = "libero"
this.enabled = false
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 40
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on libero1.destroy
call super::destroy
end on

type libero2 from menu within m_fin_gest_libero7
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO72) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on libero2.create
call super::create
this.visible = false
this.text = "libero"
this.enabled = false
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 40
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on libero2.destroy
call super::destroy
end on

type libero3 from menu within m_fin_gest_libero7
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO73) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on libero3.create
call super::create
this.visible = false
this.text = "libero"
this.enabled = false
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 40
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on libero3.destroy
call super::destroy
end on

type libero4 from menu within m_fin_gest_libero7
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO74) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on libero4.create
call super::create
this.visible = false
this.text = "libero"
this.enabled = false
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 40
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on libero4.destroy
call super::destroy
end on

type libero5 from menu within m_fin_gest_libero7
end type

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO75) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on libero5.create
call super::create
this.visible = false
this.text = "libero"
this.enabled = false
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 40
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on libero5.destroy
call super::destroy
end on

type m_fin_gest_libero8 from menu within m_strumenti
end type

on m_fin_gest_libero8.create
call super::create
this.tag = "Alt+8"
this.visible = false
this.text = "libero~tAlt+8"
this.enabled = false
this.shortcut = 568
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 45
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero8.destroy
call super::destroy
end on

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO8) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

type m_fin_gest_libero9 from menu within m_strumenti
end type

on m_fin_gest_libero9.create
call super::create
this.tag = "Alt+9"
this.visible = false
this.text = "libero~tAlt+9"
this.enabled = false
this.shortcut = 569
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 50
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero9.destroy
call super::destroy
end on

event clicked;//
//w_g_tab  kw_attiva

//=== Prende la window attiva in quel momento
//kw_attiva = w_main.GetActiveSheet( )
//=== Controlla se il valore e' valido
IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO9) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

type m_fin_gest_libero10 from menu within m_strumenti
end type

event clicked;IF IsValid(kguo_g.kgw_attiva) THEN
	if kguo_g.kgw_attiva.event ue_menu(KKG_FLAG_RICHIESTA.LIBERO10) < 0 then
		messagebox("Operazione non eseguita", "Funzione non Abilitata")
	end if

end if

end event

on m_fin_gest_libero10.create
call super::create
this.tag = "Alt+A"
this.visible = false
this.text = "libero~tAlt+A"
this.enabled = false
this.shortcut = 577
this.toolbaritemvisible = false
this.toolbaritembarindex = 2
this.toolbaritemorder = 55
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.toolbaranimation = true
this.bitmapgradient = true
end on

on m_fin_gest_libero10.destroy
call super::destroy
end on

type m_help from menu within m_main
m_aiuto m_aiuto
m_chk_update m_chk_update
m_about m_about
end type

on m_help.create
call super::create
this.text = "&Help"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.menutitletext = "Help"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
this.m_aiuto=create m_aiuto
this.m_chk_update=create m_chk_update
this.m_about=create m_about
this.Item[UpperBound(this.Item)+1]=this.m_aiuto
this.Item[UpperBound(this.Item)+1]=this.m_chk_update
this.Item[UpperBound(this.Item)+1]=this.m_about
end on

on m_help.destroy
call super::destroy
destroy(this.m_aiuto)
destroy(this.m_chk_update)
destroy(this.m_about)
end on

type m_aiuto from menu within m_help
end type

event clicked;//
//--- Help della Procedura
//
st_showhelp kst_showhelp
kuf_showhelp kuf1_showhelp



kuf1_showhelp = create kuf_showhelp

kst_showhelp.cmd = kuf1_showhelp.kki_cmd_indice
kuf1_showhelp.u_showhelp(kst_showhelp)

destroy kuf1_showhelp
end event

on m_aiuto.create
call super::create
this.text = "Aiuto~tF1"
this.shortcut = 112
this.microhelp = "Manuale della Procedura"
this.menuimage = "Help!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_aiuto.destroy
call super::destroy
end on

type m_chk_update from menu within m_help
end type

event clicked;//
//--- check esistenza nuovi aggiornamenti
//
kuf_base kuf1_base
kuf_utility kuf1_utility

kuf1_base = create kuf_base 
	try
		if kuf1_base.if_update_proced_disponibile() then
			if messagebox("Trovata una nuova Versione sul Server","Vuoi aggiornare ora i programmi",&
				question!,yesno!,2) = 1 then
				
				kuf1_utility = create kuf_utility			 
				kuf1_utility.u_aggiorna_procedura()			
				destroy kuf1_utility
			end if
		else
			messagebox("Versione aggiornata","I programmi sono gia' aggiornati")
		end if
	catch (uo_exception kuo1_exception)
		kuo1_exception.messaggio_utente()
	end try
		 

end event

on m_chk_update.create
call super::create
this.text = "Controlla aggiornamenti"
this.microhelp = "Verifica se ci sono nuovi aggiornamenti"
this.menuimage = "Custom044!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.menuanimation = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_chk_update.destroy
call super::destroy
end on

type m_about from menu within m_help
end type

event clicked;//=== Lancia il Logo iniziale
//
//st_open_w kst_open_w
//
//kst_open_w.id_programma = "about"
//kst_open_w.flag_primo_giro = "S"
//kst_open_w.flag_modalita = kkg_flag_modalita.visualizzazione
//kst_open_w.flag_adatta_win = KKG.ADATTA_WIN_NO
//kst_open_w.flag_leggi_dw = "N"
//kst_open_w.flag_cerca_in_lista = "0"
//kst_open_w.key1 = " " 
//kst_open_w.flag_where = " "
//
//							
//kGuf_menu_window.open_w_tabelle(kst_open_w)

st_open_w kst_open_w

	kst_open_w.flag_modalita = kkg_flag_modalita.visualizzazione
	OpenWithParm(w_about_start, kst_open_w)


end event

on m_about.create
call super::create
this.text = "About"
this.menuitemtype = menuitemtypeabout!
this.menuimage = "Having!"
this.menustyle = contemporarymenu!
this.menubackcolor = 32567536
this.menuhighlightcolor = 134217741
this.textsize = -10
this.weight = 400
this.facename = "Verdana"
this.titlebackcolor = 134217730
this.bitmapbackcolor = 15780518
this.menutitles = true
this.menubitmaps = true
this.titlegradient = true
this.toolbarstyle = contemporarytoolbar!
this.toolbartextcolor = 134217746
this.toolbarbackcolor = 134217732
this.toolbarhighlightcolor = 134217741
this.bitmapgradient = true
end on

on m_about.destroy
call super::destroy
end on

