 
0000000001
SELECT distinctmeca.data_int, meca.num_int, meca.contratto, meca.clie_1, meca.clie_3, clienti_b.rag_soc_10, meca.num_bolla_in, meca.data_bolla_in,CASEWHEN 0 = 1 THEN COALESCE(meca.err_lav_ok,' ')ELSE '_'END as err_lav_ok,meca.x_datins, meca.x_utente,meca.id,armo.dose,armo.colli_2,(select COALESCE(count(*), 0) from barcode where barcode.id_meca = meca.id and barcode.data_lav_fin > CONVERT(date,'01.01.1999')) as colli_trattati,(select COALESCE(sum(artr.colli_groupage), 0) from artr where armo.id_armo = artr.id_armo) as colli_groupage,(select COALESCE(count(*),0) from meca_dosim where meca_dosim.id_meca = meca.id) as n_dosim,CASEWHEN 0 = 1 THEN (select COALESCE(count(*),0) from meca_dosimbozza where meca_dosimbozza.id_meca = meca.id)ELSE (select COALESCE(count(*),0) from meca_dosimbozza where meca_dosimbozza.id_meca = meca.id)END as n_dosim_letti, (select COALESCE(count(*),0) from meca_dosimbozza where meca_dosimbozza.id_meca = meca.id) as n_dosim_letti, (select COALESCE(max(meca_memo.id_meca_memo),0) from meca_memo where meca_memo.id_meca = meca.id) as id_meca_memo, meca.data_lav_fin, meca.e1doco,(select COALESCE(count(*), 0) from barcode where barcode.id_meca = meca.id and barcode.causale = 'T') as collidanontrattare,meca.data_int as data_ent FROM ((meca INNER JOIN armo ON meca.id = armo.id_meca) inner JOIN clienti as clienti_bON meca.clie_3 = clienti_b.codice) inner JOIN meca_dosim ON meca.id = meca_dosim.id_mecaWHERE meca.data_int >= '01-01-2018' and (meca_dosim.dosim_dose = 0 or meca_dosim.dosim_dose is null) and meca.data_lav_fin > CONVERT(date,'01.01.2017') and ( (0 = 0 and 0 = 0)or ((0 > 0 and meca.id = 0)or (0 > 0 and meca.clie_3 = 0))) and ( (0 = 1 and exists (select id_meca from meca_dosimbozza where meca_dosimbozza.id_meca = meca_dosim.id_meca and meca_dosimbozza.barcode = meca_dosim.barcode))or (0 = 0 and not exists (select id_meca from meca_dosimbozza where meca_dosimbozza.id_meca = meca_dosim.id_meca and meca_dosimbozza.barcode = meca_dosim.barcode)))ORDER BY meca.data_int DESC, meca.num_int DESC
