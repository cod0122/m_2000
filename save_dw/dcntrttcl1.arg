offerta_data D,id_contratto_co D
0000000002
SELECT contratti_co.id_contratto_co, contratti_co.anno, contratti_co.offerta_data, contratti_co.id_docprod, contratti_co.id_cliente, clienti.rag_soc_10, clienti.id_clie_classe, contratti_co.stato, contratti_co.data_stampa, contratti_co.offerta_validita, contratti_co.oggetto, contratti_co.data_inizio, contratti_co.data_fine, contratti_co.id_clie_settore, clie_settori.descr, contratti_co.gruppo, gru.des, contratti_co.nome_contatto, contratti_co.x_datins, contratti_co.x_utente, contratti_co.mis_x_1, contratti_co.mis_y_1, contratti_co.mis_z_1,contratti_co.attivo,0 as knr_contratti,max(clienti_memo.id_cliente_memo) as id_cliente_memo, ' ' p_memo_xFROM contratti_co LEFT OUTER JOIN clie_settori ON contratti_co.id_clie_settore = clie_settori.id_clie_settore LEFT OUTER JOIN clienti ON contratti_co.id_cliente = clienti.codice LEFT OUTER JOIN gru ON contratti_co.gruppo = gru.codice left outer join clienti_memo on clienti.codice = clienti_memo.id_cliente and clienti_memo.tipo_sv = "CCO" WHERE (0 = 0 or contratti_co.id_cliente = 0)and data_inizio between '22-04-2018' and '31-12-2099' and ('*' = '*' or attivo = '*')group by contratti_co.id_contratto_co, contratti_co.anno, contratti_co.offerta_data, contratti_co.id_docprod, contratti_co.id_cliente, clienti.rag_soc_10, clienti.id_clie_classe, contratti_co.stato, contratti_co.data_stampa, contratti_co.offerta_validita, contratti_co.oggetto, contratti_co.data_inizio, contratti_co.data_fine, contratti_co.id_clie_settore, clie_settori.descr, contratti_co.gruppo, gru.des, contratti_co.nome_contatto, contratti_co.x_datins, contratti_co.x_utente, contratti_co.mis_x_1, contratti_co.mis_y_1, contratti_co.mis_z_1,contratti_co.attivo
