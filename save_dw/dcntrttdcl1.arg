offerta_data D,id_contratto_doc D
0000000002
SELECT ctr.id_contratto_doc, ctr.anno, ctr.offerta_data, ctr.id_cliente, trim(clienti.rag_soc_10) rag_soc_10, ctr.stato, ctr.data_stampa, ctr.offerta_validita, ctr.oggetto, ctr.data_inizio, ctr.data_fine, trim(ctr.id_clie_settore) id_clie_settore, trim(clie_settori.descr) clie_settori_descr, ctr.gruppo, trim(gru.des) gru_des, ctr.nome_contatto, ctr.x_datins, ctr.x_utente ,max(clienti_memo.id_cliente_memo) as id_cliente_memo, ' ' p_memo_x,ctr.quotazione_tipo,ctr.quotazione_cod,ctr.cliente_desprod_ridFROM v_contratti_doc ctr LEFT OUTER JOIN clie_settori ON ctr.id_clie_settore = clie_settori.id_clie_settore LEFT OUTER JOIN clienti ON ctr.id_cliente = clienti.codice LEFT OUTER JOIN gru ON ctr.gruppo = gru.codice left outer join clienti_memo on clienti.codice = clienti_memo.id_cliente and clienti_memo.tipo_sv = 'CRD'WHERE (0 = 0 or ctr.id_cliente = 0)and (ctr.offerta_data >= '23-04-2018' or ctr.data_fine > '23-04-2018')and (0 = 0 or ctr.id_contratto_doc = 0)and ('VAL' = '' or ctr.quotazione_tipo = 'VAL')and ('' = '' or ctr.nome_contatto like '')group by ctr.id_contratto_doc, ctr.anno, ctr.offerta_data, ctr.id_cliente, clienti.rag_soc_10, ctr.stato, ctr.data_stampa, ctr.offerta_validita, ctr.oggetto, ctr.data_inizio, ctr.data_fine, ctr.id_clie_settore, clie_settori.descr, ctr.gruppo, gru.des, ctr.nome_contatto, ctr.x_datins, ctr.x_utente ,ctr.quotazione_tipo,ctr.quotazione_cod,ctr.cliente_desprod_rid
