 
0000000006
SELECT distinctmeca.data_int, meca.num_int, meca.contratto, meca.clie_1, meca.clie_3, clienti_b.rag_soc_10, COALESCE(meca.err_lav_ok, '') as err_lav_ok, meca.x_datins, meca.x_utente,meca.id,COALESCE(armo.cod_sl_pt, '') as cod_sl_pt,armo.dose,armo.colli_2,(select COALESCE(sum(artr.colli_trattati), 0) from artr where armo.id_armo = artr.id_armo) as colli_trattati,(select COALESCE(count(*),0) from meca_dosim where meca_dosim.id_meca = meca.id) as n_dosim,(select COALESCE(count(*),0) from meca_dosimbozza where meca_dosimbozza.id_meca = meca.id) as n_dosim_letti, COALESCE((select max(meca_memo.id_meca_memo) from meca_memo where meca_memo.id_meca = meca.id), 0) as id_meca_memo, meca.data_lav_fin, (select max(dosim_data) from meca_dosimbozza where meca_dosimbozza.id_meca = meca.id) as dosim_data_max,case when (select 1 from meca_dosim where meca_dosim.barcode = meca_dosimbozza.barcode and meca_dosim.dosim_spessore > 0) = 1 then 2else 0end as k_esegui, COALESCE(meca_dosimbozza.barcode_lav, '') as barcode_lav, COALESCE(meca_dosimbozza.barcode, '') as barcode, meca_dosimbozza.dosim_data as dosim_data, COALESCE(meca_dosimbozza.dosim_dose, 0.0) as dosim_dose, COALESCE(meca_dosimbozza.dosim_lotto_dosim, '') as dosim_lotto_dosim, COALESCE(meca_dosimbozza.dosim_flg_tipo_dose,'') as dosim_flg_tipo_dose,COALESCE((barcode.fila_1) + '+' + (barcode.fila_1p), '') as previsti_fila_1,COALESCE((barcode.fila_2) + '+' + (barcode.fila_2p), '') as previsti_fila_2,COALESCE((barcode.lav_fila_1) + '+' + (barcode.lav_fila_1p), '') as lav_fila_1,COALESCE((barcode.lav_fila_2) + '+' + (barcode.lav_fila_2p), '') as lav_fila_2,COALESCE(sl_pt.dose_min, 0.00) as dose_min,COALESCE(sl_pt.dose_max, 0.00) as dose_max, COALESCE(sl_pt.dosetgminmin, 0.00) as dosetgminmin,COALESCE(sl_pt.dosetgminmax, 0.00) as dosetgminmax, COALESCE(sl_pt.dosetgminfattcorr, 0) as dosetgminfattcorr, COALESCE(sl_pt.dosetgmaxfattcorr, 0) as dosetgmaxfattcorr, COALESCE(meca_dosimbozza.dosim_rapp_a_s, 0.000) as dosim_rapp_a_s ,COALESCE(meca_dosimbozza.id_meca_dosimbozza, 0) as id_meca_dosimbozza ,COALESCE(meca.e1doco, 0) as e1doco ,trim(meca_dosimbozza.x_utente_dosim_lettura) as x_utente_dosim_lettura,meca_dosimbozza.x_data_dosim_lettura as x_data_dosim_lettura FROM meca INNER JOIN armo ON meca.id = armo.id_mecaINNER JOIN sl_pt ON sl_pt.cod_sl_pt = armo.cod_sl_ptinner JOIN clienti as clienti_bON meca.clie_3 = clienti_b.codice inner JOIN meca_dosimbozza ON meca.id = meca_dosimbozza.id_mecaleft outer JOIN barcodeON meca_dosimbozza.barcode_lav = barcode.barcode WHERE meca.data_int >= '01-01-2018' and meca.data_lav_fin > CONVERT(date,'01.01.2000') and ( (0 = 0 and 0 = 0)or ((0 > 0 and meca.id = 0)or (0 > 0 and meca.clie_3 = 0))) and ( meca.err_lav_ok = '' or meca.err_lav_ok is null)ORDER BY meca.data_int DESC, meca.num_int DESC,barcode
